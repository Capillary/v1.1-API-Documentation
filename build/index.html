<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #272822;
  background-color: #f92672;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #75715e;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #f8f8f2;
}
.highlight .p, .highlight .pi {
  color: #f8f8f2;
}
.highlight .gi {
  color: #a6e22e;
}
.highlight .gd {
  color: #f92672;
}
.highlight .gh {
  color: #66d9ef;
  background-color: #272822;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #ae81ff;
}
.highlight .kc {
  color: #fd971f;
}
.highlight .kt {
  color: #fd971f;
}
.highlight .kd {
  color: #fd971f;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #a6e22e;
}
.highlight .sr {
  color: #a1efe4;
}
.highlight .si {
  color: #cc6633;
}
.highlight .se {
  color: #cc6633;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #66d9ef;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #a6e22e;
}
.highlight .ss {
  color: #a6e22e;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;json&quot;,&quot;xml&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="json">json</a>
              <a href="#" data-language-name="xml">xml</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='#'>Capillary V1.0 API Documentation</a></li>
            <li><a href='https://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="getting-started">Getting Started</h1>

<p>The Capillary APIs are RESTful APIs that help third party applications manage an Organization’s CRM and/or Loyalty Program through Capillary’s platform. This document lists the APIs that can be used to integrate with the Capillary Server Application, their descriptions, resource information, request parameters, request URIs, and sample requests.</p>

<h2 id="organization-setup">Organization Setup</h2>

<p>Every organization associated with Capillary is registered in InTouch. Based on the organization&rsquo;s architecture, store TILL /Store Center accounts are created for the organization apart from zones, concepts and stores. Only Capillary users have access to register an organization inTouch. Contact your Capillary Account Manager or Delivery Manager.</p>

<p>To set up an organization as a Capillary admin, see Setting up Organization. </p>

<h2 id="authentication">Authentication</h2>

<p>Capillary APIs are accessed using the TILL/Store Center credentials that are created when registering the organization. Please note that it is mandatory to use only the store specific Till/Store center credentials of the organization as the data in the API response depends on this identification.</p>

<aside class="notice">
Use Case: 
For instance, assume that a retailer XYZ of India cluster is registered with Capillary with 2 stores - store1 and store2. Each store has 2 TILLS - till1 and till2(for store1), till3 and till4(for store2). 

If you authenticate using till1 credentials, you can access org level data and only the data of Store1. You cannot access the data of Store2.
</aside>

<aside class="warning">
For any assistance on Organization setup, please contact your Capillary&rsquo;s Account Manager.
</aside>

<h2 id="authentication">Authentication</h2>

<p>To obtain access to the entities of the Capillary Rest APIs, you need to authenticate the TILL/store center account that you are referring to for using the HTTP Basic Authentication.</p>

<p>Authorization Header is used for validating authentication credentials. The Authorization Header is constructed as shown below:</p>

<p><code class="prettyprint">Authorization: Basic &lt;Base64 encoded (username: md5(password))&gt;</code></p>

<p>In the Authorization Header pass the encoded Base64 form of username and md5 formatted password.</p>

<aside class="notice">
For example, to authenticate using TILL1 credentials whose password is 123: 

First convert the password ‘123’ in md5 form. i,e., 202cb962ac59075b964b07152d234b70

Then encode the username and md5 password to Base64. i.e. 

`Base64(till1: 202cb962ac59075b964b07152d234b70)` which is `Authorization: Basic dGlsbDE6IDIwMmNiOTYyYWM1OTA3NWI5NjRiMDcxNTJkMjM0Yjcw`
</aside>

<h2 id="tracking-request">Tracking Request</h2>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"Date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Wed, 16 Dec 2015 06:05:13 GMT"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"Content-Type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/json; charset=utf-8"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"Cache-Control"</span><span class="p">:</span><span class="w"> </span><span class="s2">"must-revalidate,no-cache,no-store"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"X-Cap-Requestid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5670FF17B7D58"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"Server"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CapWS"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"Content-Encoding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gzip"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"X-Cache"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MISS from localhost"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"Transfer-Encoding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chunked"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"Connection"</span><span class="p">:</span><span class="w"> </span><span class="s2">"keep-alive"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>A unique id is generated for every request made using Capillary APIs and is sent to the requestor in the Response Headers as &ldquo;X-Cap-Requestid&rdquo;. 
You can use this request id to track the request end-to-end.
&lt;aside class=&ldquo;notice&rdquo;
It is recommended to note the <code class="prettyprint">X-Cap-Requestid</code> of a request for future requirements.</p>

<aside class="notice">
When an API call is made with 4 batch transactions, A response header is generated with the `X-Cap-Requestid` as shown above. This id can be used to track the details of the entire API call (both request and response).
</aside>

<h2 id="http-request">HTTP Request</h2>

<table><thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Request URL Format</td>
<td>http://<host>/<API version no.>/<entity>/<method>.<format></td>
</tr>
<tr>
<td>Host</td>
<td>The server to which the API calls are made (cluster URL). <br><strong>India</strong>: intouch.capillary.co.in <br><strong>APAC2</strong>: apac2.intouch.capillarytech.com <br><strong>EU</strong>: eu.intouch.capillarytech.com, <br><strong>US</strong>: us.intouch.capillarytech.com</td>
</tr>
<tr>
<td>API Version Number</td>
<td>v1.1</td>
</tr>
<tr>
<td>Entity</td>
<td>Provide the appropriate entity based on the action to be performed. The supported entities are communications, coupon, customer, organization, points, product, store, and transaction</td>
</tr>
<tr>
<td>HTTP Methods</td>
<td>The Capillary Cloud REST APIs support the standard HTTP methods - GETand POST</td>
</tr>
<tr>
<td>Response Format</td>
<td>The format for requesting data from the APIs (xml, json). V1.1 APIs return information in the XML format by default. To get json response, mention <code class="prettyprint">format=xml</code> explicitly.</td>
</tr>
</tbody></table>

<h2 id="response-codes">Response Codes</h2>
<pre class="highlight xml"><code># API level Response Code

<span class="nt">&lt;status&gt;</span>
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
<span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>
<span class="nt">&lt;message&gt;</span>Operation Successful<span class="nt">&lt;/message&gt;</span>
<span class="nt">&lt;/status&gt;</span>
</code></pre><pre class="highlight json"><code><span class="err">#</span><span class="w"> </span><span class="err">API</span><span class="w"> </span><span class="err">level</span><span class="w"> </span><span class="err">Response</span><span class="w"> </span><span class="err">Code</span><span class="w">

</span><span class="p">{</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Operation Successful"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code># Item Level Response Code

<span class="nt">&lt;item_status&gt;</span>
<span class="nt">&lt;success&gt;</span>false<span class="nt">&lt;/success&gt;</span>
<span class="nt">&lt;code&gt;</span>1001<span class="nt">&lt;/code&gt;</span>
<span class="nt">&lt;message&gt;</span>Invalid Mobile Number<span class="nt">&lt;/message&gt;</span>
<span class="nt">&lt;/item_status&gt;</span>
</code></pre><pre class="highlight json"><code><span class="err">#</span><span class="w"> </span><span class="err">Item</span><span class="w"> </span><span class="err">Level</span><span class="w"> </span><span class="err">Response</span><span class="w"> </span><span class="err">Code</span><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"false"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1001"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid Mobile Number"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>
<p>API responces are generated at request level and item level.</p>

<ul>
<li><strong>Request Level Responses</strong>: These response codes are generated at the request level (for an entire request).</li>
<li><strong>Item Level Responses</strong>: These response codes are generated at individual items of a request.</li>
</ul>

<aside class="notice"> For instance, assume that a batch API call is made to add multiple transactions. The entire request will have a status (successful, failed or partial success)and alse each transaction item will have its own response code element. You can see API level response in the `<status>` element and item level in the `<item_status>` element.
</aside>

<h3 id="api-level-response-codes">API Level Response Codes</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>Success</td>
</tr>
<tr>
<td>201</td>
<td>Some requests have failed due to errors</td>
</tr>
<tr>
<td>500</td>
<td>All requests have failed due to errors</td>
</tr>
<tr>
<td>400</td>
<td>Input is invalid, Please check request parameters or input xml/json</td>
</tr>
<tr>
<td>401</td>
<td>Please check your username/password or authentication token</td>
</tr>
<tr>
<td>402</td>
<td>Version is not supported for this resource</td>
</tr>
<tr>
<td>404</td>
<td>Incorrect resource</td>
</tr>
<tr>
<td>405</td>
<td>Incorrect HTTP Method</td>
</tr>
<tr>
<td>406</td>
<td>Operation is not supported for the resource</td>
</tr>
<tr>
<td>407</td>
<td>Unknown Error happened while processing the request</td>
</tr>
<tr>
<td>408</td>
<td>Network MAC ID does not match</td>
</tr>
</tbody></table>

<h3 id="item-level-response-codes">Item Level Response Codes</h3>

<p>Each entity has a different set of response codes. Item level response codes for each entity is provided in the respective entity section. </p>

          <h1 id="customer">Customer</h1>

<p>A customer is an individual who buys goods or services, or subscribes for organization’s newsletters. An organization can be a store, business firm, hospitals or restaurants).</p>

<p>In Capillary’s platform the customer entity represents loyalty customers of the respective organization or just the customers who have subscribed to the organization’s newsletters. </p>

<p>Capillary supports three types of customers based on the loyalty type:</p>

<ul>
<li><strong>Loyalty customers</strong>: Customers who have enrolled into the organization’s loyalty program </li>
<li><strong>Non-loyalty customers</strong>: Customers who have subscribed their mobile number or email id with the organization (through subscriptions, guest transactions etc) but not enrolled into the organization’s loyalty program </li>
<li><strong>Not-interested or anonymous customers</strong>: Customers who have neither enrolled in the loyalty program nor subscribed their mobile numbers/email ids </li>
</ul>

<p>The customer entity stores customer related information such as identifiers, profile details, custom field details, transactions, preferences, subscription details (mobile number/email id), tier details, points history and coupons history.</p>

<p>The customer APIs allow you to</p>

<ul>
<li>Register customers into your organization’s loyalty program </li>
<li>Update customer’s profile information </li>
<li>Update primary or secondary identifiers (mobile no, email id, or external id)</li>
<li>Retrieve customer details (loyalty/non-loyalty)</li>
<li>Submit tickets on behalf of customers and fetch their tickets<br></li>
<li>Add, update and retrieve customer preferences </li>
<li>Retrieve transactions of a customer. </li>
</ul>

<h2 id="register-customer">Register Customer</h2>
<pre class="highlight shell"><code><span class="c">#Sample Request</span>
POST <span class="s2">"http://us.api.capillarytech.com/v1.1/customer/add?format=json"</span>
</code></pre><pre class="highlight json"><code><span class="err">#</span><span class="w"> </span><span class="err">Sample</span><span class="w"> </span><span class="err">POST</span><span class="w"> </span><span class="err">JSON</span><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"root"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900000"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tom.sawyer@example.com"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ts1234"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"firstname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tom"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"lastname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sawyer"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"M"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"registered_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-09-11 11:11:11"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"custom_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
              </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hobbies"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[“Playing”]"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
              </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[“b”]&gt;"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900999"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rita.john@example.com"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"XYPZ006"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"firstname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Rita"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"lastname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"M"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"registered_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-09-11 11:11:15"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"custom_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
              </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hobbies"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[“Singing”]&gt;"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
              </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[“b”]"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code># Sample POST XML
<span class="nt">&lt;root&gt;</span>
  <span class="nt">&lt;customer&gt;</span>
     <span class="nt">&lt;mobile&gt;</span>44700900000<span class="nt">&lt;/mobile&gt;</span>
     <span class="nt">&lt;email&gt;</span>tom.sawyer@example.com<span class="nt">&lt;/email&gt;</span>
     <span class="nt">&lt;external_id&gt;</span>XYPZ001<span class="nt">&lt;/external_id&gt;</span>
     <span class="nt">&lt;firstname&gt;</span>Tom<span class="nt">&lt;/firstname&gt;</span>
     <span class="nt">&lt;lastname&gt;</span>Sawyer<span class="nt">&lt;/lastname&gt;</span>
     <span class="nt">&lt;gender&gt;</span>M<span class="nt">&lt;/gender&gt;</span>
     <span class="nt">&lt;registered_on&gt;</span>2012-09-11 11:11:11<span class="nt">&lt;/registered_on&gt;</span>
     <span class="nt">&lt;custom_fields&gt;</span>
     <span class="nt">&lt;field&gt;</span>
    <span class="nt">&lt;name&gt;</span>Hobbies<span class="nt">&lt;/name&gt;</span>
     <span class="nt">&lt;value&gt;</span>[“Playing”]<span class="nt">&lt;/value&gt;</span>
     <span class="nt">&lt;/field&gt;</span>
     <span class="nt">&lt;field&gt;</span>
    <span class="nt">&lt;name&gt;</span>a<span class="nt">&lt;/name&gt;</span>
     <span class="nt">&lt;value&gt;</span>[“b”]&gt;<span class="nt">&lt;/value&gt;</span>
     <span class="nt">&lt;/field&gt;</span>
     <span class="nt">&lt;/custom_fields&gt;</span>
     <span class="nt">&lt;/customer&gt;</span>
    <span class="nt">&lt;customer&gt;</span>
     <span class="nt">&lt;mobile&gt;</span>44700900999<span class="nt">&lt;/mobile&gt;</span>
     <span class="nt">&lt;email&gt;</span>rita.john@example.com<span class="nt">&lt;/email&gt;</span>
     <span class="nt">&lt;external_id&gt;</span>XYPZ006<span class="nt">&lt;/external_id&gt;</span>
     <span class="nt">&lt;firstname&gt;</span>Rita<span class="nt">&lt;/firstname&gt;</span>
     <span class="nt">&lt;lastname&gt;</span>John<span class="nt">&lt;/lastname&gt;</span>
     <span class="nt">&lt;gender&gt;</span>M<span class="nt">&lt;/gender&gt;</span>
     <span class="nt">&lt;registered_on&gt;</span>2012-09-11 11:11:15<span class="nt">&lt;/registered_on&gt;</span>
     <span class="nt">&lt;custom_fields&gt;</span>
     <span class="nt">&lt;field&gt;</span>
    <span class="nt">&lt;name&gt;</span>Hobbies<span class="nt">&lt;/name&gt;</span>
     <span class="nt">&lt;value&gt;</span>[“Singing”]&gt;<span class="nt">&lt;/value&gt;</span>
     <span class="nt">&lt;/field&gt;</span>
     <span class="nt">&lt;field&gt;</span>
    <span class="nt">&lt;name&gt;</span>a<span class="nt">&lt;/name&gt;</span>
     <span class="nt">&lt;value&gt;</span>[“b”]<span class="nt">&lt;/value&gt;</span>
     <span class="nt">&lt;/field&gt;</span>
     <span class="nt">&lt;/custom_fields&gt;</span>
     <span class="nt">&lt;/customer&gt;</span>
<span class="nt">&lt;/root&gt;</span>

</code></pre><pre class="highlight json"><code><span class="err">#</span><span class="w"> </span><span class="err">Sample</span><span class="w"> </span><span class="err">Response</span><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"customers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900000"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tom.sawyer@example.com"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"XYPZ001"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"M"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"registered_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-09-11 11:11:11"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1000"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Customer Registration Successful"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="nt">"side_effects"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"effect"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
              </span><span class="p">{</span><span class="w">
                </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"points"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"awarded_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"19490463"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"total_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"19490463"</span><span class="w">
              </span><span class="p">},</span><span class="w">
              </span><span class="p">{</span><span class="w">
                </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"coupon"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"coupon_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"095790"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sample description"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"coupon_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CAMPAIGN/DVS"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"42601779"</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">]</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="nt">"firstname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tom"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"lastname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sawyer"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"lifetime_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"50"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"lifetime_purchases"</span><span class="p">:</span><span class="w"> </span><span class="s2">"180"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"loyalty_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"50"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"current_slab"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SILVER"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"updated_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-09-11 11:11:11"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44342"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900999"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rita.john@example.com"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"XYPZ006"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"M"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"registered_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-09-11 11:11:15"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1000"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Customer Registration Successful"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="nt">"side_effects"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">

          </span><span class="p">},</span><span class="w">
          </span><span class="nt">"firstname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Rita"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"lastname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"lifetime_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"50"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"lifetime_purchases"</span><span class="p">:</span><span class="w"> </span><span class="s2">"345"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"loyalty_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"50"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"current_slab"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SILVER"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"updated_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-09-11 11:11:15"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code># Sample Response
<span class="nt">&lt;response&gt;</span>  
<span class="nt">&lt;status&gt;</span>    
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>    
<span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>    
<span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>  
<span class="nt">&lt;/status&gt;</span>  
<span class="nt">&lt;customers&gt;</span>   
<span class="nt">&lt;customer&gt;</span>   
<span class="nt">&lt;user_id&gt;</span>123<span class="nt">&lt;/user_id&gt;</span>   
<span class="nt">&lt;mobile&gt;</span>44700900000<span class="nt">&lt;/mobile&gt;</span>
<span class="nt">&lt;email&gt;</span>tom.sawyer@example.com<span class="nt">&lt;/email&gt;</span>     
<span class="nt">&lt;external_id&gt;</span>XYPZ001<span class="nt">&lt;/external_id&gt;</span>
<span class="nt">&lt;gender&gt;</span>M<span class="nt">&lt;/gender&gt;</span>
<span class="nt">&lt;registered_on&gt;</span>2012-09-11 11:11:11<span class="nt">&lt;/registered_on&gt;</span>
<span class="nt">&lt;item_status&gt;</span>       
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>        
<span class="nt">&lt;code&gt;</span>1000<span class="nt">&lt;/code&gt;</span>        
<span class="nt">&lt;message&gt;</span>Customer Registration Successful<span class="nt">&lt;/message&gt;</span>    
<span class="nt">&lt;/item_status&gt;</span>      
<span class="nt">&lt;side_effects&gt;</span>
<span class="nt">&lt;effect&gt;</span>
<span class="nt">&lt;type&gt;</span>points<span class="nt">&lt;/type&gt;</span>
<span class="nt">&lt;awarded_points&gt;</span>19490463<span class="nt">&lt;/awarded_points&gt;</span>
<span class="nt">&lt;total_points&gt;</span>19490463<span class="nt">&lt;/total_points&gt;</span>
<span class="nt">&lt;/effect&gt;</span>
<span class="nt">&lt;effect&gt;</span>
<span class="nt">&lt;type&gt;</span>coupon<span class="nt">&lt;/type&gt;</span>
<span class="nt">&lt;coupon_code&gt;</span>095790<span class="nt">&lt;/coupon_code&gt;</span>
<span class="nt">&lt;description&gt;</span>Sample description<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;coupon_type&gt;</span>CAMPAIGN/DVS<span class="nt">&lt;/coupon_type&gt;</span>
<span class="nt">&lt;discount_code&gt;&lt;/discount_code&gt;</span>
<span class="nt">&lt;discount_value&gt;&lt;/discount_value&gt;</span>
<span class="nt">&lt;valid_till&gt;&lt;/valid_till&gt;</span>
<span class="nt">&lt;id&gt;</span>42601779<span class="nt">&lt;/id&gt;</span>
<span class="nt">&lt;/effect&gt;</span>
<span class="nt">&lt;/side_effects&gt;</span>
<span class="c">&lt;!-- new fields start --&gt;</span>
<span class="nt">&lt;firstname&gt;</span>Tom<span class="nt">&lt;/firstname&gt;</span> 
<span class="nt">&lt;lastname&gt;</span>Sawyer<span class="nt">&lt;/lastname&gt;</span>
<span class="nt">&lt;lifetime_points&gt;</span>50<span class="nt">&lt;/lifetime_points&gt;</span>
<span class="nt">&lt;lifetime_purchases&gt;</span>180<span class="nt">&lt;/lifetime_purchases&gt;</span>
<span class="nt">&lt;loyalty_points&gt;</span>50<span class="nt">&lt;/loyalty_points&gt;</span>
<span class="nt">&lt;current_slab&gt;</span>SILVER<span class="nt">&lt;/current_slab&gt;</span>
<span class="nt">&lt;updated_on&gt;</span>2016-09-11 11:11:11<span class="nt">&lt;/updated_on&gt;</span>
<span class="c">&lt;!-- new fields end : these fields will come after implementing register by email functionality --&gt;</span>
<span class="nt">&lt;/customer&gt;</span>  
<span class="nt">&lt;customer&gt;</span>  
<span class="nt">&lt;user_id&gt;</span>44342<span class="nt">&lt;/user_id&gt;</span>    
<span class="nt">&lt;mobile&gt;</span>44700900999<span class="nt">&lt;/mobile&gt;</span>     
<span class="nt">&lt;email&gt;</span>rita.john@example.com<span class="nt">&lt;/email&gt;</span>     
<span class="nt">&lt;external_id&gt;</span>XYPZ006<span class="nt">&lt;/external_id&gt;</span>      
<span class="nt">&lt;gender&gt;</span>M<span class="nt">&lt;/gender&gt;</span>
<span class="nt">&lt;registered_on&gt;</span>2016-09-11 11:11:15<span class="nt">&lt;/registered_on&gt;</span>
<span class="nt">&lt;item_status&gt;</span>        
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>        
<span class="nt">&lt;code&gt;</span>1000<span class="nt">&lt;/code&gt;</span>        
<span class="nt">&lt;message&gt;</span>Customer Registration Successful<span class="nt">&lt;/message&gt;</span>     
<span class="nt">&lt;/item_status&gt;</span>      
<span class="nt">&lt;side_effects&gt;</span>        
<span class="nt">&lt;effect/&gt;</span>      
<span class="nt">&lt;/side_effects&gt;</span>
<span class="c">&lt;!-- new fields start --&gt;</span>
<span class="nt">&lt;firstname&gt;</span>Rita<span class="nt">&lt;/firstname&gt;</span> 
<span class="nt">&lt;lastname&gt;</span>John<span class="nt">&lt;/lastname&gt;</span>
<span class="nt">&lt;lifetime_points&gt;</span>50<span class="nt">&lt;/lifetime_points&gt;</span>
<span class="nt">&lt;lifetime_purchases&gt;</span>345<span class="nt">&lt;/lifetime_purchases&gt;</span>
<span class="nt">&lt;loyalty_points&gt;</span>50<span class="nt">&lt;/loyalty_points&gt;</span>
<span class="nt">&lt;current_slab&gt;</span>SILVER<span class="nt">&lt;/current_slab&gt;</span>
<span class="nt">&lt;updated_on&gt;</span>2016-09-11 11:11:15<span class="nt">&lt;/updated_on&gt;</span>
<span class="c">&lt;!-- new fields end : these fields will come after implementing register by email functionality --&gt;</span>    
<span class="nt">&lt;/customer&gt;</span>
<span class="nt">&lt;/customers&gt;</span>
<span class="nt">&lt;/response&gt;</span>

</code></pre>
<p>This API allows you to  register  customers into your organization’s loyalty program. You can register multiple customers at a time. However, this API also updates customer details when a registered identifier is passed again.</p>

<p>Following are the features of customer registration API:</p>

<ul>
<li>Registers customer with the provided details when a new identifier(mobile no/email id/external id) is passed </li>
<li>Identifiers once registered  are not modified</li>
<li>Identifiers are updated only if null/blank</li>
<li>Fields other than identifiers are updated automatically</li>
</ul>

<p>However, to update secondary parameters, allow mobile number change/email id change/external id change should be enabled in your organization’s <strong>InTouch</strong> &gt; <strong>Settings</strong> &gt; <strong>Miscellaneous</strong> &gt; <strong>Registration Configuration</strong> page.</p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>customer/add</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Method</td>
<td>POST</td>
</tr>
<tr>
<td>Batch Support</td>
<td>Yes</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/customer/add?format=&lt;xml/json&gt;</code></p>

<h3 id="request-attributes">Request Attributes</h3>

<p>The mandatory attributes for customer registration depends on the configurations set on InTouch. For example, you could set email id and one or more custom fields as a mandatory params for registering a customer.
<aside class="warning">Before using customer registration API, know the mandatory and optional fields set on the <strong>Registration Configuration</strong> page of InTouch.</aside></p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>mobile*</td>
<td>Mobile number that the customer wants to register with your org. Pass the mobile number with country code</td>
</tr>
<tr>
<td>email*</td>
<td>Email id that the customer wants to register with your org.</td>
</tr>
<tr>
<td>external_id*</td>
<td>External id of the customer that is accepted by your org. Required only if it is supported for your org</td>
</tr>
<tr>
<td>firstname</td>
<td>First name of the customer</td>
</tr>
<tr>
<td>lastname</td>
<td>Last name of the customer</td>
</tr>
<tr>
<td>type</td>
<td>Registration type: LOYALTY, NON_LOYALTY, NOT_INTERESTED</td>
</tr>
<tr>
<td>registered_on</td>
<td>Date on which the customer is registered. Format: YYYY-MM-DD HH:MM:SS, <br>Example: 2016-09-11 11:11:11</td>
</tr>
<tr>
<td>custom_fields</td>
<td>Provide the custom fields configured for your org in name and value pairs <br><code class="prettyprint">&lt;field&gt;</code> <code class="prettyprint">&lt;name&gt;Hobbies&lt;/name&gt;</code> <br> <code class="prettyprint">&lt;value&gt;[“Playing”]&lt;/value&gt;</code>  <code class="prettyprint">&lt;/field&gt;</code></td>
</tr>
</tbody></table>

<h2 id="update-customer-details">Update Customer Details</h2>
<pre class="highlight shell"><code><span class="c"># Sample Request URL</span>
POST <span class="s2">"http://api.capillary.co.in/v1.1/customer/update?format=json"</span>
</code></pre><pre class="highlight json"><code><span class="err">#</span><span class="w"> </span><span class="err">Sample</span><span class="w"> </span><span class="err">Post</span><span class="w"> </span><span class="err">JSON</span><span class="w">

</span><span class="p">{</span><span class="w">
  </span><span class="nt">"root"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900000"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tom.sawyer@email.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ts1234"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"firstname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tom"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"lastname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sawyer"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"M"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"custom_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"age"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[“46”]"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code># Sample Post XML

<span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
    <span class="nt">&lt;root&gt;</span>
        <span class="nt">&lt;customer&gt;</span>
            <span class="nt">&lt;mobile&gt;</span>44700900000<span class="nt">&lt;/mobile&gt;</span>
            <span class="nt">&lt;email&gt;</span>tom.sawyer@example.com<span class="nt">&lt;/email&gt;</span>
            <span class="nt">&lt;external_id&gt;</span>ts1234<span class="nt">&lt;/external_id&gt;</span>
            <span class="nt">&lt;firstname&gt;</span>Tom<span class="nt">&lt;/firstname&gt;</span>
            <span class="nt">&lt;lastname&gt;</span>Sawyer<span class="nt">&lt;/lastname&gt;</span>
            <span class="nt">&lt;gender&gt;</span>M<span class="nt">&lt;/gender&gt;</span>
            <span class="nt">&lt;custom_fields&gt;</span>
                <span class="nt">&lt;field&gt;</span>
                    <span class="nt">&lt;name&gt;</span>age<span class="nt">&lt;/name&gt;</span>
                    <span class="nt">&lt;value&gt;</span>[“46”]<span class="nt">&lt;/value&gt;</span>
                <span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;/custom_fields&gt;</span>
        <span class="nt">&lt;/customer&gt;</span>
    <span class="nt">&lt;/root&gt;</span>
</code></pre><pre class="highlight json"><code><span class="err">#</span><span class="w"> </span><span class="err">Sample</span><span class="w"> </span><span class="err">Response</span><span class="w">

</span><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"customers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"776538"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900000"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tom.sawyer@example.com"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ts1234"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"firstname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tom"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"lastname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sawyer"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"M"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"custom_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"hobbies"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[“Playing”]"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1000"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"User Successfully Updated."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"lifetime_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"245"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"lifetime_purchases"</span><span class="p">:</span><span class="w"> </span><span class="s2">"24500"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"loyalty_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"60"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"current_slab"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SILVER"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"registered_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-08-16 15:13:16"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"updated_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-09-22 10:48:00"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code># Sample Response
<span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
    <span class="nt">&lt;response&gt;</span>
        <span class="nt">&lt;status&gt;</span>
            <span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
            <span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>
            <span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>
        <span class="nt">&lt;/status&gt;</span>
        <span class="nt">&lt;customers&gt;</span>
            <span class="nt">&lt;customer&gt;</span>
                <span class="nt">&lt;user_id&gt;</span>776538<span class="nt">&lt;/user_id&gt;</span>
                <span class="nt">&lt;mobile&gt;</span>44700900000<span class="nt">&lt;/mobile&gt;</span>
                <span class="nt">&lt;email&gt;</span>tom.sawyer@example.com<span class="nt">&lt;/email&gt;</span>
                <span class="nt">&lt;external_id&gt;</span>TOM123<span class="nt">&lt;/external_id&gt;</span>
                <span class="nt">&lt;firstname&gt;</span>Tom<span class="nt">&lt;/firstname&gt;</span>
                <span class="nt">&lt;lastname&gt;</span>Sawyer<span class="nt">&lt;/lastname&gt;</span>
                <span class="nt">&lt;gender&gt;</span>M<span class="nt">&lt;/gender&gt;</span>
                <span class="nt">&lt;custom_fields&gt;</span>
                    <span class="nt">&lt;field&gt;</span>
                        <span class="nt">&lt;name&gt;</span>hobbies<span class="nt">&lt;/name&gt;</span>
                        <span class="nt">&lt;value&gt;</span>[“Playing”]<span class="nt">&lt;/value&gt;</span>
                    <span class="nt">&lt;/field&gt;</span>
                <span class="nt">&lt;/custom_fields&gt;</span>
                <span class="nt">&lt;item_status&gt;</span>
                    <span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
                    <span class="nt">&lt;code&gt;</span>1000<span class="nt">&lt;/code&gt;</span>
                    <span class="nt">&lt;message&gt;</span>User Successfully Updated.<span class="nt">&lt;/message&gt;</span>
                <span class="nt">&lt;/item_status&gt;</span>
                <span class="nt">&lt;lifetime_points&gt;</span>245<span class="nt">&lt;/lifetime_points&gt;</span>
                <span class="nt">&lt;lifetime_purchases&gt;</span>24500<span class="nt">&lt;/lifetime_purchases&gt;</span>
                <span class="nt">&lt;loyalty_points&gt;</span>60<span class="nt">&lt;/loyalty_points&gt;</span>
                <span class="nt">&lt;current_slab&gt;</span>SILVER<span class="nt">&lt;/current_slab&gt;</span>
                <span class="nt">&lt;registered_on&gt;</span>2012-08-16 15:13:16<span class="nt">&lt;/registered_on&gt;</span>
                <span class="nt">&lt;updated_on&gt;</span>2012-09-22 10:48:00<span class="nt">&lt;/updated_on&gt;</span>
            <span class="nt">&lt;/customer&gt;</span>
        <span class="nt">&lt;/customers&gt;</span>
    <span class="nt">&lt;/response&gt;</span>

</code></pre>
<p>This API allows you to update customer’s profile information based on the customer identifier (mobile no/email id/external id) passed. If an identifier you register already exists in campaigns, the customer details are merged automatically.</p>

<p>You can update secondary identifiers (mobile no./email id./external id) only when the respective options are enabled on InStore, i.e., Capillary InTouch &gt; <strong>Settings</strong> &gt; <strong>Miscellaneous</strong> &gt; <strong>Registration Configuration</strong></p>

<ul>
<li>CONF_ALLOW_MOBILE_UPDATE (for mobile number)</li>
<li>CONF_ALLOW_EMAIL_UPDATE (for email id)</li>
<li>CONF_LOYALTY_ALLOW_EXTERNAL_ID_UPDATE (for external id) </li>
</ul>

<p>However, you cannot update the primary identifier of customers using this API even if the option to update the respective identifier is enabled on the <strong>Registration Configuration</strong> page. </p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>customer/update</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Method</td>
<td>POST</td>
</tr>
<tr>
<td>Batch Support</td>
<td>No</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/customer/update?format=&lt;xml/json&gt;</code></p>

<h3 id="request-parameters">Request Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Mobile/email/external_id*</td>
<td>Pass any one of these identifiers of the customer whose details need to be updated</td>
</tr>
<tr>
<td>user_id(Boolean)</td>
<td>Returns the unique user ID of the customer if user_id=true</td>
</tr>
</tbody></table>

<h2 id="update-customer-identifiers">Update Customer Identifiers</h2>
<pre class="highlight html"><code># Sample Request

http://us.intouch.capillarytech.com/v1.1/customer/update_identity?format=xml
</code></pre>
<blockquote>
<p>Provide the unique identifier of the customer in <identifier> and current and new identifier values in <old-value> and <new_value> respectively</p>
</blockquote>
<pre class="highlight json"><code><span class="err">#</span><span class="w"> </span><span class="err">Sample</span><span class="w"> </span><span class="err">POST</span><span class="w"> </span><span class="err">json</span><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nt">"root"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="nt">"new_value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900090"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900000"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"old_value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900000"</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code># Sample POST xml
<span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
    <span class="nt">&lt;root&gt;</span>
        <span class="nt">&lt;customer&gt;</span>
            <span class="nt">&lt;new_value&gt;</span>44700900090<span class="nt">&lt;/new_value&gt;</span>
            <span class="nt">&lt;identifier&gt;</span>44700900000<span class="nt">&lt;/identifier&gt;</span>
            <span class="nt">&lt;old_value&gt;</span>44700900000<span class="nt">&lt;/old_value&gt;</span>
        <span class="nt">&lt;/customer&gt;</span>
    <span class="nt">&lt;/root&gt;</span>
</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"customers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mobile"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"old_value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900000"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"new_value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900090"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"updated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
               </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
               </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1040"</span><span class="p">,</span><span class="w">
               </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Customer Identity change request added successfully"</span><span class="w">
            </span><span class="p">}</span><span class="w">
         </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
    <span class="nt">&lt;response&gt;</span>
        <span class="nt">&lt;status&gt;</span>
            <span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
            <span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>
            <span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>
        <span class="nt">&lt;/status&gt;</span>
        <span class="nt">&lt;customers&gt;</span>
            <span class="nt">&lt;customer&gt;</span>
                <span class="nt">&lt;identifier&gt;</span>mobile<span class="nt">&lt;/identifier&gt;</span>
                <span class="nt">&lt;old_value&gt;</span>44700900000<span class="nt">&lt;/old_value&gt;</span>
                <span class="nt">&lt;new_value&gt;</span>44700900090<span class="nt">&lt;/new_value&gt;</span>
                <span class="nt">&lt;updated&gt;</span>true<span class="nt">&lt;/updated&gt;</span>
                <span class="nt">&lt;item_status&gt;</span>
                    <span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
                    <span class="nt">&lt;code&gt;</span>1040<span class="nt">&lt;/code&gt;</span>
                    <span class="nt">&lt;message&gt;</span>Customer Identity change request added successfully<span class="nt">&lt;/message&gt;</span>
                <span class="nt">&lt;/item_status&gt;</span>
            <span class="nt">&lt;/customer&gt;</span>
        <span class="nt">&lt;/customers&gt;</span>
    <span class="nt">&lt;/response&gt;</span>
</code></pre>
<p>This API allows you to send requests to update primary and secondary identifiers (mobile no./email id/external id) of a registered customer. Capillary back-end team verifies each such request and update the identifier(s) manually.</p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>customer/update_identity</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Method</td>
<td>POST</td>
</tr>
<tr>
<td>Batch Support</td>
<td>Yes</td>
</tr>
</tbody></table>

<h3 id="request-parameters">Request Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/customer/update_identity?format=&lt;xml/json&gt;</code></p>

<h3 id="request-parameters">Request Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>identifier*</td>
<td>Unique identifier (Mobile/email/external_id) of the customer whose identifier needs to be updated</td>
</tr>
<tr>
<td>old_identifier*</td>
<td>Existing identifer value of the customer that needs to be updated</td>
</tr>
<tr>
<td>new_identifier*</td>
<td>New identifer value</td>
</tr>
</tbody></table>

<h2 id="retrieve-customers-advanced-search">Retrieve Customers (Advanced Search)</h2>
<pre class="highlight html"><code># Sample Request
http://api.capillary.co.in/v1.1/customer/search?q=mobile:EQUALS:44700900000<span class="err">&amp;</span>format=json
</code></pre><pre class="highlight json"><code><span class="p">{</span><span class="w"> 
    </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">

        </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">

            </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">

            </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">

            </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">

        </span><span class="p">},</span><span class="w">

        </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">

            </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">

            </span><span class="nt">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">

            </span><span class="nt">"rows"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10"</span><span class="p">,</span><span class="w">

            </span><span class="nt">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">

                </span><span class="nt">"item"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">

                    </span><span class="p">{</span><span class="w">

                        </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"102"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"org_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"29"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"firstname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tom"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"lastname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sawyer"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900000"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tom.sawyer@example.com"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"None"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"M"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"loyalty_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"355"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"lifetime_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5400"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"lifetime_purchases"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10800"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"current_slab"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CLASSIC"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"registered_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-12-25 11:25:32"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"registered_by"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pe.london.bondstreet"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"last_trans_value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1000"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">

                            </span><span class="nt">"attribute"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">

                                </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"customer_age"</span><span class="p">,</span><span class="w">

                                </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"26-35"</span><span class="w">

                            </span><span class="p">}</span><span class="w">

                        </span><span class="p">}</span><span class="w">

                    </span><span class="p">},</span><span class="w">

                    </span><span class="p">{</span><span class="w">

                        </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"122"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"org_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"29"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"firstname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"lastname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900888"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john.smith@example.com"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"None"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"loyalty_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"355"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"lifetime_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"355"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"lifetime_purchases"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4598"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"current_slab"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CLASSIC"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"registered_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-12-25 11:25:32"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"registered_by"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pe.london.bondstreet"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"last_trans_value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1000"</span><span class="p">,</span><span class="w">

                        </span><span class="nt">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">

                            </span><span class="nt">"attribute"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">

                                </span><span class="p">{</span><span class="w">

                                    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"occupation"</span><span class="p">,</span><span class="w">

                                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Student"</span><span class="w">

                                </span><span class="p">},</span><span class="w">

                                </span><span class="p">{</span><span class="w">

                                    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"customer_age"</span><span class="p">,</span><span class="w">

                                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"19-25"</span><span class="w">

                                </span><span class="p">}</span><span class="w">

                            </span><span class="p">]</span><span class="w">

                        </span><span class="p">}</span><span class="w">

                    </span><span class="p">}</span><span class="w">

                </span><span class="p">]</span><span class="w">

            </span><span class="p">}</span><span class="w">

        </span><span class="p">}</span><span class="w">

    </span><span class="p">}</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
    <span class="nt">&lt;response&gt;</span>
        <span class="nt">&lt;status&gt;</span>
            <span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
            <span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>
            <span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>
        <span class="nt">&lt;/status&gt;</span>
        <span class="nt">&lt;customer&gt;</span>
            <span class="nt">&lt;count&gt;</span>2<span class="nt">&lt;/count&gt;</span>
            <span class="nt">&lt;start&gt;</span>0<span class="nt">&lt;/start&gt;</span>
            <span class="nt">&lt;rows&gt;</span>10<span class="nt">&lt;/rows&gt;</span>
            <span class="nt">&lt;results&gt;</span>
                <span class="nt">&lt;item&gt;</span>
                    <span class="nt">&lt;user_id&gt;</span>102<span class="nt">&lt;/user_id&gt;</span>
                    <span class="nt">&lt;org_id&gt;</span>29<span class="nt">&lt;/org_id&gt;</span>
                    <span class="nt">&lt;firstname&gt;</span>Tom<span class="nt">&lt;/firstname&gt;</span>
                    <span class="nt">&lt;lastname&gt;</span>Sawyer<span class="nt">&lt;/lastname&gt;</span>
                    <span class="nt">&lt;mobile&gt;</span>44700900000<span class="nt">&lt;/mobile&gt;</span>
                    <span class="nt">&lt;email&gt;</span>tom.sawyer@example.com<span class="nt">&lt;/email&gt;</span>
                    <span class="nt">&lt;external_id&gt;</span>None<span class="nt">&lt;/external_id&gt;</span>
                    <span class="nt">&lt;gender&gt;</span>M<span class="nt">&lt;/gender&gt;</span>
                    <span class="nt">&lt;loyalty_points&gt;</span>355<span class="nt">&lt;/loyalty_points&gt;</span>
                    <span class="nt">&lt;lifetime_points&gt;</span>5400<span class="nt">&lt;/lifetime_points&gt;</span>
                    <span class="nt">&lt;lifetime_purchases&gt;</span>10800<span class="nt">&lt;/lifetime_purchases&gt;</span>
                    <span class="nt">&lt;current_slab&gt;</span>CLASSIC<span class="nt">&lt;/current_slab&gt;</span>
                    <span class="nt">&lt;registered_on&gt;</span>2012-12-25 11:25:32<span class="nt">&lt;/registered_on&gt;</span>
                    <span class="nt">&lt;registered_by&gt;</span>pe.london.bondstreet<span class="nt">&lt;/registered_by&gt;</span>
                    <span class="nt">&lt;last_trans_value&gt;</span>1000<span class="nt">&lt;/last_trans_value&gt;</span>
                    <span class="nt">&lt;attributes&gt;</span>
                        <span class="nt">&lt;attribute&gt;</span>
                            <span class="nt">&lt;name&gt;</span>customer_age<span class="nt">&lt;/name&gt;</span>
                            <span class="nt">&lt;value&gt;</span>26-35<span class="nt">&lt;/value&gt;</span>
                        <span class="nt">&lt;/attribute&gt;</span>
                    <span class="nt">&lt;/attributes&gt;</span>
                <span class="nt">&lt;/item&gt;</span>
                <span class="nt">&lt;item&gt;</span>
                    <span class="nt">&lt;user_id&gt;</span>122<span class="nt">&lt;/user_id&gt;</span>
                    <span class="nt">&lt;org_id&gt;</span>29<span class="nt">&lt;/org_id&gt;</span>
                    <span class="nt">&lt;firstname&gt;</span>John<span class="nt">&lt;/firstname&gt;</span>
                    <span class="nt">&lt;lastname&gt;</span>Smith<span class="nt">&lt;/lastname&gt;</span>
                    <span class="nt">&lt;mobile&gt;</span>44700900888<span class="nt">&lt;/mobile&gt;</span>
                    <span class="nt">&lt;email&gt;</span>john.smith@example.com<span class="nt">&lt;/email&gt;</span>
                    <span class="nt">&lt;external_id&gt;</span>None<span class="nt">&lt;/external_id&gt;</span>
                    <span class="nt">&lt;loyalty_points&gt;</span>355<span class="nt">&lt;/loyalty_points&gt;</span>
                    <span class="nt">&lt;lifetime_points&gt;</span>355<span class="nt">&lt;/lifetime_points&gt;</span>
                    <span class="nt">&lt;lifetime_purchases&gt;</span>4598<span class="nt">&lt;/lifetime_purchases&gt;</span>
                    <span class="nt">&lt;current_slab&gt;</span>CLASSIC<span class="nt">&lt;/current_slab&gt;</span>
                    <span class="nt">&lt;registered_on&gt;</span>2012-12-25 11:25:32<span class="nt">&lt;/registered_on&gt;</span>
                    <span class="nt">&lt;registered_by&gt;</span>pe.london.bondstreet<span class="nt">&lt;/registered_by&gt;</span>
                    <span class="nt">&lt;last_trans_value&gt;</span>1000<span class="nt">&lt;/last_trans_value&gt;</span>
                    <span class="nt">&lt;attributes&gt;</span>
                        <span class="nt">&lt;attribute&gt;</span>
                            <span class="nt">&lt;name&gt;</span>occupation<span class="nt">&lt;/name&gt;</span>
                            <span class="nt">&lt;value&gt;</span>Student<span class="nt">&lt;/value&gt;</span>
                        <span class="nt">&lt;/attribute&gt;</span>
                        <span class="nt">&lt;attribute&gt;</span>
                            <span class="nt">&lt;name&gt;</span>customer_age<span class="nt">&lt;/name&gt;</span>
                            <span class="nt">&lt;value&gt;</span>19-25<span class="nt">&lt;/value&gt;</span>
                        <span class="nt">&lt;/attribute&gt;</span>
                    <span class="nt">&lt;/attributes&gt;</span>
                <span class="nt">&lt;/item&gt;</span>
            <span class="nt">&lt;/results&gt;</span>
        <span class="nt">&lt;/customer&gt;</span>
    <span class="nt">&lt;/response&gt;</span>
</code></pre>
<p>This API allows you to fetch customers based on different parameters such as such as name, customer identifier, duration and store id. Besides these you can also fetch customers based on registered date, loyalty points, lifetime points, lifetime purchases amount, current tier, transaction amount and custom field values.</p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>customer/search</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Method</td>
<td>GET</td>
</tr>
<tr>
<td>Batch Support</td>
<td>Yes</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/customer/search?format=&lt;xml/json&gt;&amp;&lt;input_params&gt;</code></p>

<h3 id="request-parameters">Request Parameters</h3>

<p>You need to learn Query Grammar to understand how to use input parameters for customer/search API. For more details, see the Query Grammar section.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>firstname*</td>
<td>Retrieves the list of customers whose first name matches with the string passed. <br><strong>Query</strong>: <code class="prettyprint">firstname:EXACT:&lt;first name&gt;</code></td>
</tr>
<tr>
<td>lastname*</td>
<td>Retrieves the list of customers whose last name matches with the string passed.<br> <br><strong>Query</strong>: <code class="prettyprint">lastname:EXACT:&lt;last Name&gt;</code></td>
</tr>
<tr>
<td>org_id*</td>
<td>Retrieves the list of entire customers of the respective organization. <br><strong>Query</strong>: <code class="prettyprint">org_id:EQUALS:&lt;org id&gt;</code></td>
</tr>
<tr>
<td>mobile*</td>
<td>Retrieves customers whose registered mobile numbers matches with the string passed. <br><strong>Query</strong>: <code class="prettyprint">mobile:EQUALS:&lt;mobile number&gt;</code></td>
</tr>
<tr>
<td>email*</td>
<td>Retrieves the list of registered customers whose email id matches with the string passed. <br><strong>Query</strong>: <code class="prettyprint">email:EQUALS:&lt;email id&gt;</code></td>
</tr>
<tr>
<td>external_id</td>
<td>Retrieves customers whose external id matches with the string passed. <br><strong>Query</strong>: <code class="prettyprint">external_id:EQUALS:&lt;external id&gt;</code></td>
</tr>
<tr>
<td>registered_date</td>
<td>Retrieves customers whose registered date matches the specified date.</td>
</tr>
<tr>
<td>loyalty_points</td>
<td>Retrieves the list of customers whose active loyalty points matches the specified query. <br><strong>Query</strong>: <code class="prettyprint">loyalty_points:GREATER:&lt;lyalty points&gt;</code></td>
</tr>
<tr>
<td>lifetime_points</td>
<td>Retrieves the list of customers whose lifetime points matches the specified query. <br><strong>Query</strong>: <code class="prettyprint">lifetime_points:GREATER:&lt;lifetime points&gt;</code></td>
</tr>
<tr>
<td>lifetime_purchases</td>
<td>Retrieves the list of customers whose lifetime purchases amount matches the specified query. <strong>Query</strong>: <code class="prettyprint">lifetime_purchases:GREATER:&lt;lifetime purchases&gt;</code></td>
</tr>
<tr>
<td>slab</td>
<td>Retrieves the list of customers whose current loyalty tier matches the specified value. <br><strong>Query</strong>: <code class="prettyprint">slab:EQUALS:&lt;Slab name&gt;</code></td>
</tr>
<tr>
<td>registered_store</td>
<td>Retrieves the list of customers who are registered at a specific store. <br><strong>Query</strong>: <code class="prettyprint">registered_store:EQUALS:&lt;Store id&gt;</code></td>
</tr>
<tr>
<td>last_trans_value</td>
<td>Retrieves the list of customers whose transaction amount matches the specified query. <br><strong>Query</strong>: <code class="prettyprint">transaction_value:GREATER:&lt;transaction amount&gt;</code></td>
</tr>
<tr>
<td>Custom fields</td>
<td>Retrieves the list of customers whose custom field values matches the specified value. <br><strong>Query</strong>: <code class="prettyprint">&lt;Field Name&gt;:&lt;Field Value&gt;</code></td>
</tr>
</tbody></table>

<h3 id="query-grammar">Query Grammar</h3>

<p>This section guides how to use queries for achieving results as per needed.
<strong>QUERY</strong>: <code class="prettyprint">(CONDITION) | (CONDITION &amp; (CONDITION)*)</code></p>

<p><strong>CONDITION</strong>: <code class="prettyprint">ATTRIBUTE:OPERATOR:VALUES</code></p>

<p><strong>ATTRIBUTE</strong>: Set of inventory/customer attributes that are searchable</p>

<p><strong>Dynamic List</strong>
* <strong>OPERATOR</strong>: STARTS, ENDS, EXACT, RANGE, LESS, GREATER, EQUALS, IN
* <strong>VALUES</strong>: ALPHANUMERIC | ALPHANUMERIC;ALPHANUMERIC(for RANGE, IN OPERATOR, separator is &rsquo;;&rsquo; )</p>

<h2 id="retrieve-customer-transactions">Retrieve Customer Transactions</h2>
<pre class="highlight html"><code>http://api.capillary.co.in/v1.1/customer/get?format=xml<span class="err">&amp;</span>mobile=44700900000<span class="err">&amp;</span>start_date=2013-12-21+23:45:45<span class="err">&amp;</span>end_date=2013-12-29+12:11:45
</code></pre><pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
</span><span class="p">},</span><span class="w"> 
</span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900000"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tom.sawyer@example.com"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ts1234"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"firstname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tom"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"lastname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sawyer"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"lifetime_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"13700"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"lifetime_purchases"</span><span class="p">:</span><span class="w"> </span><span class="s2">"138000"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"loyalty_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12000"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"registered_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-07-10 11:11:15"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"updated_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-12-25 11:19:11"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"current_slab"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gold"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="s2">"26"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"23622808"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"rows"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"transactions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="nt">"transaction"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"23622808"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ANBDCGD"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"REGULAR"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3000"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"notes"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bill added by mobile"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"billing_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-12-16 17:02:22"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"gross_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3000"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"store"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"points"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="nt">"issued"</span><span class="p">:</span><span class="w"> </span><span class="s2">"30"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"redeemed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20"</span><span class="w">
</span><span class="p">},</span><span class="w"> 
</span><span class="nt">"coupons"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"basket_size"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10"</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"line_items"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="nt">"line_item"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre><pre class="highlight xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
    <span class="nt">&lt;response&gt;</span>
        <span class="nt">&lt;status&gt;</span>
            <span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
            <span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>
            <span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>
        <span class="nt">&lt;/status&gt;</span>
        <span class="nt">&lt;customer&gt;</span>
            <span class="nt">&lt;mobile&gt;</span>44700900000<span class="nt">&lt;/mobile&gt;</span>
            <span class="nt">&lt;email&gt;</span>tom.sawyer@example.com<span class="nt">&lt;/email&gt;</span>
            <span class="nt">&lt;external_id&gt;</span>ts1234<span class="nt">&lt;/external_id&gt;</span>
            <span class="nt">&lt;firstname&gt;</span>Tom<span class="nt">&lt;/firstname&gt;</span>
            <span class="nt">&lt;lastname&gt;</span>Sawyer<span class="nt">&lt;/lastname&gt;</span>
            <span class="nt">&lt;lifetime_points&gt;</span>13700<span class="nt">&lt;/lifetime_points&gt;</span>
            <span class="nt">&lt;lifetime_purchases&gt;</span>138000<span class="nt">&lt;/lifetime_purchases&gt;</span>
            <span class="nt">&lt;loyalty_points&gt;</span>12000<span class="nt">&lt;/loyalty_points&gt;</span>
            <span class="nt">&lt;registered_on&gt;</span>2013-07-10 11:11:15<span class="nt">&lt;/registered_on&gt;</span>
            <span class="nt">&lt;updated_on&gt;</span>2013-12-25 11:19:11<span class="nt">&lt;/updated_on&gt;</span>
            <span class="nt">&lt;current_slab&gt;</span>gold<span class="nt">&lt;/current_slab&gt;</span>
            <span class="nt">&lt;count&gt;</span>26<span class="nt">&lt;/count&gt;</span>
            <span class="nt">&lt;start&gt;</span>23622808<span class="nt">&lt;/start&gt;</span>
            <span class="nt">&lt;rows&gt;</span>10<span class="nt">&lt;/rows&gt;</span>
            <span class="nt">&lt;transactions&gt;</span>
                <span class="nt">&lt;transaction&gt;</span>
                    <span class="nt">&lt;id&gt;</span>23622808<span class="nt">&lt;/id&gt;</span>
                    <span class="nt">&lt;number&gt;</span>ANBDCGD<span class="nt">&lt;/number&gt;</span>
                    <span class="nt">&lt;type&gt;</span>REGULAR<span class="nt">&lt;/type&gt;</span>
                    <span class="nt">&lt;amount&gt;</span>3000<span class="nt">&lt;/amount&gt;</span>
                    <span class="nt">&lt;notes&gt;</span>Bill added by mobile<span class="nt">&lt;/notes&gt;</span>
                    <span class="nt">&lt;billing_time&gt;</span>2013-12-16 17:02:22<span class="nt">&lt;/billing_time&gt;</span>
                    <span class="nt">&lt;gross_amount&gt;</span>3000<span class="nt">&lt;/gross_amount&gt;</span>
                    <span class="nt">&lt;discount&gt;</span>10<span class="nt">&lt;/discount&gt;</span>
                    <span class="nt">&lt;store&gt;&lt;/store&gt;</span>
                    <span class="nt">&lt;points&gt;</span>
                        <span class="nt">&lt;issued&gt;</span>30<span class="nt">&lt;/issued&gt;</span>
                        <span class="nt">&lt;redeemed&gt;</span>20<span class="nt">&lt;/redeemed&gt;</span>
                    <span class="nt">&lt;/points&gt;</span>
                    <span class="nt">&lt;coupons&gt;&lt;/coupons&gt;</span>
                    <span class="nt">&lt;basket_size&gt;</span>10<span class="nt">&lt;/basket_size&gt;</span>
                    <span class="nt">&lt;line_items&gt;</span>
                        <span class="nt">&lt;line_item&gt;&lt;/line_item&gt;</span>
                    <span class="nt">&lt;/line_items&gt;</span>
                <span class="nt">&lt;/transaction&gt;</span>
            <span class="nt">&lt;/transactions&gt;</span>
        <span class="nt">&lt;/customer&gt;</span>
    <span class="nt">&lt;/response&gt;</span>



</code></pre>
<p>This API allows you to retrieve transactions history of a customer which includes the following information.</p>

<p>Transaction type, gross transaction amount, transaction date, points issued, points redeemed, coupons redeemed and so on. </p>

<p>You can filter the results for better understanding and sort the information in ascending or descending order.</p>

<aside class="notice">You cannot retrieve individual line-item level details of a transaction.</aside>

<p>You can also use filters to see and analyze the data that is required and hide data that you don’t want to see. For more details on supported filters, see the below <strong><em>Request Parameters</em></strong> table.</p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>customer/transactions</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Method</td>
<td>GET</td>
</tr>
<tr>
<td>Batch Support</td>
<td>Yes</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://us.intouch.capillarytech.com/v1.1/customer/transactions?format=&lt;xml/json&gt;&amp;&lt;input_params&gt;</code></p>

<h3 id="request-parameters">Request Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Customer Identifier*</td>
<td>Provide the primary identifier of the customer to fetch the transaction details - mobile no./email id/external id. <br>To retrieve transactions of multiple customers at a time, provide each customer&rsquo;s identifier separating by a comma. <br><strong>Example</strong>: <code class="prettyprint">mobile=44700900000,44700900999,4470090345</code></td>
</tr>
<tr>
<td>store_id</td>
<td>Retrieves transactions made at a specific store</td>
</tr>
<tr>
<td>start_id</td>
<td>Retrieves transactions made in a specific duration (start_date to end_date)</td>
</tr>
<tr>
<td>end_date</td>
<td>Retrieves transactions made in a specific duration (start_date to end_date). <br>Example: <code class="prettyprint">start_date=2013-12-21+23:45:45&amp;end_date=2013-12-29+12:11:45</code></td>
</tr>
<tr>
<td>transaction_id</td>
<td>Retrieves the details of a specific transactions.</td>
</tr>
<tr>
<td>transaction_date</td>
<td>Retrieves the transactions made on a specific date. Date format: YYYY-MM-DD</td>
</tr>
<tr>
<td>order</td>
<td>Alligns the list in ascending or descendending order of transaction date/transaction id based on the following parameters. <br><strong>Value</strong>: trans_id, trans_date</td>
</tr>
<tr>
<td>asc</td>
<td>Sorts the transaction history in the ascending order of transaction date or transaction id. <br><strong>Query</strong>: sort=desc</td>
</tr>
<tr>
<td>Desc</td>
<td>Sorts the transaction history in the descending order of transaction date or transaction id. <br><strong>Query</strong>: sort=desc</td>
</tr>
</tbody></table>

<h2 id="add-customer-notes">Add Customer Notes</h2>
<pre class="highlight html"><code>http://intouch.capillary.co.in/v1.1/customer/notes?format=json
</code></pre>
<blockquote>
<p>Sample POST Request</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"root"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900999"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"catherine@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ct123"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"loyalty_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"434412"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"associate_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"443"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"notes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"note"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-05-05 15:15:00"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Likes Maggi"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;root&gt;</span>
    <span class="nt">&lt;customer&gt;</span>
        <span class="nt">&lt;user_id&gt;</span>15<span class="nt">&lt;/user_id&gt;</span>
        <span class="nt">&lt;mobile&gt;</span>44700900999<span class="nt">&lt;/mobile&gt;</span>
        <span class="nt">&lt;email&gt;</span>catherine@example.com<span class="nt">&lt;/email&gt;</span>
        <span class="nt">&lt;external_id&gt;</span>ct123<span class="nt">&lt;/external_id&gt;</span>
        <span class="nt">&lt;loyalty_id&gt;</span>434412<span class="nt">&lt;/loyalty_id&gt;</span>
        <span class="nt">&lt;associate_id&gt;</span>443<span class="nt">&lt;/associate_id&gt;</span>
        <span class="nt">&lt;notes&gt;</span>
            <span class="nt">&lt;note&gt;</span>
                <span class="nt">&lt;id&gt;</span>15<span class="nt">&lt;/id&gt;</span>
                <span class="nt">&lt;date&gt;</span>2016-05-05 15:15:00<span class="nt">&lt;/date&gt;</span>
                <span class="nt">&lt;description&gt;</span>Likes Maggi<span class="nt">&lt;/description&gt;</span>
            <span class="nt">&lt;/note&gt;</span>
            <span class="nt">&lt;/notes&gt;</span>
    <span class="nt">&lt;/customer&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Operation Successful"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15098"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"firstname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Catherine"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"lastname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Thomas"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900999"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"catherine@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ct123"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"associate_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"443"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"notes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"note"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-1"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-05-05 15:15:00"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Likes Maggi"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Operation Successful"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;response&gt;</span>
<span class="nt">&lt;status&gt;</span>
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
<span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>
<span class="nt">&lt;message&gt;</span>Operation Successful<span class="nt">&lt;/message&gt;</span>
<span class="nt">&lt;/status&gt;</span>
<span class="nt">&lt;customer&gt;</span>
    <span class="nt">&lt;user_id&gt;</span>15098<span class="nt">&lt;/user_id&gt;</span>
    <span class="nt">&lt;firstname&gt;</span>catherine<span class="nt">&lt;/firstname&gt;</span>
    <span class="nt">&lt;lastname&gt;</span>Thomas<span class="nt">&lt;/lastname&gt;</span>
    <span class="nt">&lt;mobile&gt;</span>44700900999<span class="nt">&lt;/mobile&gt;</span>
    <span class="nt">&lt;email&gt;</span>catherine@example.com<span class="nt">&lt;/email&gt;</span>
    <span class="nt">&lt;external_id&gt;</span>ct123<span class="nt">&lt;/external_id&gt;</span>
<span class="nt">&lt;associate_id&gt;</span>443<span class="nt">&lt;/associate_id&gt;</span>
<span class="nt">&lt;notes&gt;</span>
            <span class="nt">&lt;note&gt;</span>
                <span class="nt">&lt;id&gt;</span>-1<span class="nt">&lt;/id&gt;</span>
                <span class="nt">&lt;date&gt;</span>2012-05-05 15:15:00<span class="nt">&lt;/date&gt;</span>
                <span class="nt">&lt;description&gt;</span>Likes Maggi<span class="nt">&lt;/description&gt;</span>
            <span class="nt">&lt;/note&gt;</span>

<span class="nt">&lt;/notes&gt;</span>
<span class="nt">&lt;item_status&gt;</span>
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
<span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>
<span class="nt">&lt;message&gt;</span>Operation Successful<span class="nt">&lt;/message&gt;</span>
<span class="nt">&lt;/item_status&gt;</span>
<span class="nt">&lt;/customer&gt;</span>
<span class="nt">&lt;/response&gt;</span>

</code></pre>
<p>This API allows you to record additional information about the customer in a plain text format.</p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>customer/notes</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Method</td>
<td>POST</td>
</tr>
<tr>
<td>Batch Support</td>
<td>No</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/customer/notes?format=xml/json</code></p>

<h3 id="request-parameters">Request Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Customer id</td>
<td>Unique identifier of the customer for whom you want to create notes (mobile no/email id/external id)</td>
</tr>
<tr>
<td>associate_id</td>
<td>Unique id of the associate who is creating the notes</td>
</tr>
<tr>
<td>date</td>
<td>Date on which the customer note is added</td>
</tr>
<tr>
<td>description</td>
<td>Short description of the note</td>
</tr>
</tbody></table>

<h2 id="retrieve-customer-notes">Retrieve Customer Notes</h2>
<pre class="highlight html"><code># Sample Request
http://us.intouch.capillarytech.com/v1.1/customer/notes?format=json<span class="err">&amp;</span>identifier=44700900999<span class="err">&amp;</span>associate_id=234
</code></pre><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Operation Successful"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15098"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"firstname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Catherine"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"lastname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Thomas"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900999"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"catherine@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ct123"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"notes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"note"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Like to play cricket"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"added_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-09-04 15:12:00"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Subscribed for birthday wishes"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"added_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-09-04 15:12:00"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nothing more"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"added_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-09-04 15:12:00"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1000"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Operation Successful"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;response&gt;</span>
<span class="nt">&lt;status&gt;</span>
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
<span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>
<span class="nt">&lt;message&gt;</span>Operation Successful<span class="nt">&lt;/message&gt;</span>
<span class="nt">&lt;/status&gt;</span>
<span class="nt">&lt;customer&gt;</span>
    <span class="nt">&lt;user_id&gt;</span>15098<span class="nt">&lt;/user_id&gt;</span>
<span class="c">&lt;!-- 
user_id tag will be returned only if query param user_id = true 
--&gt;</span>

    <span class="nt">&lt;firstname&gt;</span>Catherine<span class="nt">&lt;/firstname&gt;</span>
    <span class="nt">&lt;lastname&gt;</span>Thomas<span class="nt">&lt;/lastname&gt;</span>
    <span class="nt">&lt;mobile&gt;</span>44700900999<span class="nt">&lt;/mobile&gt;</span>
    <span class="nt">&lt;email&gt;</span>catherine@example.com<span class="nt">&lt;/email&gt;</span>
    <span class="nt">&lt;external_id&gt;</span>ct123<span class="nt">&lt;/external_id&gt;</span>
<span class="nt">&lt;notes&gt;</span>
    <span class="nt">&lt;note&gt;</span>
        <span class="nt">&lt;id&gt;</span>1<span class="nt">&lt;/id&gt;</span>
    <span class="nt">&lt;description&gt;</span>Like to play cricket<span class="nt">&lt;/description&gt;</span>
    <span class="nt">&lt;added_on&gt;</span>2016-09-04 15:12:00<span class="nt">&lt;/added_on&gt;</span>
    <span class="nt">&lt;/note&gt;</span>
    <span class="nt">&lt;note&gt;</span>
        <span class="nt">&lt;id&gt;</span>2<span class="nt">&lt;/id&gt;</span>
    <span class="nt">&lt;description&gt;</span>Subscribed for birthday wishes<span class="nt">&lt;/description&gt;</span>
    <span class="nt">&lt;added_on&gt;</span>2016-09-04 15:12:00<span class="nt">&lt;/added_on&gt;</span>
    <span class="nt">&lt;/note&gt;</span>
    <span class="nt">&lt;note&gt;</span>
        <span class="nt">&lt;id&gt;</span>3<span class="nt">&lt;/id&gt;</span>
    <span class="nt">&lt;description&gt;</span>nothing more<span class="nt">&lt;/description&gt;</span>
    <span class="nt">&lt;added_on&gt;</span>2016-09-04 15:12:00<span class="nt">&lt;/added_on&gt;</span>
    <span class="nt">&lt;/note&gt;</span>
<span class="nt">&lt;/notes&gt;</span>
<span class="nt">&lt;item_status&gt;</span>
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
<span class="nt">&lt;code&gt;</span>1000<span class="nt">&lt;/code&gt;</span>
<span class="nt">&lt;message&gt;</span>Operation Successful<span class="nt">&lt;/message&gt;</span>
<span class="nt">&lt;/item_status&gt;</span>
<span class="nt">&lt;/customer&gt;</span>
<span class="nt">&lt;/response&gt;</span>
</code></pre>
<p>This API allows you to fetch notes of a customer created by a specific associate.</p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>customer/notes</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Method</td>
<td>GET</td>
</tr>
<tr>
<td>Batch Support</td>
<td>No</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/customer/notes?format=xml&amp;&lt;identifier&gt;=&lt;value&gt;&amp;associate_id=&lt;ids&gt;</code></p>

<h3 id="request-parameters">Request Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Customer id</td>
<td>Unique identifier of the customer for whom you want to create notes (mobile no/email id/external id)</td>
</tr>
<tr>
<td>associate_id</td>
<td>Unique id of the associate who is creating the notes</td>
</tr>
</tbody></table>

<h2 id="retrieve-customer-coupons">Retrieve Customer Coupons</h2>
<pre class="highlight html"><code># Sample Request
http://api.capillary.co.in/v1.1/customer/coupons?format=json<span class="err">&amp;</span>mobile=44700900990
</code></pre><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"customers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"firstname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"lastname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Doe"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"johndoe@example.com"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900999"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EXT001"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1034"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"coupons"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"coupon"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2423525"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"redemption_count"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"created_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"
2013-12-13T16:14:54+05:30"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"valid_till"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-21"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VOCU24902"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"transaction_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"
BILL-10304"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"redemptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nt">"redemption"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nt">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-12 12:12:12"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"transaction_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"
BIL2042040"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"redeemed_at"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                  </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"storecode"</span><span class="p">,</span><span class="w">
                  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My store"</span><span class="w">
                </span><span class="p">}</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1000"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Issued coupons retrieved successfully"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;response&gt;</span>
    <span class="nt">&lt;status&gt;</span>
        <span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
            <span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>
        <span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>
    <span class="nt">&lt;/status&gt;</span>
    <span class="nt">&lt;customers&gt;</span>
    <span class="nt">&lt;customer&gt;</span>
    <span class="nt">&lt;firstname&gt;</span>John<span class="nt">&lt;/firstname&gt;</span>
    <span class="nt">&lt;lastname&gt;</span>Doe<span class="nt">&lt;/lastname&gt;</span>
        <span class="nt">&lt;email&gt;</span>johndoe@example.com<span class="nt">&lt;/email&gt;</span>
        <span class="nt">&lt;mobile&gt;</span>44700900999<span class="nt">&lt;/mobile&gt;</span>
        <span class="nt">&lt;external_id&gt;</span>EXT001<span class="nt">&lt;/external_id&gt;</span>
        <span class="nt">&lt;id&gt;</span>1034<span class="nt">&lt;/id&gt;</span>
        <span class="nt">&lt;coupons&gt;</span>
            <span class="nt">&lt;coupon&gt;</span>
                <span class="nt">&lt;id&gt;</span>2423525<span class="nt">&lt;/id&gt;</span>
                <span class="nt">&lt;redemption_count&gt;</span>1<span class="nt">&lt;/redemption_count&gt;</span>
                <span class="nt">&lt;created_date&gt;</span>
2013-12-13T16:14:54+05:30<span class="nt">&lt;/created_date&gt;</span>
                <span class="nt">&lt;valid_till&gt;</span>2016-12-21<span class="nt">&lt;/valid_till&gt;</span>
                <span class="nt">&lt;code&gt;</span>VOCU24902<span class="nt">&lt;/code&gt;</span>
            <span class="nt">&lt;transaction_number&gt;</span>
BILL-10304<span class="nt">&lt;/transaction_number&gt;</span>
                <span class="nt">&lt;redemptions&gt;</span>
                    <span class="nt">&lt;redemption&gt;</span>
                            <span class="nt">&lt;date&gt;</span>2016-12-12 12:12:12<span class="nt">&lt;/date&gt;</span>
                        <span class="nt">&lt;transaction_number&gt;</span>
BIL2042040<span class="nt">&lt;/transaction_number&gt;</span>
                    <span class="nt">&lt;redeemed_at&gt;</span>
                            <span class="nt">&lt;code&gt;</span>storecode<span class="nt">&lt;/code&gt;</span>
                            <span class="nt">&lt;name&gt;</span>My store<span class="nt">&lt;/name&gt;</span>
                        <span class="nt">&lt;/redeemed_at&gt;</span>
                    <span class="nt">&lt;/redemption&gt;</span>
                <span class="nt">&lt;/redemptions&gt;</span>
            <span class="nt">&lt;/coupon&gt;</span>
        <span class="nt">&lt;/coupons&gt;</span>
    <span class="nt">&lt;item_status&gt;</span>
        <span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
        <span class="nt">&lt;code&gt;</span>1000<span class="nt">&lt;/code&gt;</span>
<span class="nt">&lt;message&gt;</span>Issued coupons retrieved successfully<span class="nt">&lt;/message&gt;</span>
    <span class="nt">&lt;/item_status&gt;</span>
    <span class="nt">&lt;/customer&gt;</span>
<span class="nt">&lt;/customers&gt;</span>
<span class="nt">&lt;/response&gt;</span>
</code></pre>
<p>This API allows you to retrieve coupons issued to a customer.</p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>customer/coupons</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Method</td>
<td>GET</td>
</tr>
<tr>
<td>Batch Support</td>
<td>No</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/customer/coupons?format=&lt;json/xml&gt;&amp;&lt;input_params&gt;</code></p>

<h3 id="request-parameters">Request Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Customer identifier*</td>
<td>Pass the mobile no/email id/external id of the customer whose coupons need to be retrieved</td>
</tr>
<tr>
<td>start_date</td>
<td>Retrieve coupons issued in a specific duration - coupons issued between start_date and end_date</td>
</tr>
<tr>
<td>end_date</td>
<td>Retrieve coupons issued in a specific duration - coupons issued between start_date and end_date</td>
</tr>
<tr>
<td>status</td>
<td>Retrieve coupons by coupon status. <br><strong>Values</strong>: redeemed, expired, active. <br>You can also pass more than one status separating each ; (semi-colon)</td>
</tr>
<tr>
<td>series_id</td>
<td>Retrieve details of a specific coupon series issued to the customer</td>
</tr>
<tr>
<td>order_by</td>
<td>Order the results by created date, amount or issued TILL (<code class="prettyprint">created_date</code>, <code class="prettyprint">amount</code>, <code class="prettyprint">valid_till</code>)</td>
</tr>
<tr>
<td>sort_order</td>
<td>Sort the results in ascending (<code class="prettyprint">asc</code>) or descending (<code class="prettyprint">desc</code>) order</td>
</tr>
</tbody></table>

<h2 id="create-new-ticket">Create New Ticket</h2>
<pre class="highlight html"><code># Sample Request
http://us.intouch.capillarytech.com/v1.1/customer/tickets?format=json
</code></pre>
<blockquote>
<p>Sample POST Request</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"root"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"johndoe@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900999"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EXT001"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1034"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"ticket"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OPEN"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"priority"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HIGH"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INTERNAL"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"subject"</span><span class="p">:</span><span class="w"> </span><span class="s2">"points issue"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Unable to redeem points"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"custom_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"field1"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value1"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;root&gt;</span>
    <span class="nt">&lt;customer&gt;</span>
        <span class="nt">&lt;email&gt;</span>johndoe@example.com<span class="nt">&lt;/email&gt;</span>
        <span class="nt">&lt;mobile&gt;</span>44700900999<span class="nt">&lt;/mobile&gt;</span>
        <span class="nt">&lt;external_id&gt;</span>EXT001<span class="nt">&lt;/external_id&gt;</span>
        <span class="nt">&lt;id&gt;</span>1034<span class="nt">&lt;/id&gt;</span>
        <span class="nt">&lt;ticket&gt;</span>
            <span class="nt">&lt;status&gt;</span>OPEN<span class="nt">&lt;/status&gt;</span>
            <span class="nt">&lt;priority&gt;</span>HIGH<span class="nt">&lt;/priority&gt;</span>
            <span class="nt">&lt;department&gt;</span>INTERNAL<span class="nt">&lt;/department&gt;</span>
            <span class="nt">&lt;subject&gt;</span>points issue<span class="nt">&lt;/subject&gt;</span>
            <span class="nt">&lt;message&gt;</span>Unable to redeem points<span class="nt">&lt;/message&gt;</span>
            <span class="nt">&lt;custom_fields&gt;</span>
                <span class="nt">&lt;field&gt;</span>
                    <span class="nt">&lt;name&gt;</span>field1<span class="nt">&lt;/name&gt;</span>
                    <span class="nt">&lt;value&gt;</span>value1<span class="nt">&lt;/value&gt;</span>
                <span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;/custom_fields&gt;</span>
        <span class="nt">&lt;/ticket&gt;</span>
    <span class="nt">&lt;/customer&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"customers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"johndoe@example.com"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900999"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EXT001"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1034"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"ticket"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"35t40ld04"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OPEN"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"priority"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HIGH"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INTERNAL"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"subject"</span><span class="p">:</span><span class="w"> </span><span class="s2">"points issue"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Unable to redeem points"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"custom_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"field1"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value1"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1300"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ticket added successfully"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;response&gt;</span>
    <span class="nt">&lt;status&gt;</span>
        <span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
        <span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>
        <span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>
    <span class="nt">&lt;/status&gt;</span>
    <span class="nt">&lt;customers&gt;</span>
    <span class="nt">&lt;customer&gt;</span>
        <span class="nt">&lt;email&gt;</span>johndoe@example.com<span class="nt">&lt;/email&gt;</span>
        <span class="nt">&lt;mobile&gt;</span>44700900999<span class="nt">&lt;/mobile&gt;</span>
        <span class="nt">&lt;external_id&gt;</span>EXT001<span class="nt">&lt;/external_id&gt;</span>
        <span class="nt">&lt;id&gt;</span>1034<span class="nt">&lt;/id&gt;</span>
        <span class="nt">&lt;ticket&gt;</span>
            <span class="nt">&lt;code&gt;</span>35t40ld04<span class="nt">&lt;/code&gt;</span>
            <span class="nt">&lt;status&gt;</span>OPEN<span class="nt">&lt;/status&gt;</span>
            <span class="nt">&lt;priority&gt;</span>HIGH<span class="nt">&lt;/priority&gt;</span>
            <span class="nt">&lt;department&gt;</span>INTERNAL<span class="nt">&lt;/department&gt;</span>
            <span class="nt">&lt;subject&gt;</span>points issue<span class="nt">&lt;/subject&gt;</span>
            <span class="nt">&lt;message&gt;</span>Unable to redeem points<span class="nt">&lt;/message&gt;</span>
            <span class="nt">&lt;custom_fields&gt;</span>
                <span class="nt">&lt;field&gt;</span>
                    <span class="nt">&lt;name&gt;</span>field1<span class="nt">&lt;/name&gt;</span>
                    <span class="nt">&lt;value&gt;</span>value1<span class="nt">&lt;/value&gt;</span>
                <span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;/custom_fields&gt;</span>
        <span class="nt">&lt;/ticket&gt;</span>
        <span class="nt">&lt;item_status&gt;</span>
            <span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
            <span class="nt">&lt;code&gt;</span>1300<span class="nt">&lt;/code&gt;</span>
            <span class="nt">&lt;message&gt;</span>Ticket added successfully<span class="nt">&lt;/message&gt;</span>
        <span class="nt">&lt;/item_status&gt;</span>
    <span class="nt">&lt;/customer&gt;</span>
    <span class="nt">&lt;/customers&gt;</span>
<span class="nt">&lt;/response&gt;</span>
</code></pre>
<p>This API allows you to create tickets for a customer.</p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>customer/tickets</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Method</td>
<td>POST</td>
</tr>
<tr>
<td>Batch Support</td>
<td>No</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://api.capillary.co.in/v1.1/customer/tickets?format=xml&amp;&lt;input_params&gt;</code></p>

<h3 id="request-parameters">Request Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Customer identifier*</td>
<td>Pass the customer identifier (mobile/email/external_id) for whom you want to create the ticket</td>
</tr>
<tr>
<td>status</td>
<td>Set the status of the ticket</td>
</tr>
<tr>
<td>priority</td>
<td>Set the ticket priority. <br>Value: low, medium, high</td>
</tr>
<tr>
<td>department</td>
<td>Set the department for which the ticket needs to be assigned</td>
</tr>
<tr>
<td>ticket_code</td>
<td>Pass the ticket id</td>
</tr>
<tr>
<td>reported_from</td>
<td>Source from which the ticket needs to be created <br> Values: EMAIL, INTOUCH, CALLCENTER, CLIENT, MICROSITE, SOCIAL</td>
</tr>
<tr>
<td>type</td>
<td>Pass the ticket type <br>Value: STORE, Customer</td>
</tr>
</tbody></table>

<h2 id="retrieve-ticket-details">Retrieve Ticket Details</h2>
<pre class="highlight html"><code># Sample Request
http://us.intouch.capillarytech.com/v1.1/customer/tickets?format=json
</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"firstname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"lastname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Doe"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"johndoe@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900999"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EXT001"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1034"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tickets"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"ticket"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"35t40ld04"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OPEN"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"priority"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HIGH"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INTERNAL"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"subject"</span><span class="p">:</span><span class="w"> </span><span class="s2">"points issue"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Product received is damaged"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"custom_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"field1"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value1"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1300"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ticket retrieved successfully"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;response&gt;</span>
<span class="nt">&lt;status&gt;</span>
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
<span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>
<span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>
<span class="nt">&lt;/status&gt;</span>
<span class="nt">&lt;customer&gt;</span>
    <span class="nt">&lt;firstname&gt;</span>John<span class="nt">&lt;/firstname&gt;</span>
    <span class="nt">&lt;lastname&gt;</span>Doe<span class="nt">&lt;/lastname&gt;</span>
        <span class="nt">&lt;email&gt;</span>johndoe@example.com<span class="nt">&lt;/email&gt;</span>
        <span class="nt">&lt;mobile&gt;</span>44700900999<span class="nt">&lt;/mobile&gt;</span>
        <span class="nt">&lt;external_id&gt;</span>EXT001<span class="nt">&lt;/external_id&gt;</span>
        <span class="nt">&lt;id&gt;</span>1034<span class="nt">&lt;/id&gt;</span>
        <span class="nt">&lt;tickets&gt;</span>
            <span class="nt">&lt;ticket&gt;</span>
            <span class="nt">&lt;code&gt;</span>35t40ld04<span class="nt">&lt;/code&gt;</span>
            <span class="nt">&lt;status&gt;</span>OPEN<span class="nt">&lt;/status&gt;</span>
            <span class="nt">&lt;priority&gt;</span>HIGH<span class="nt">&lt;/priority&gt;</span>
            <span class="nt">&lt;department&gt;</span>INTERNAL<span class="nt">&lt;/department&gt;</span>
            <span class="nt">&lt;subject&gt;</span>points issue<span class="nt">&lt;/subject&gt;</span>
            <span class="nt">&lt;message&gt;</span>Product received is damaged<span class="nt">&lt;/message&gt;</span>
            <span class="nt">&lt;custom_fields&gt;</span>
                <span class="nt">&lt;field&gt;</span>
                    <span class="nt">&lt;name&gt;</span>field1<span class="nt">&lt;/name&gt;</span>
                    <span class="nt">&lt;value&gt;</span>value1<span class="nt">&lt;/value&gt;</span>
                <span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;/custom_fields&gt;</span>                
            <span class="nt">&lt;/ticket&gt;</span>
        <span class="nt">&lt;/tickets&gt;</span>
        <span class="nt">&lt;item_status&gt;</span>
            <span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
            <span class="nt">&lt;code&gt;</span>1300<span class="nt">&lt;/code&gt;</span>
            <span class="nt">&lt;message&gt;</span>Ticket retrieved successfully<span class="nt">&lt;/message&gt;</span>
        <span class="nt">&lt;/item_status&gt;</span>
<span class="nt">&lt;/customer&gt;</span>
<span class="nt">&lt;/response&gt;</span>
</code></pre>
<p>This API allows you to fetch existing tickets of a customer.</p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>customer/tickets</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Method</td>
<td>GET</td>
</tr>
<tr>
<td>Batch Support</td>
<td>Yes</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/customer/tickets?format=&lt;xml/json&gt;&amp;&lt;input_params&gt;</code></p>

<h3 id="request-parameters">Request Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Customer identifier*</td>
<td>Pass the customer identifier (mobile/email/external_id) whose tickets you want to fetch</td>
</tr>
<tr>
<td>status</td>
<td>Retrieve tickets by its status</td>
</tr>
<tr>
<td>priority</td>
<td>Filter results by ticket priority. <br>Value: low, medium, high</td>
</tr>
<tr>
<td>department</td>
<td>Retrieve tickets assigned to a specific department</td>
</tr>
<tr>
<td>ticket_code</td>
<td>Retrieve details of a specific ticket</td>
</tr>
<tr>
<td>reported_from</td>
<td>Retrieve tickets of a specific source <br> Values: EMAIL, INTOUCH, CALLCENTER, CLIENT, MICROSITE, SOCIAL</td>
</tr>
<tr>
<td>type</td>
<td>Retrieve tickets by type <br>Value: STORE, Customer</td>
</tr>
<tr>
<td>start_date</td>
<td>Retrieve tickets created in a specific duration - between start_date to end_date</td>
</tr>
<tr>
<td>end_date</td>
<td>Retrieve tickets created in a specific duration - between start_date to end_date</td>
</tr>
</tbody></table>

<h2 id="response-codes">Response Codes</h2>

<h3 id="success-codes">Success Codes</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>1000</td>
<td>Customer registered successfully.</td>
</tr>
<tr>
<td></td>
<td>Customer retrieved successfully.</td>
</tr>
<tr>
<td></td>
<td>Subscription updated successfully.</td>
</tr>
<tr>
<td></td>
<td>Subscription retrieved successfully</td>
</tr>
<tr>
<td></td>
<td>Customer updated successfully.</td>
</tr>
<tr>
<td></td>
<td>Coupons retrieved successfully.</td>
</tr>
<tr>
<td></td>
<td>Customer notes added/updated successfully</td>
</tr>
<tr>
<td></td>
<td>Customer notes retrieved successfully</td>
</tr>
<tr>
<td></td>
<td>Customer preferences retrieved successfully.</td>
</tr>
<tr>
<td></td>
<td>Customer preferences updated successfully.</td>
</tr>
<tr>
<td>1000</td>
<td>Referral statistics retrieved successfully</td>
</tr>
<tr>
<td></td>
<td>Referrals are invited successfully</td>
</tr>
<tr>
<td>1040</td>
<td>Customer id change request has submitted successfully</td>
</tr>
<tr>
<td>1050</td>
<td>Customer recommendations fetched successfully</td>
</tr>
<tr>
<td>1300</td>
<td>Ticket retrieved successfully</td>
</tr>
<tr>
<td></td>
<td>Ticket added successfully</td>
</tr>
</tbody></table>

<h3 id="error-codes">Error Codes</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>1001</td>
<td>Unable to register. Invalid mobile number</td>
</tr>
<tr>
<td>1002</td>
<td>Unable to register. Invalid email id</td>
</tr>
<tr>
<td>1003</td>
<td>Unable to register. Invalid external id</td>
</tr>
<tr>
<td>1004</td>
<td>Failed to populate store</td>
</tr>
<tr>
<td>1005</td>
<td>Unable to register with mobile number</td>
</tr>
<tr>
<td>1006</td>
<td>Mobile number is required</td>
</tr>
<tr>
<td>1007</td>
<td>Invalid Mobile Number/ External ID/ Email ID</td>
</tr>
<tr>
<td>1008/ 1038</td>
<td>Unable to register with external id</td>
</tr>
<tr>
<td>1009</td>
<td>Unable to add registered customer to MLM</td>
</tr>
<tr>
<td>1010</td>
<td>Unable to update loyalty points of the customer</td>
</tr>
<tr>
<td>1011</td>
<td>Cannot find customer for provided identifier</td>
</tr>
<tr>
<td>1012</td>
<td>Cannot find customer for provided mobile/external-id/e-mail</td>
</tr>
<tr>
<td>1013</td>
<td>Customer not registered for Loyalty Program.</td>
</tr>
<tr>
<td>1014</td>
<td>Customer is registered already</td>
</tr>
<tr>
<td>1015</td>
<td>No identifier provided to get loyalty users</td>
</tr>
<tr>
<td>1016</td>
<td>Email provided already exists for some other user</td>
</tr>
<tr>
<td>1017</td>
<td>Provided Custom Field is invalid</td>
</tr>
<tr>
<td>1018</td>
<td>Unable to update custom field</td>
</tr>
<tr>
<td>1019</td>
<td>Mobile number or external id is required along with the email Id to register</td>
</tr>
<tr>
<td>1020</td>
<td>The customer is not registered for loyalty program</td>
</tr>
<tr>
<td>1021</td>
<td>Invalid validation code</td>
</tr>
<tr>
<td>1023</td>
<td>Unable to register customer to loyalty program</td>
</tr>
<tr>
<td>1024</td>
<td>Unable to update customer profile</td>
</tr>
<tr>
<td>1025</td>
<td>Mandatory fields are not matching for customer identity update</td>
</tr>
<tr>
<td>1026</td>
<td>Count of optional fields match is less than required</td>
</tr>
<tr>
<td>1027</td>
<td>Field name provided for verification is invalid</td>
</tr>
<tr>
<td>1028</td>
<td>No customer notes are available</td>
</tr>
<tr>
<td>1029</td>
<td>Unable to retrieve customer preferences</td>
</tr>
<tr>
<td>1030</td>
<td>Unable to update customer preferences</td>
</tr>
<tr>
<td>1031</td>
<td>No preferences set for this customer</td>
</tr>
<tr>
<td>1032</td>
<td>A customer already exists with the same mobile number</td>
</tr>
<tr>
<td>1033</td>
<td>A customer already exists with the same external id</td>
</tr>
<tr>
<td>1034</td>
<td>Registration date is not within the accepted past or future date limit.</td>
</tr>
<tr>
<td>1035</td>
<td>Some customer preferences could not be updated</td>
</tr>
<tr>
<td>1036</td>
<td>Unable to add/update one or more customer notes</td>
</tr>
<tr>
<td>1037</td>
<td>Unable to add/update customer notes</td>
</tr>
<tr>
<td>1039</td>
<td>Email id is required</td>
</tr>
<tr>
<td>1041</td>
<td>Customer id change request failed</td>
</tr>
<tr>
<td>1042</td>
<td>Invalid mobile no/email id/external id</td>
</tr>
<tr>
<td>1043</td>
<td>Customer’s external id is required</td>
</tr>
<tr>
<td>1044</td>
<td>You do not have sufficient permission to view the customer details</td>
</tr>
<tr>
<td>1045</td>
<td>Either mobile number or email id is required</td>
</tr>
<tr>
<td>1046</td>
<td>Loyalty customer cannot be converted to a to a non-loyalty customer is not allowed</td>
</tr>
<tr>
<td>1047</td>
<td>Customer’s mobile number is required to convert to loyalty customer</td>
</tr>
<tr>
<td>1048</td>
<td>Customer’s email id is required to convert to loyalty customer</td>
</tr>
<tr>
<td>1049</td>
<td>Customer’s external id is required to convert to loyalty customer</td>
</tr>
<tr>
<td>1051</td>
<td>Unable to fetch customer recommendations</td>
</tr>
<tr>
<td>1060</td>
<td>Batch limit exceeded</td>
</tr>
<tr>
<td>1061</td>
<td>Invalid fraud status</td>
</tr>
<tr>
<td>1062</td>
<td>Invalid Test &amp; Control Status</td>
</tr>
<tr>
<td>1086</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>1087</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>1088</td>
<td>Unable to issue points. Please report to capillary support</td>
</tr>
<tr>
<td>1089</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>1090</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>1091</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>1092</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>1093</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>1094</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>1095</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>1096</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>1097</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>1098</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>1099</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>1101</td>
<td>Invalid channel type</td>
</tr>
<tr>
<td>1102</td>
<td>Invalid priority type</td>
</tr>
<tr>
<td>1103</td>
<td>Invalid scope</td>
</tr>
<tr>
<td>1104</td>
<td>Invalid identifier or no identifier passed</td>
</tr>
<tr>
<td>1105</td>
<td>Multiple scopes are not allowed</td>
</tr>
<tr>
<td>1106</td>
<td>Invalid subscription status passed</td>
</tr>
<tr>
<td>1107</td>
<td>Invalid campaign id passed</td>
</tr>
<tr>
<td>1108</td>
<td>Invalid outbox id passed</td>
</tr>
<tr>
<td>1109</td>
<td>Unable to fetch subscription details</td>
</tr>
<tr>
<td>1110</td>
<td>Unable  to update subscription details</td>
</tr>
<tr>
<td>1222</td>
<td>Internal error occurred with the referral system</td>
</tr>
<tr>
<td>1202</td>
<td>Invalid campaign token</td>
</tr>
<tr>
<td>1203</td>
<td>Invalid campaign configured</td>
</tr>
<tr>
<td>1204</td>
<td>The customer may not be eligible for the referral program.</td>
</tr>
<tr>
<td>1205</td>
<td>Unable to find the referrer in the specific campaign</td>
</tr>
<tr>
<td>1206</td>
<td>Referral type is not supported</td>
</tr>
<tr>
<td>1222</td>
<td>Internal error occurred with the referral system</td>
</tr>
<tr>
<td>1301</td>
<td>A ticket already exists with the same subject</td>
</tr>
<tr>
<td>1302</td>
<td>Ticket registration failed</td>
</tr>
<tr>
<td>1303</td>
<td>Ticket subject should not be empty</td>
</tr>
</tbody></table>

          <h1 id="transaction">Transaction</h1>

<p>In Capillary’s platform a transaction represents a purchase or return event. Transactions are categorized into three types based on customer type as explained in the following:</p>

<ul>
<li><p>Loyalty Transactions: Transactions made by registered customers of your organization&rsquo;s loyalty program</p></li>
<li><p>Non-loyalty Transactions: Transactions made by customers who are not registered into your loyalty program, but shared their mobile number or email id with your organization </p></li>
<li><p>Not-interested Transactions: Transactions made by customers who are not interested to register into your organization’s loyalty program. These transactions are also considered as anonymous transactions. </p></li>
</ul>

<p>The transaction entity contains all the necessary APIs to manage transactions and retrieve transaction details. The transaction entity stores regular/return transactions, points/coupons redeemed against transactions, retro transactions (converting not interested transactions to loyalty transactions), and custom fields. </p>

<aside class="notice">
Note: Custom fields are additional fields created in InStore to capture a specific information from customers. For example, favorite color, birthday, favorite brand etc.
</aside>

<p>Transaction APIs allow you to perform the following tasks:</p>

<ul>
<li>Register new customers automatically when submitting transactions </li>
<li>Submit loyalty and non-loyalty transactions </li>
<li>Retrieve list of transactions of a particular store, till, duration or transactions of a specific customer </li>
<li>Assign not interested transactions to specific customers (once they register) - Retro transaction </li>
<li>Redeem points/coupons of customers against their transactions </li>
<li>Retrieve points/coupons redeemed for a particular transaction</li>
</ul>

<h2 id="prerequisites">Prerequisites</h2>

<p>Before using transaction APIs, understand the transaction configurations of your organization. You can see the transaction related settings on InTouch &gt; <strong>Settings</strong> &gt; <strong>Systems &amp; Deployment</strong> &gt; <strong>InTouch PoS Configuration</strong> &gt; <strong>Billing</strong>.</p>

<ul>
<li>Mandatory parameters required to submit a transaction </li>
<li>Whether Retro Transaction is enabled to convert not-interested transactions to regular transactions and the maximum duration for which retro transaction is allowed</li>
<li>Whether Authorization is required for retro transactions</li>
<li>Whether Transaction Return is enabled for your organization (for transaction returns)</li>
<li>Scope of transaction numbers to be unique (store level or TILL level) and duration for which repetition is not allowed (20 days, 30 days etc.)</li>
<li>Maximum and minimum amount allowed per transaction</li>
<li>Maximum and minimum amount allowed per line-item</li>
</ul>

<h2 id="make-transactions">Make Transactions</h2>
<pre class="highlight html"><code>http://us.intouch.capillarytech.com/v1.1/transaction/add?format=json
</code></pre><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"root"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"transaction"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"bill_client_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1121"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"regular"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MyBill-077"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1000"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"notes"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2 line items"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"billing_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-04-01"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"gross_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1000"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"447700900000"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tom.sawer@example.com"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ts1234"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"firstname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tom"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"lastname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sawyer"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"payment_details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"payment"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nt">"mode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CASH"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nt">"mode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CREDIT"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4000"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"custom_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"citybank"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[“n”]"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"line_items"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"line_item"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"serial"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"500"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"soap"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"item_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"item-001"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"qty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"50"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"rate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"500"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"attribute"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"brand"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Levis"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"associate_details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"hiraxdhara"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tom Sawyer"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;root&gt;</span>
   <span class="nt">&lt;transaction&gt;</span>
      <span class="nt">&lt;bill_client_id&gt;</span>1121<span class="nt">&lt;/bill_client_id&gt;</span>
      <span class="c">&lt;!-- bill_client_id is optional --&gt;</span>
      <span class="nt">&lt;type&gt;</span>regular<span class="nt">&lt;/type&gt;</span>
      <span class="nt">&lt;number&gt;</span>MyBill-077<span class="nt">&lt;/number&gt;</span>
      <span class="nt">&lt;amount&gt;</span>1000<span class="nt">&lt;/amount&gt;</span>
      <span class="nt">&lt;notes&gt;</span>2 line items<span class="nt">&lt;/notes&gt;</span>
      <span class="nt">&lt;billing_time&gt;</span>2012-04-01<span class="nt">&lt;/billing_time&gt;</span>
      <span class="nt">&lt;gross_amount&gt;</span>1000<span class="nt">&lt;/gross_amount&gt;</span>
      <span class="nt">&lt;discount&gt;</span>10<span class="nt">&lt;/discount&gt;</span>
      <span class="nt">&lt;customer&gt;</span>
         <span class="nt">&lt;mobile&gt;</span>447700900000<span class="nt">&lt;/mobile&gt;</span>
         <span class="nt">&lt;email&gt;</span>tom.sawer@example.com<span class="nt">&lt;/email&gt;</span>
         <span class="nt">&lt;external_id&gt;</span>ts1234<span class="nt">&lt;/external_id&gt;</span>
         <span class="nt">&lt;firstname&gt;</span>Tom<span class="nt">&lt;/firstname&gt;</span>
         <span class="nt">&lt;lastname&gt;</span>Sawyer<span class="nt">&lt;/lastname&gt;</span>
      <span class="nt">&lt;/customer&gt;</span>
      <span class="nt">&lt;payment_details&gt;</span>
         <span class="nt">&lt;payment&gt;</span>
            <span class="nt">&lt;mode&gt;</span>CASH<span class="nt">&lt;/mode&gt;</span>
            <span class="nt">&lt;value&gt;</span>100<span class="nt">&lt;/value&gt;</span>
         <span class="nt">&lt;/payment&gt;</span>
         <span class="nt">&lt;payment&gt;</span>
            <span class="nt">&lt;mode&gt;</span>CREDIT<span class="nt">&lt;/mode&gt;</span>
            <span class="nt">&lt;value&gt;</span>4000<span class="nt">&lt;/value&gt;</span>
         <span class="nt">&lt;/payment&gt;</span>
      <span class="nt">&lt;/payment_details&gt;</span>
      <span class="nt">&lt;custom_fields&gt;</span>
         <span class="nt">&lt;field&gt;</span>
            <span class="nt">&lt;name&gt;</span>citybank<span class="nt">&lt;/name&gt;</span>
            <span class="nt">&lt;value&gt;</span>[“n”]<span class="nt">&lt;/value&gt;</span>
         <span class="nt">&lt;/field&gt;</span>
      <span class="nt">&lt;/custom_fields&gt;</span>
      <span class="nt">&lt;line_items&gt;</span>
         <span class="nt">&lt;line_item&gt;</span>
            <span class="nt">&lt;serial&gt;</span>1<span class="nt">&lt;/serial&gt;</span>
            <span class="nt">&lt;amount&gt;</span>500<span class="nt">&lt;/amount&gt;</span>
            <span class="nt">&lt;description&gt;</span>soap<span class="nt">&lt;/description&gt;</span>
            <span class="nt">&lt;item_code&gt;</span>item-001<span class="nt">&lt;/item_code&gt;</span>
            <span class="nt">&lt;qty&gt;</span>50<span class="nt">&lt;/qty&gt;</span>
            <span class="nt">&lt;rate&gt;</span>10<span class="nt">&lt;/rate&gt;</span>
            <span class="nt">&lt;value&gt;</span>500<span class="nt">&lt;/value&gt;</span>
            <span class="nt">&lt;attributes&gt;</span>
               <span class="nt">&lt;attribute&gt;</span>
                  <span class="nt">&lt;name&gt;</span>brand<span class="nt">&lt;/name&gt;</span>
                  <span class="nt">&lt;value&gt;</span>Levis<span class="nt">&lt;/value&gt;</span>
               <span class="nt">&lt;/attribute&gt;</span>
            <span class="nt">&lt;/attributes&gt;</span>
         <span class="nt">&lt;/line_item&gt;</span>
      <span class="nt">&lt;/line_items&gt;</span>
      <span class="nt">&lt;associate_details&gt;</span>
         <span class="nt">&lt;code&gt;</span>hiraxdhara<span class="nt">&lt;/code&gt;</span>
         <span class="nt">&lt;name&gt;</span>Tom Sawyer<span class="nt">&lt;/name&gt;</span>
      <span class="nt">&lt;/associate_details&gt;</span>
   <span class="nt">&lt;/transaction&gt;</span>
<span class="nt">&lt;/root&gt;</span>

</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"transactions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"transaction"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5477577"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MyBill-077"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"regular"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"447700900000"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tom.sawer@example.com"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ts1234"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4434563"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"loyalty_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8388607"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"lifetime_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2000000640"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"lifetime_purchases"</span><span class="p">:</span><span class="w"> </span><span class="s2">"
100000033000
"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"current_slab"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SILVER"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"600"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Transaction added successfully"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"side_effects"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"effect"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
              </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"coupon"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"DVS"</span><span class="w">
              </span><span class="p">],</span><span class="w">
              </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ABCDw23"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"456677"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10% off on jeans"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"valid_till"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2011-09-13"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"discount_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DISCOUNT10"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"discount_value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
              </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"points"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"awarded"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"total_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4000"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"bill_client_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1121"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;response&gt;</span>
<span class="nt">&lt;transactions&gt;</span>
<span class="nt">&lt;transaction&gt;</span>
<span class="nt">&lt;id&gt;</span>5477577<span class="nt">&lt;/id&gt;</span>
<span class="nt">&lt;number&gt;</span>MyBill-077<span class="nt">&lt;/number&gt;</span>
<span class="nt">&lt;type&gt;</span>regular<span class="nt">&lt;/type&gt;</span>
<span class="nt">&lt;customer&gt;</span>
<span class="nt">&lt;mobile&gt;</span>447700900000<span class="nt">&lt;/mobile&gt;</span>
<span class="nt">&lt;email&gt;</span>tom.sawer@example.com<span class="nt">&lt;/email&gt;</span>
<span class="nt">&lt;external_id&gt;</span>ts1234<span class="nt">&lt;/external_id&gt;</span>
<span class="nt">&lt;user_id&gt;</span>4434563<span class="nt">&lt;/user_id&gt;</span>
<span class="c">&lt;!-- user_id will only be returned if query param user_id is ‘true’ --&gt;</span>
<span class="nt">&lt;loyalty_points&gt;</span>8388607<span class="nt">&lt;/loyalty_points&gt;</span>
<span class="nt">&lt;lifetime_points&gt;</span>2000000640<span class="nt">&lt;/lifetime_points&gt;</span>
<span class="nt">&lt;lifetime_purchases&gt;</span>
100000033000
<span class="nt">&lt;/lifetime_purchases&gt;</span>
<span class="nt">&lt;current_slab&gt;</span>SILVER<span class="nt">&lt;/current_slab&gt;</span>
<span class="nt">&lt;/customer&gt;</span>
<span class="nt">&lt;item_status&gt;</span>
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
<span class="nt">&lt;code&gt;</span>600<span class="nt">&lt;/code&gt;</span>
<span class="nt">&lt;message&gt;</span>Transaction added successfully<span class="nt">&lt;/message&gt;</span>
<span class="nt">&lt;/item_status&gt;</span>
<span class="c">&lt;!-- v1 Side effects are not listed here --&gt;</span>
<span class="nt">&lt;side_effects&gt;</span>
<span class="nt">&lt;effect&gt;</span>
<span class="nt">&lt;type&gt;</span>coupon<span class="nt">&lt;/type&gt;</span>
<span class="nt">&lt;code&gt;</span>ABCDw23<span class="nt">&lt;/code&gt;</span>
<span class="nt">&lt;id&gt;</span>456677<span class="nt">&lt;/id&gt;</span>
<span class="nt">&lt;description&gt;</span>10% off on jeans<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;type&gt;</span>DVS<span class="nt">&lt;/type&gt;</span>
<span class="nt">&lt;valid_till&gt;</span>2011-09-13<span class="nt">&lt;/valid_till&gt;</span>
<span class="nt">&lt;discount_code&gt;</span>DISCOUNT10<span class="nt">&lt;/discount_code&gt;</span>
<span class="nt">&lt;discount_value&gt;</span>10<span class="nt">&lt;/discount_value&gt;</span>
<span class="nt">&lt;/effect&gt;</span>
<span class="nt">&lt;effect&gt;</span>
<span class="nt">&lt;type&gt;</span>points<span class="nt">&lt;/type&gt;</span>
<span class="nt">&lt;awarded&gt;</span>100<span class="nt">&lt;/awarded&gt;</span>
<span class="nt">&lt;total_points&gt;</span>4000<span class="nt">&lt;/total_points&gt;</span>
<span class="nt">&lt;/effect&gt;</span>
<span class="nt">&lt;/side_effects&gt;</span>
<span class="nt">&lt;bill_client_id&gt;</span>1121<span class="nt">&lt;/bill_client_id&gt;</span> 
<span class="c">&lt;!-- 
bill_client_id will be returned only if it is passed in request xml 
--&gt;</span>
<span class="nt">&lt;/transaction&gt;</span>
<span class="nt">&lt;/transactions&gt;</span>
<span class="nt">&lt;status&gt;</span>
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
<span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>
<span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>
<span class="nt">&lt;/status&gt;</span>
<span class="nt">&lt;/response&gt;</span>
</code></pre>
<p>This API allows you to make regular or not interested transactions. You can submit multiple transactions in an API call time by passing the details of each transaction in a separate <code class="prettyprint">transaction</code> tag. If a new customer identifier is passed, the customer will be registered automatically.</p>

<ul>
<li><strong>Regular Transactions</strong>: To make regular transactions, set <code class="prettyprint">type</code> as <code class="prettyprint">regular</code> and pass the customer’s unique identifier of the customer in the respective tag.</li>
<li><strong>Non-Interested Transactions</strong>: To make not-interested transactions, set <code class="prettyprint">type</code> as <code class="prettyprint">not_interested</code> and customer identifiers are not required for not-interested transactions.</li>
</ul>

<aside class="notice">
When customer information is passed along with the transaction details, customer’s basic information  like name, email id (if it not the customer’s unique identifier), custom fields etc. will be updated to the new values. <br>
If a new customer identifier is passed along with the transaction details, the customer will be registered automatically. 
</aside>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>transaction/add</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Methods</td>
<td>POST</td>
</tr>
<tr>
<td>API Version</td>
<td>v1.1</td>
</tr>
<tr>
<td>Batch Support</td>
<td>Yes</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/transaction/add?format=&lt;xml/json&gt;</code></p>

<h3 id="request-parameters">Request Parameters</h3>

<h2 id="return-transactions">Return Transactions</h2>
<pre class="highlight html"><code># Sample Request
http://us.intouch.capillarytech.com/v1.1/transaction/add?format=json
</code></pre>
<blockquote>
<p>Sample POST Request</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"root"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"transaction"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900000"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"custom_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tom Sawer"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1200"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"store"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"234"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"line_items"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"line_item"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"transaction_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2346"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"rate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"float"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"float"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"qty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.00%"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1300"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"attribute"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">

            </span><span class="p">}</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="nt">"serial"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"return"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"return_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"full"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"credit_note"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1300"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1267"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"gross_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"float"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"float"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"float"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"custom_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">

        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"payment_details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"payment"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"attribute"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Payment Mode"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HDFC Credit Card"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"float"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
    <span class="nt">&lt;root&gt;</span>
        <span class="nt">&lt;transaction&gt;</span>
            <span class="nt">&lt;customer&gt;</span>
                <span class="nt">&lt;user_id&gt;&lt;/user_id&gt;</span>
                <span class="nt">&lt;mobile&gt;</span>44700900000<span class="nt">&lt;/mobile&gt;</span>
                <span class="nt">&lt;local_id&gt;&lt;/local_id&gt;</span>
                <span class="nt">&lt;custom_fields&gt;</span>
                    <span class="nt">&lt;name&gt;</span>Tom Sawer<span class="nt">&lt;/name&gt;</span>  
                    <span class="nt">&lt;value&gt;</span>1200<span class="nt">&lt;/value&gt;</span>
                <span class="nt">&lt;/custom_fields&gt;</span>
                <span class="nt">&lt;external_id&gt;&lt;/external_id&gt;</span>
                <span class="nt">&lt;email&gt;&lt;/email&gt;</span>
                <span class="nt">&lt;store&gt;</span>
                    <span class="nt">&lt;code&gt;</span>123<span class="nt">&lt;/code&gt;</span>
                    <span class="nt">&lt;id&gt;</span>234<span class="nt">&lt;/id&gt;</span>
                <span class="nt">&lt;/store&gt;</span>
            <span class="nt">&lt;/customer&gt;</span>
            <span class="nt">&lt;line_items&gt;</span>
                <span class="nt">&lt;line_item&gt;</span>
                    <span class="nt">&lt;transaction_number&gt;</span>2346<span class="nt">&lt;/transaction_number&gt;</span>
                    <span class="nt">&lt;description&gt;&lt;/description&gt;</span>
                    <span class="nt">&lt;billing_time&gt;&lt;/billing_time&gt;</span>
                    <span class="nt">&lt;rate&gt;</span>float<span class="nt">&lt;/rate&gt;</span>
                    <span class="nt">&lt;value&gt;</span>float<span class="nt">&lt;/value&gt;</span>
                    <span class="nt">&lt;qty&gt;</span>2<span class="nt">&lt;/qty&gt;</span>
                    <span class="nt">&lt;discount&gt;</span>1.00%<span class="nt">&lt;/discount&gt;</span>
                    <span class="nt">&lt;amount&gt;</span>1300<span class="nt">&lt;/amount&gt;</span>
                    <span class="nt">&lt;item_code&gt;&lt;/item_code&gt;</span>
                    <span class="nt">&lt;attributes&gt;</span>
                        <span class="nt">&lt;attribute&gt;</span>
                            <span class="nt">&lt;name&gt;&lt;/name&gt;</span>
                            <span class="nt">&lt;value&gt;&lt;/value&gt;</span>
                        <span class="nt">&lt;/attribute&gt;</span>
                    <span class="nt">&lt;/attributes&gt;</span>
                    <span class="nt">&lt;serial&gt;</span>0<span class="nt">&lt;/serial&gt;</span>
                    <span class="nt">&lt;type&gt;</span>return<span class="nt">&lt;/type&gt;</span>
                    <span class="nt">&lt;return_type&gt;</span>full<span class="nt">&lt;/return_type&gt;</span>
                <span class="nt">&lt;/line_item&gt;</span>
            <span class="nt">&lt;/line_items&gt;</span>
            <span class="nt">&lt;purchase_time&gt;&lt;/purchase_time&gt;</span>
            <span class="nt">&lt;billing_time&gt;&lt;/billing_time&gt;</span>
            <span class="nt">&lt;credit_note&gt;</span>
                <span class="nt">&lt;amount&gt;</span>1300<span class="nt">&lt;/amount&gt;</span>
                <span class="nt">&lt;notes&gt;&lt;/notes&gt;</span>
                <span class="nt">&lt;number&gt;</span>1267<span class="nt">&lt;/number&gt;</span>
            <span class="nt">&lt;/credit_note&gt;</span>
            <span class="nt">&lt;notes&gt;&lt;/notes&gt;</span>
            <span class="nt">&lt;gross_amount&gt;</span>float<span class="nt">&lt;/gross_amount&gt;</span>
            <span class="nt">&lt;number&gt;&lt;/number&gt;</span>
            <span class="nt">&lt;discount&gt;</span>float<span class="nt">&lt;/discount&gt;</span>
            <span class="nt">&lt;amount&gt;</span>float<span class="nt">&lt;/amount&gt;</span>
            <span class="nt">&lt;custom_fields&gt;</span>
                <span class="nt">&lt;field&gt;</span>
                    <span class="nt">&lt;name&gt;&lt;/name&gt;</span>
                    <span class="nt">&lt;value&gt;&lt;/value&gt;</span>
                <span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;/custom_fields&gt;</span>
            <span class="nt">&lt;return_type</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;type</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;payment_details&gt;</span>
                <span class="nt">&lt;payment&gt;</span>
                    <span class="nt">&lt;attributes&gt;</span>
                        <span class="nt">&lt;attribute&gt;</span>
                        <span class="nt">&lt;name&gt;</span>Payment Mode<span class="nt">&lt;/name&gt;</span>
                        <span class="nt">&lt;value&gt;</span>HDFC Credit Card<span class="nt">&lt;/value&gt;</span>
                        <span class="nt">&lt;/attribute&gt;</span>
                    <span class="nt">&lt;/attributes&gt;</span>
                    <span class="nt">&lt;notes&gt;&lt;/notes&gt;</span>
                    <span class="nt">&lt;name&gt;&lt;/name&gt;</span>
                    <span class="nt">&lt;value&gt;</span>float<span class="nt">&lt;/value&gt;</span>
                <span class="nt">&lt;/payment&gt;</span>
            <span class="nt">&lt;/payment_details&gt;</span>
        <span class="nt">&lt;/transaction&gt;</span>
    <span class="nt">&lt;/root&gt;</span>

</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight xml"><code><span class="nt">&lt;response&gt;</span>
<span class="nt">&lt;transactions&gt;</span>
<span class="nt">&lt;transaction&gt;</span>
<span class="nt">&lt;id&gt;</span>32<span class="nt">&lt;/id&gt;</span>
<span class="nt">&lt;number&gt;</span>MyBill-077<span class="nt">&lt;/number&gt;</span>
<span class="nt">&lt;bill_client_id&gt;</span>1121<span class="nt">&lt;/bill_client_id&gt;</span>
<span class="nt">&lt;type&gt;</span>return<span class="nt">&lt;/type&gt;</span>
<span class="nt">&lt;customer&gt;</span>
<span class="nt">&lt;mobile&gt;</span>918167712150<span class="nt">&lt;/mobile&gt;</span>
<span class="nt">&lt;email&gt;</span>tom.sawyer@example.com<span class="nt">&lt;/email&gt;</span>
<span class="nt">&lt;external_id&gt;</span>ts1234<span class="nt">&lt;/external_id&gt;</span>
<span class="nt">&lt;user_id&gt;</span>55453<span class="nt">&lt;/user_id&gt;</span>
<span class="c">&lt;!--     
returned only when query param user_id is true
--&gt;</span>
<span class="nt">&lt;loyalty_points&gt;</span>8388587<span class="nt">&lt;/loyalty_points&gt;</span>
<span class="nt">&lt;lifetime_points&gt;</span>2000000620<span class="nt">&lt;/lifetime_points&gt;</span>
<span class="nt">&lt;lifetime_purchases&gt;</span>100000033000<span class="nt">&lt;/lifetime_purchases&gt;</span>
<span class="nt">&lt;current_slab&gt;</span>SILVER<span class="nt">&lt;/current_slab&gt;</span>
<span class="nt">&lt;/customer&gt;</span>
<span class="nt">&lt;item_status&gt;</span>
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
<span class="nt">&lt;code&gt;</span>600<span class="nt">&lt;/code&gt;</span>
<span class="nt">&lt;message&gt;</span>Transaction added successfully<span class="nt">&lt;/message&gt;</span>
<span class="nt">&lt;/item_status&gt;</span>
<span class="nt">&lt;side_effects&gt;</span>
<span class="nt">&lt;effect&gt;</span>
<span class="nt">&lt;type&gt;</span>points<span class="nt">&lt;/type&gt;</span>
<span class="nt">&lt;awarded_points&gt;</span>19490463<span class="nt">&lt;/awarded_points&gt;</span>
<span class="nt">&lt;total_points&gt;</span>19490463<span class="nt">&lt;/total_points&gt;</span>
<span class="nt">&lt;/effect&gt;</span>
<span class="nt">&lt;effect&gt;</span>
<span class="nt">&lt;type&gt;</span>coupon<span class="nt">&lt;/type&gt;</span>
<span class="nt">&lt;coupon_code&gt;</span>095790<span class="nt">&lt;/coupon_code&gt;</span>
<span class="nt">&lt;description&gt;</span>T description<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;coupon_type&gt;</span>CAMPAIGN<span class="nt">&lt;/coupon_type&gt;</span>
<span class="nt">&lt;valid_till&gt;&lt;/valid_till&gt;</span>
<span class="nt">&lt;id&gt;</span>42601779<span class="nt">&lt;/id&gt;</span>
<span class="nt">&lt;/effect&gt;</span>
<span class="nt">&lt;/side_effects&gt;</span> 
<span class="nt">&lt;points_deducted&gt;</span>20<span class="nt">&lt;/points_deducted&gt;</span>
<span class="nt">&lt;points_balance&gt;</span>8388587<span class="nt">&lt;/points_balance&gt;</span>
<span class="nt">&lt;/transaction&gt;</span>
<span class="nt">&lt;/transactions&gt;</span>
<span class="nt">&lt;status&gt;</span>
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
<span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>
<span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>
<span class="nt">&lt;/status&gt;</span>
<span class="nt">&lt;/response&gt;</span>
</code></pre><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"transactions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"transaction"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"32"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MyBill-077"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"bill_client_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1121"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"return"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"918167712150"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tom.sawyer@example.com"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ts1234"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55453"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"loyalty_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8388587"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"lifetime_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2000000620"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"lifetime_purchases"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100000033000"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"current_slab"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SILVER"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"600"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Transaction added successfully"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"side_effects"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"effect"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
              </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"points"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"awarded_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"19490463"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"total_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"19490463"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
              </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"coupon"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"coupon_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"095790"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"T description"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"coupon_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CAMPAIGN"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"42601779"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"points_deducted"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"points_balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8388587"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>The same transaction/add endpoint can be used to return transactions of registered transactions.  No new transaction is created for return transactions.
This API can supports the following types of return transactions based on the request parameters:
* To return an entire transactions
* To return individual line-items of a transaction
* To return transaction amount</p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Entry</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>transaction/add</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Methods</td>
<td>POST</td>
</tr>
<tr>
<td>API Version</td>
<td>v1.1</td>
</tr>
<tr>
<td>Batch Support</td>
<td>Yes</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://</code><cluster URL>`<code class="prettyprint">/v1.1/transaction/add?format=json</code></p>

<h3 id="request-parameters">Request Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Customer identifier</td>
<td>Unique identifier (mobile no/email id/external id/user id) of the customer whose transaction needs to be returned</td>
</tr>
<tr>
<td>return_type=FULL</td>
<td>To return an entire transaction</td>
</tr>
<tr>
<td>return_type=LINE_ITEM</td>
<td>To return a particular line-item of a transaction</td>
</tr>
<tr>
<td>return_type=AMOUNT</td>
<td>To return the transaction amount instead of replacing items</td>
</tr>
</tbody></table>

<h2 id="update-transaction-details">Update Transaction Details</h2>
<pre class="highlight shell"><code>POST <span class="s2">"http://api.capillary.co.in/v1.1/transaction/update?format=xml"</span>
</code></pre>
<blockquote>
<p>Sample POST Request</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"root"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"transaction"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123234"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BILL-001"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"REGULAR"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34897"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900999"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"earnshaw.catherine@example.com"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ec1234"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"custom_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
              </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Earnshaw Catherine"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value2"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
              </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"field2"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value2"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123234"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BILL-001"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"REGULAR"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34897"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900000"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tom.sawyer@example.com"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ts1234"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"custom_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tom Sawyer"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value2"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;root&gt;</span>
   <span class="nt">&lt;transaction&gt;</span>
      <span class="nt">&lt;id&gt;</span>123234<span class="nt">&lt;/id&gt;</span>
      <span class="c">&lt;!--
         identifies specific transaction without conflict (first priority to identify transaction

         --&gt;</span>
      <span class="nt">&lt;number&gt;</span>BILL-001<span class="nt">&lt;/number&gt;</span>
      <span class="c">&lt;!--
         may have conflict as one customer can have multiple transaction having same bill number, will be updated latest transaction in such cases (first transaction in desc order of billing time)

         --&gt;</span>
      <span class="nt">&lt;type&gt;</span>REGULAR<span class="nt">&lt;/type&gt;</span>
      <span class="c">&lt;!-- this can be REGULAR or NOT_INTERESTED --&gt;</span>
      <span class="nt">&lt;customer&gt;</span>
         <span class="nt">&lt;id&gt;</span>34897<span class="nt">&lt;/id&gt;</span>
         <span class="nt">&lt;mobile&gt;</span>44700900999<span class="nt">&lt;/mobile&gt;</span>
         <span class="nt">&lt;email&gt;</span>earnshaw.catherine@example.com<span class="nt">&lt;/email&gt;</span>
         <span class="nt">&lt;external_id&gt;</span>ec1234<span class="nt">&lt;/external_id&gt;</span>
      <span class="nt">&lt;/customer&gt;</span>
      <span class="nt">&lt;custom_fields&gt;</span>
         <span class="nt">&lt;field&gt;</span>
            <span class="nt">&lt;name&gt;</span>Earnshaw Catherine<span class="nt">&lt;/name&gt;</span>            <span class="nt">&lt;value&gt;</span>value2<span class="nt">&lt;/value&gt;</span>
         <span class="nt">&lt;/field&gt;</span>
         <span class="nt">&lt;field&gt;</span>
            <span class="nt">&lt;name&gt;</span>field2<span class="nt">&lt;/name&gt;</span>
            <span class="nt">&lt;value&gt;</span>value2<span class="nt">&lt;/value&gt;</span>
         <span class="nt">&lt;/field&gt;</span>
      <span class="nt">&lt;/custom_fields&gt;</span>
   <span class="nt">&lt;/transaction&gt;</span>
   <span class="nt">&lt;transaction&gt;</span>
      <span class="nt">&lt;id&gt;</span>123234<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;number&gt;</span>BILL-001<span class="nt">&lt;/number&gt;</span>
      <span class="nt">&lt;type&gt;</span>REGULAR<span class="nt">&lt;/type&gt;</span>
      <span class="c">&lt;!-- this can be REGULAR or NOT_INTERESTED --&gt;</span>
      <span class="nt">&lt;customer&gt;</span>
         <span class="nt">&lt;id&gt;</span>34897<span class="nt">&lt;/id&gt;</span>
         <span class="nt">&lt;mobile&gt;</span>44700900000<span class="nt">&lt;/mobile&gt;</span>
         <span class="nt">&lt;email&gt;</span>tom.sawyer@example.com<span class="nt">&lt;/email&gt;</span>
         <span class="nt">&lt;external_id&gt;</span>ts1234<span class="nt">&lt;/external_id&gt;</span>
      <span class="nt">&lt;/customer&gt;</span>
      <span class="nt">&lt;custom_fields&gt;</span>
         <span class="nt">&lt;field&gt;</span>
            <span class="nt">&lt;name&gt;</span>Tom Sawyer<span class="nt">&lt;/name&gt;</span>
            <span class="nt">&lt;value&gt;</span>value2<span class="nt">&lt;/value&gt;</span>
         <span class="nt">&lt;/field&gt;</span>
      <span class="nt">&lt;/custom_fields&gt;</span>
   <span class="nt">&lt;/transaction&gt;</span>
<span class="nt">&lt;/root&gt;</span>

</code></pre>
<p>This API allows you to convert a not_interested transaction to a regular transaction and update custom field details of a transaction.</p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Entry</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>transaction/update</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Methods</td>
<td>POST</td>
</tr>
<tr>
<td>API Version</td>
<td>v1.1</td>
</tr>
<tr>
<td>Batch Support</td>
<td>Yes</td>
</tr>
</tbody></table>

<h3 id="request-parameters">Request Parameters</h3>

<p>Any one of the following parameter is mandatory.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Transaction id that needs to be updated</td>
</tr>
<tr>
<td>number</td>
<td>Transaction number that needs to be updated</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/transaction/update?format=xml/json</code></p>

<h2 id="retro-transaction">Retro Transaction</h2>
<pre class="highlight html"><code>http://api.capillary.co.in/v1.1/transaction/update?format=json
</code></pre>
<blockquote>
<p>Sample POST Request</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"root"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"transaction"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900999"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ext_id9931156917"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"catherine@example.com"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"new_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"REGULAR"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"notes"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Retro Transaction"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6464658"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"old_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NOT_INTERESTED"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;root&gt;</span>
<span class="nt">&lt;transaction&gt;</span>
<span class="nt">&lt;customer&gt;</span>
<span class="nt">&lt;mobile&gt;</span>44700900999<span class="nt">&lt;/mobile&gt;</span>
<span class="nt">&lt;external_id&gt;</span>ext_id9931156917<span class="nt">&lt;/external_id&gt;</span>
<span class="nt">&lt;email&gt;</span>catherine@example.com<span class="nt">&lt;/email&gt;</span>
<span class="nt">&lt;/customer&gt;</span>
<span class="nt">&lt;new_type&gt;</span>REGULAR<span class="nt">&lt;/new_type&gt;</span>
<span class="nt">&lt;notes&gt;</span>Retro Transaction<span class="nt">&lt;/notes&gt;</span>
<span class="nt">&lt;id&gt;</span>6464658<span class="nt">&lt;/id&gt;</span>
<span class="nt">&lt;old_type&gt;</span>NOT_INTERESTED<span class="nt">&lt;/old_type&gt;</span>
<span class="nt">&lt;/transaction&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"transactions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"transaction"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34007568"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"retronumbr9931156917"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"REGULAR"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"282024042"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900999"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"catherine@example.com"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ext_id9931156917"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"loyalty_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"75"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"lifetime_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"75"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"lifetime_purchases"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1500"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"current_slab"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Platinum"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"tier_expiry_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2117-01-03 23:59:59"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"loyalty"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"delivery_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DELIVERED"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"instore"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1630"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Transaction retrospectively marked REGULAR, Transaction added successfully"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"side_effects"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"effect"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"points"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"awarded_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"75"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"total_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"75"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"old_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6464658"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"old_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NOT_INTERESTED"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;response&gt;</span>
    <span class="nt">&lt;status&gt;</span>
        <span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
        <span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>
        <span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>
    <span class="nt">&lt;/status&gt;</span>
    <span class="nt">&lt;transactions&gt;</span>
        <span class="nt">&lt;transaction&gt;</span>
            <span class="nt">&lt;id&gt;</span>34007568<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;number&gt;</span>retronumbr9931156917<span class="nt">&lt;/number&gt;</span>
            <span class="nt">&lt;type&gt;</span>REGULAR<span class="nt">&lt;/type&gt;</span>
            <span class="nt">&lt;customer&gt;</span>
                <span class="nt">&lt;user_id&gt;</span>282024042<span class="nt">&lt;/user_id&gt;</span>
                <span class="nt">&lt;mobile&gt;</span>44700900999<span class="nt">&lt;/mobile&gt;</span>
                <span class="nt">&lt;email&gt;</span>catherine@example.com<span class="nt">&lt;/email&gt;</span>
                <span class="nt">&lt;external_id&gt;</span>ext_id9931156917<span class="nt">&lt;/external_id&gt;</span>
                <span class="nt">&lt;loyalty_points&gt;</span>75<span class="nt">&lt;/loyalty_points&gt;</span>
                <span class="nt">&lt;lifetime_points&gt;</span>75<span class="nt">&lt;/lifetime_points&gt;</span>
                <span class="nt">&lt;lifetime_purchases&gt;</span>1500<span class="nt">&lt;/lifetime_purchases&gt;</span>
                <span class="nt">&lt;current_slab&gt;</span>Platinum<span class="nt">&lt;/current_slab&gt;</span>
                <span class="nt">&lt;tier_expiry_date&gt;</span>2117-01-03 23:59:59<span class="nt">&lt;/tier_expiry_date&gt;</span>
                <span class="nt">&lt;type&gt;</span>loyalty<span class="nt">&lt;/type&gt;</span>
            <span class="nt">&lt;/customer&gt;</span>
            <span class="nt">&lt;delivery_status&gt;</span>DELIVERED<span class="nt">&lt;/delivery_status&gt;</span>
            <span class="nt">&lt;source&gt;</span>instore<span class="nt">&lt;/source&gt;</span>
            <span class="nt">&lt;item_status&gt;</span>
                <span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
                <span class="nt">&lt;code&gt;</span>1630<span class="nt">&lt;/code&gt;</span>
                <span class="nt">&lt;message&gt;</span>Transaction retrospectively marked REGULAR, Transaction added successfully<span class="nt">&lt;/message&gt;</span>
            <span class="nt">&lt;/item_status&gt;</span>
            <span class="nt">&lt;side_effects&gt;</span>
                <span class="nt">&lt;effect&gt;</span>
                    <span class="nt">&lt;type&gt;</span>points<span class="nt">&lt;/type&gt;</span>
                    <span class="nt">&lt;awarded_points&gt;</span>75<span class="nt">&lt;/awarded_points&gt;</span>
                    <span class="nt">&lt;total_points&gt;</span>75<span class="nt">&lt;/total_points&gt;</span>
                <span class="nt">&lt;/effect&gt;</span>
            <span class="nt">&lt;/side_effects&gt;</span>
            <span class="nt">&lt;old_id&gt;</span>6464658<span class="nt">&lt;/old_id&gt;</span>
            <span class="nt">&lt;old_type&gt;</span>NOT_INTERESTED<span class="nt">&lt;/old_type&gt;</span>
        <span class="nt">&lt;/transaction&gt;</span>
    <span class="nt">&lt;/transactions&gt;</span>
    <span class="nt">&lt;side_effects/&gt;</span>
<span class="nt">&lt;/response&gt;</span>
</code></pre>
<p>In retro transaction, you can convert a not-interested transaction to a regular by tagging the transaction to the respective customer once he/she is registered. 
To avail Retro Transaction, you need to enable <strong>CONF_RETRO_TRANSACTION_ENABLE</strong> on InTouch&gt; <strong>Settings</strong> &gt; <strong>Systems &amp; Deployment</strong> &gt; <strong>InTouch PoS Configuration</strong> &gt; <strong>Billing</strong> page. </p>

<p>On the Billing page, you will also see a configuration to set the maximum duration allowed convert a not-interested transaction regular.</p>

<ul>
<li>CONF_CLIENT_RETRO_DELAY_SINCE_REGISTRATION_HOURS<br></li>
<li>CONF_CLIENT_RETRO_MAX_ALLOWED_AGE_DAYS</li>
</ul>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Entry</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>transaction/update</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Methods</td>
<td>POST</td>
</tr>
<tr>
<td>API Version</td>
<td>v1.1</td>
</tr>
<tr>
<td>Batch Support</td>
<td>Yes</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/transaction/update?format=&lt;xml/json&gt;</code></p>

<h2 id="fetch-transaction-details">Fetch Transaction Details</h2>
<pre class="highlight shell"><code>GET <span class="s2">"http://us.api.capillarytech.com/v1.1/customer/get?format=xml&amp;mobile=44700900099"</span>
</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"transactions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"transaction"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5477576"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MyBill-076"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"REGULAR"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"43445"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900999"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"firstname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Catherine"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"lastname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Earnshaw"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"600"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Transaction retrieved successfully"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1000"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"notes"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2 line items"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"billing_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-04-01 00:00:00"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"gross_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1000"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"custom_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"field name"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[“value”]"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"line_items"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"line_item"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"serial"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"item_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"item-001"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"soap"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"qty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"50"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"rate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"500"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"500"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nt">"attribute"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"color"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"red"</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;response&gt;</span>
   <span class="nt">&lt;transactions&gt;</span>
      <span class="nt">&lt;transaction&gt;</span>
         <span class="nt">&lt;id&gt;</span>5477576<span class="nt">&lt;/id&gt;</span>
         <span class="nt">&lt;number&gt;</span>MyBill-076<span class="nt">&lt;/number&gt;</span>
         <span class="nt">&lt;type&gt;</span>REGULAR<span class="nt">&lt;/type&gt;</span>
         <span class="nt">&lt;customer&gt;</span>
            <span class="nt">&lt;user_id&gt;</span>43445<span class="nt">&lt;/user_id&gt;</span>
            <span class="c">&lt;!--
returned only when query param user_id is true
--&gt;</span>
            <span class="nt">&lt;mobile&gt;</span>44700900999<span class="nt">&lt;/mobile&gt;</span>
            <span class="nt">&lt;email</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;external_id</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;firstname&gt;</span>Catherine<span class="nt">&lt;/firstname&gt;</span>
            <span class="nt">&lt;lastname&gt;</span>Earnshaw<span class="nt">&lt;/lastname&gt;</span>
         <span class="nt">&lt;/customer&gt;</span>
         <span class="nt">&lt;item_status&gt;</span>
            <span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
            <span class="nt">&lt;code&gt;</span>600<span class="nt">&lt;/code&gt;</span>
            <span class="nt">&lt;message&gt;</span>Transaction retrieved successfully<span class="nt">&lt;/message&gt;</span>
         <span class="nt">&lt;/item_status&gt;</span>
         <span class="nt">&lt;amount&gt;</span>1000<span class="nt">&lt;/amount&gt;</span>
         <span class="nt">&lt;notes&gt;</span>2 line items<span class="nt">&lt;/notes&gt;</span>
         <span class="nt">&lt;billing_time&gt;</span>2012-04-01 00:00:00<span class="nt">&lt;/billing_time&gt;</span>
         <span class="nt">&lt;gross_amount&gt;</span>1000<span class="nt">&lt;/gross_amount&gt;</span>
         <span class="nt">&lt;discount&gt;</span>0<span class="nt">&lt;/discount&gt;</span>
         <span class="nt">&lt;store</span> <span class="nt">/&gt;</span>
         <span class="nt">&lt;custom_fields&gt;</span>
            <span class="nt">&lt;field&gt;</span>
               <span class="nt">&lt;name&gt;</span>field name<span class="nt">&lt;/name&gt;</span>
               <span class="nt">&lt;value&gt;</span>[“value”]<span class="nt">&lt;/value&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
         <span class="nt">&lt;/custom_fields&gt;</span>
         <span class="nt">&lt;line_items&gt;</span>
            <span class="nt">&lt;line_item&gt;</span>
               <span class="nt">&lt;serial&gt;</span>1<span class="nt">&lt;/serial&gt;</span>
               <span class="nt">&lt;item_code&gt;</span>item-001<span class="nt">&lt;/item_code&gt;</span>
               <span class="nt">&lt;description&gt;</span>soap<span class="nt">&lt;/description&gt;</span>
               <span class="nt">&lt;qty&gt;</span>50<span class="nt">&lt;/qty&gt;</span>
               <span class="nt">&lt;rate&gt;</span>10<span class="nt">&lt;/rate&gt;</span>
               <span class="nt">&lt;value&gt;</span>500<span class="nt">&lt;/value&gt;</span>
               <span class="nt">&lt;discount&gt;</span>0<span class="nt">&lt;/discount&gt;</span>
               <span class="nt">&lt;amount&gt;</span>500<span class="nt">&lt;/amount&gt;</span>
               <span class="nt">&lt;attributes&gt;</span>
                  <span class="nt">&lt;attribute&gt;</span>
                     <span class="nt">&lt;name&gt;</span>color<span class="nt">&lt;/name&gt;</span>
                     <span class="nt">&lt;value&gt;</span>red<span class="nt">&lt;/value&gt;</span>
                  <span class="nt">&lt;/attribute&gt;</span>
               <span class="nt">&lt;/attributes&gt;</span>
            <span class="nt">&lt;/line_item&gt;</span>
         <span class="nt">&lt;/line_items&gt;</span>
      <span class="nt">&lt;/transaction&gt;</span>
   <span class="nt">&lt;/transactions&gt;</span>
<span class="nt">&lt;/response&gt;</span>
</code></pre>
<p>This API allows you to fetch the details of a specific transaction based on the transaction id.</p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Entry</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>transaction/get</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Methods</td>
<td>GET</td>
</tr>
<tr>
<td>API Version</td>
<td>v1.1</td>
</tr>
<tr>
<td>Batch Support</td>
<td>Yes</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/customer/get?format=&lt;xml/json&gt;&amp;&lt;identifier_type&gt;=&lt;identifier_value&gt;</code></p>

<h2 id="response-codes">Response Codes</h2>

<h3 id="success-codes">Success Codes</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>600</td>
<td>Transaction added successfully</td>
</tr>
<tr>
<td></td>
<td>Transaction retrieved successfully</td>
</tr>
<tr>
<td></td>
<td>Transaction updated successfully</td>
</tr>
</tbody></table>

<h3 id="error-codes">Error Codes</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>601</td>
<td>Transaction failed. Transaction amount/quantity/ rate/discount is invalid.</td>
</tr>
<tr>
<td>602</td>
<td>Transaction number is invalid</td>
</tr>
<tr>
<td>603</td>
<td>Points are already used (Deprecated)</td>
</tr>
<tr>
<td>604</td>
<td>Transaction number already exists</td>
</tr>
<tr>
<td>605</td>
<td>Invalid transaction type. Only regular, return and not-interested transaction types are supported</td>
</tr>
<tr>
<td>606</td>
<td>Customer identifier is not passed. Please enter customer&rsquo;s mobile or email or external id to process.</td>
</tr>
<tr>
<td>607</td>
<td>Transaction id is not passed. Please pass the transaction id to process.</td>
</tr>
<tr>
<td>608</td>
<td>Unable to process the transaction</td>
</tr>
<tr>
<td>609</td>
<td>Update failed. Please verify all the fields.</td>
</tr>
<tr>
<td>610</td>
<td>Unable to register. Please verify all the fields.</td>
</tr>
<tr>
<td>611</td>
<td>Customer not found</td>
</tr>
<tr>
<td>614</td>
<td>Transaction is already cancelled</td>
</tr>
<tr>
<td>615</td>
<td>Transaction details are not passed</td>
</tr>
<tr>
<td>616</td>
<td>Item code already exists</td>
</tr>
<tr>
<td>617</td>
<td>Invalid attribute for the item</td>
</tr>
<tr>
<td>618</td>
<td>Customer is marked as fraud.</td>
</tr>
<tr>
<td>619</td>
<td>Transaction id is not provided</td>
</tr>
<tr>
<td>620</td>
<td>Transaction id is invalid.</td>
</tr>
<tr>
<td>621</td>
<td>Transaction date is invalid. Transaction date should be within the accepted past or future date range limit</td>
</tr>
<tr>
<td>622</td>
<td>Unable to add line-item</td>
</tr>
<tr>
<td>623</td>
<td>Unable to trigger other related events for the transaction</td>
</tr>
<tr>
<td>624</td>
<td>Unable to process return-transaction. You can make a return only after adding a transaction.</td>
</tr>
<tr>
<td>625</td>
<td>Transaction number does not exist</td>
</tr>
<tr>
<td>626</td>
<td>Unable to return transaction. The quantity of returned items are more than purchased items</td>
</tr>
<tr>
<td>627</td>
<td>Quantity cannot be negative</td>
</tr>
<tr>
<td>628</td>
<td>The entire transaction is already returned</td>
</tr>
<tr>
<td>629</td>
<td>The return quantity of the item is more than available quantity</td>
</tr>
<tr>
<td>630</td>
<td>The return amount is more than the transaction/line-item amount</td>
</tr>
<tr>
<td>631</td>
<td>Transaction amount cannot be negative</td>
</tr>
<tr>
<td>632</td>
<td>Cannot return the transaction with return type LINE_ITEM because the type AMOUNT has already been used for returning the same transaction</td>
</tr>
<tr>
<td>633</td>
<td>The entire transaction is already returned</td>
</tr>
<tr>
<td>634</td>
<td>This transaction is already returned</td>
</tr>
<tr>
<td>635</td>
<td>Cannot return the transaction with the return type AMOUNT because the type LINE_ITEM has been used for returning the same transaction</td>
</tr>
<tr>
<td>636</td>
<td>The transaction is already returned with the return type as LINE_ITEM. You can process return for other items only with return type LINE_ITEM</td>
</tr>
<tr>
<td>637</td>
<td>Unable to revert points issued to the customer (for return transaction). Please try again later</td>
</tr>
<tr>
<td>638</td>
<td>Unable to return transaction. The transaction is already returned with type LINE_ITEM. Hence, you cannot use the type AMOUNT for the same transaction</td>
</tr>
<tr>
<td>639</td>
<td>Unable to return full transaction. A part of the transaction or complete transaction is already returned</td>
</tr>
<tr>
<td>640</td>
<td>Points or coupons are not redeemed for this transaction</td>
</tr>
<tr>
<td>641</td>
<td>No customer found</td>
</tr>
<tr>
<td>642</td>
<td>Redemption failed. An error occurred in points/coupon redemption</td>
</tr>
<tr>
<td>643</td>
<td>Transaction is invalid. The transaction date exceeds the accepted future date limit</td>
</tr>
<tr>
<td>644</td>
<td>Transaction is invalid. The transaction date should not be less than the accepted past date limit.</td>
</tr>
<tr>
<td>645</td>
<td>Transaction addition failed for not interested</td>
</tr>
<tr>
<td>646</td>
<td>Customer registration failed. The email id is invalid</td>
</tr>
<tr>
<td>647</td>
<td>Customer registration failed. Email id is already assigned to another customer</td>
</tr>
<tr>
<td>648</td>
<td>Customer registration failed. Mobile number is already assigned to another customer</td>
</tr>
<tr>
<td>649</td>
<td>Customer registration failed. Mobile number is invalid.</td>
</tr>
<tr>
<td>650</td>
<td>Customer registration failed. Mobile number is not accepted as a unique identifier</td>
</tr>
<tr>
<td>651</td>
<td>Customer registration failed. Mobile number is required for registration.</td>
</tr>
<tr>
<td>652</td>
<td>Customer registration failed. Mobile number/email id/external id is invalid.</td>
</tr>
<tr>
<td>653</td>
<td>Customer registration failed. External id is already assigned to another customer</td>
</tr>
<tr>
<td>654</td>
<td>Customer registration failed. External id is not accepted as a unique identifier</td>
</tr>
<tr>
<td>655</td>
<td>Customer registration failed. Customer is not registered in loyalty program</td>
</tr>
<tr>
<td>656</td>
<td>No customer found.</td>
</tr>
<tr>
<td>657</td>
<td>Customer registration failed. Registration in EUP failed.</td>
</tr>
<tr>
<td>658</td>
<td>Customer registration failed. Only email id is not sufficient for registration</td>
</tr>
<tr>
<td>659</td>
<td>Customer registration failed. Please enter email id to register</td>
</tr>
<tr>
<td>660</td>
<td>Customer registration failed. Registration date exceeds the accepted past or future date limit.</td>
</tr>
<tr>
<td>661</td>
<td>Amount of the line-item amount cannot be negative</td>
</tr>
<tr>
<td>662</td>
<td>Value of a line cannot be negative</td>
</tr>
<tr>
<td>663</td>
<td>Rate of a line-item cannot be negative</td>
</tr>
<tr>
<td>664</td>
<td>Discount of a line-item cannot be negative</td>
</tr>
<tr>
<td>665</td>
<td>Gross amount of the transaction cannot be negative</td>
</tr>
<tr>
<td>666</td>
<td>Discount of the transaction cannot be negative</td>
</tr>
<tr>
<td>667</td>
<td>Unable to find the transaction id for this customer</td>
</tr>
<tr>
<td>668</td>
<td>Unable to find the transaction number for this customer</td>
</tr>
<tr>
<td>669</td>
<td>Unable to update custom field</td>
</tr>
<tr>
<td>670</td>
<td>Transaction id/number is not provided</td>
</tr>
<tr>
<td>671</td>
<td>Invalid Store TILL code</td>
</tr>
<tr>
<td>672</td>
<td>Batch limit exceeded.</td>
</tr>
<tr>
<td>673</td>
<td>Returning of transactions is not allowed</td>
</tr>
<tr>
<td>674</td>
<td>Returning of line item is not allowed</td>
</tr>
<tr>
<td>675</td>
<td>Returning of transaction amount is not allowed</td>
</tr>
<tr>
<td>676</td>
<td>Returning of a complete transaction amount is not allowed</td>
</tr>
<tr>
<td>677</td>
<td>Unable to process. Please enter a transaction number for returning a transaction</td>
</tr>
<tr>
<td>678</td>
<td>Amount of returned item is more than purchased item</td>
</tr>
<tr>
<td>679</td>
<td>Line-item(s) to be returned is not specified</td>
</tr>
<tr>
<td>680</td>
<td>No transactions of the specific customer were found</td>
</tr>
<tr>
<td>681</td>
<td>Transactions are blocked for this customer</td>
</tr>
<tr>
<td>686</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>687</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>688</td>
<td>The configuration is invalid. Please report to the Capillary Support</td>
</tr>
<tr>
<td>689</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>690</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>691</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>692</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>693</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>694</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>695</td>
<td>Invalid configuration. Please report to the Capillary Support.</td>
</tr>
<tr>
<td>696</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>697</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>698</td>
<td>Points processing failed</td>
</tr>
<tr>
<td>699</td>
<td>Invalid configuration. Please report to the Capillary Support</td>
</tr>
<tr>
<td>1623</td>
<td>Transaction type is invalid</td>
</tr>
<tr>
<td>1624</td>
<td>Provided parameters are not sufficient to fetch transaction</td>
</tr>
<tr>
<td>1625</td>
<td>Target type is not specified</td>
</tr>
<tr>
<td>1626</td>
<td>The requested transaction type cannot be changed</td>
</tr>
<tr>
<td>1627</td>
<td>The transaction is already marked as retro</td>
</tr>
<tr>
<td>1628</td>
<td>Transaction id is invalid</td>
</tr>
<tr>
<td>1629</td>
<td>Client signature is required to perform this action</td>
</tr>
<tr>
<td>1631</td>
<td>Retro transaction is not enabled for your organization</td>
</tr>
<tr>
<td>1632</td>
<td>Registration date is too older than the transaction date. See the retro configuration set for your organization</td>
</tr>
<tr>
<td>1633</td>
<td>The duration between registration and transaction mapping exceeds the limit set</td>
</tr>
<tr>
<td>1634</td>
<td>Return type is invalid</td>
</tr>
<tr>
<td>1635</td>
<td>Please pass line-items that need to be returned</td>
</tr>
<tr>
<td>1636</td>
<td>Transaction status is invalid</td>
</tr>
</tbody></table>

          <h1 id="points">Points</h1>

<p>Points represent loyalty points of an organization that are issued to the loyalty customers based on the transactions made and tiers achieved. Customers can redeem the loyalty points earned by them against transactions. Points are issued only through the Loyalty Manager upon a transaction or tier upgrade but not through API calls.</p>

<p>The points entity allows you to perform the following tasks:</p>

<ul>
<li>Check whether a specific number of points can be redeemed by a customer<br></li>
<li>Validate customer’s mobile number by issuing validation code to redeem points </li>
<li>Redeem loyalty points of a customer after validating the preceding tasks</li>
</ul>

<h2 id="check-if-points-are-redeemable">Check If Points are Redeemable</h2>
<pre class="highlight html"><code># Sample Request
http://us.intouch.capillarytech.com/v1.1/points/isredeemable?format=xml<span class="err">&amp;</span>points=100<span class="err">&amp;</span>validation_code=6D18DU<span class="err">&amp;</span>mobile=919591228668
</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"responses"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"points"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900999"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"points_redeemed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"redeemed_value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"257"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"800"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Points Redeemed"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="nt">"points"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"redeemable"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900999"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"is_redeemable"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"points_currency_ratio"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"800"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Points can be redeemed"</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;response&gt;</span>  
<span class="nt">&lt;status&gt;</span>    
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>    
<span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>    
<span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>  
<span class="nt">&lt;/status&gt;</span>  
<span class="nt">&lt;responses&gt;</span>    
<span class="nt">&lt;points&gt;</span>      
<span class="nt">&lt;mobile&gt;</span>44700900999<span class="nt">&lt;/mobile&gt;</span>
<span class="nt">&lt;email&gt;&lt;/email&gt;</span>
<span class="nt">&lt;external_id&gt;&lt;/external_id&gt;</span>
<span class="nt">&lt;points_redeemed&gt;</span>100<span class="nt">&lt;/points_redeemed&gt;</span>      
<span class="nt">&lt;redeemed_value&gt;</span>100<span class="nt">&lt;/redeemed_value&gt;</span>
<span class="nt">&lt;balance&gt;</span>257<span class="nt">&lt;/balance&gt;</span>
<span class="nt">&lt;item_status&gt;</span>        
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>        
<span class="nt">&lt;code&gt;</span>800<span class="nt">&lt;/code&gt;</span>        
<span class="nt">&lt;message&gt;</span>Points Redeemed<span class="nt">&lt;/message&gt;</span>      
<span class="nt">&lt;/item_status&gt;</span>    <span class="nt">&lt;response&gt;</span>  
<span class="nt">&lt;status&gt;</span>    
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>    
<span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>    
<span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>  
<span class="nt">&lt;/status&gt;</span>  
<span class="nt">&lt;points&gt;</span>    
<span class="nt">&lt;redeemable&gt;</span>      
<span class="nt">&lt;mobile&gt;</span>44700900999<span class="nt">&lt;/mobile&gt;</span>      
<span class="nt">&lt;points&gt;</span>100<span class="nt">&lt;/points&gt;</span>
<span class="nt">&lt;is_redeemable&gt;</span>true<span class="nt">&lt;/is_redeemable&gt;</span> 
<span class="nt">&lt;points_currency_ratio&gt;</span>0<span class="nt">&lt;/points_currency_ratio&gt;</span>
<span class="nt">&lt;item_status&gt;</span>        
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>        
<span class="nt">&lt;code&gt;</span>800<span class="nt">&lt;/code&gt;</span>        
<span class="nt">&lt;message&gt;</span>Points can be redeemed<span class="nt">&lt;/message&gt;</span>      
<span class="nt">&lt;/item_status&gt;</span>    
<span class="nt">&lt;/redeemable&gt;</span>  
<span class="nt">&lt;/points&gt;</span>
<span class="nt">&lt;/response&gt;</span>
<span class="nt">&lt;/points&gt;</span>  
<span class="nt">&lt;/responses&gt;</span>
<span class="nt">&lt;/response&gt;</span>
</code></pre>
<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Entry</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>points/isredeemable</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Method</td>
<td>GET</td>
</tr>
<tr>
<td>API Version</td>
<td>v1.1</td>
</tr>
<tr>
<td>Batch Support</td>
<td>No</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/points/isredeemable?format=&lt;xml/json&gt;&amp;points=&lt;points to redeem&gt;&amp;validation_code=&lt;OTP&gt;&amp;mobile=&lt;mobile no.&gt;</code></p>

<h3 id="request-parameters">Request Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>mobile*</td>
<td>Provide the registered mobile number of the customer to issue validation code - mobile,email, external_id, user_id</td>
</tr>
<tr>
<td>points*</td>
<td>Number of points to redeem</td>
</tr>
<tr>
<td>validation_code*</td>
<td>OTP issued to the customer&rsquo;s mobile number</td>
</tr>
</tbody></table>

<h2 id="issue-validation-code-for-redeeming-points">Issue Validation Code for Redeeming Points</h2>
<pre class="highlight html"><code>http://us.intouch.capillarytech.com/v1.1/points/validationcode?format=xml<span class="err">&amp;</span>mobile=447700900000<span class="err">&amp;</span>points=50
</code></pre><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Operation Successful"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"validation_code"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55456"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900999"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"50"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"
Validation Code Issued by SMS/Email
"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;response&gt;</span>  
<span class="nt">&lt;status&gt;</span>    
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>    
<span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>    
<span class="nt">&lt;message&gt;</span>Operation Successful<span class="nt">&lt;/message&gt;</span>  
<span class="nt">&lt;/status&gt;</span>  
<span class="nt">&lt;validation_code&gt;</span>    
<span class="nt">&lt;code&gt;</span>      
<span class="nt">&lt;user_id&gt;</span>55456<span class="nt">&lt;/user_id&gt;</span>
<span class="nt">&lt;mobile&gt;</span>44700900999<span class="nt">&lt;/mobile&gt;</span>      
<span class="nt">&lt;points&gt;</span>50<span class="nt">&lt;/points&gt;</span>   
<span class="nt">&lt;item_status&gt;</span>        
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>        
<span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>        
<span class="nt">&lt;message&gt;</span>
Validation Code Issued by SMS/Email
<span class="nt">&lt;/message&gt;</span>      
<span class="nt">&lt;/item_status&gt;</span>    
<span class="nt">&lt;/code&gt;</span>  
<span class="nt">&lt;/validation_code&gt;</span>
<span class="nt">&lt;/response&gt;</span>
</code></pre>
<p>Mobile number validation is required for redeeming points of a customer. You can validate the mobile number through OTP. This API allows you to issue validation code for redeeming points. </p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Entry</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>points/validationcode</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Method</td>
<td>GET</td>
</tr>
<tr>
<td>API Version</td>
<td>v1.1</td>
</tr>
<tr>
<td>Batch Support</td>
<td>No</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/points/validationcode?format=&lt;xml/json&gt;&amp;&lt;query_param&gt;=&lt;value&gt;&amp;points=&lt;points_to_be_redeemed&gt;</code></p>

<h3 id="request-parameters">Request Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>mobile*</td>
<td>Provide the registered mobile number of the customer to issue validation code - mobile,email, external_id, user_id</td>
</tr>
<tr>
<td>points*</td>
<td>Number of points to redeem</td>
</tr>
<tr>
<td>email</td>
<td>Provide the email id of the customer if mobile number is not available</td>
</tr>
</tbody></table>

<h2 id="redeem-points">Redeem Points</h2>
<pre class="highlight html"><code># Sample Request
http://us.intouch.capillarytech.com/v1.1/points/redeem?format=json
</code></pre><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"root"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"redeem"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"points_redeemed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"transaction_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234r743"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900999"</span><span class="w"> </span><span class="p">},</span><span class="w">
      </span><span class="nt">"notes"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sample notes"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"validation_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6D18DU"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"redemption_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2011-11-21 11:30:11"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;root&gt;</span>
<span class="nt">&lt;redeem&gt;</span>
<span class="nt">&lt;points_redeemed&gt;</span>100<span class="nt">&lt;/points_redeemed&gt;</span>
<span class="nt">&lt;transaction_number&gt;</span>1234r743<span class="nt">&lt;/transaction_number&gt;</span>
<span class="nt">&lt;customer&gt;</span>
<span class="nt">&lt;mobile&gt;</span>44700900999<span class="nt">&lt;/mobile&gt;</span>
<span class="nt">&lt;email&gt;&lt;/email&gt;</span>
<span class="nt">&lt;external_id&gt;&lt;/external_id&gt;</span>
<span class="nt">&lt;/customer&gt;</span>
<span class="nt">&lt;notes&gt;</span>Sample notes<span class="nt">&lt;/notes&gt;</span>
<span class="nt">&lt;validation_code&gt;</span>6D18DU<span class="nt">&lt;/validation_code&gt;</span>
<span class="nt">&lt;redemption_time&gt;</span>2011-11-21 11:30:11<span class="nt">&lt;/redemption_time&gt;</span>
<span class="nt">&lt;/redeem&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"responses"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"points"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"44700900999"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"points_redeemed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"redeemed_value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"257"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"800"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Points Redeemed"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;response&gt;</span>  
<span class="nt">&lt;status&gt;</span>    
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>    
<span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>    
<span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>  
<span class="nt">&lt;/status&gt;</span>  
<span class="nt">&lt;responses&gt;</span>    
<span class="nt">&lt;points&gt;</span>      
<span class="nt">&lt;mobile&gt;</span>44700900999<span class="nt">&lt;/mobile&gt;</span>
<span class="nt">&lt;email&gt;&lt;/email&gt;</span>
<span class="nt">&lt;external_id&gt;&lt;/external_id&gt;</span>
<span class="nt">&lt;points_redeemed&gt;</span>100<span class="nt">&lt;/points_redeemed&gt;</span>      
<span class="nt">&lt;redeemed_value&gt;</span>100<span class="nt">&lt;/redeemed_value&gt;</span>
<span class="nt">&lt;balance&gt;</span>257<span class="nt">&lt;/balance&gt;</span>
<span class="nt">&lt;item_status&gt;</span>        
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>        
<span class="nt">&lt;code&gt;</span>800<span class="nt">&lt;/code&gt;</span>        
<span class="nt">&lt;message&gt;</span>Points Redeemed<span class="nt">&lt;/message&gt;</span>      
<span class="nt">&lt;/item_status&gt;</span>    
<span class="nt">&lt;/points&gt;</span>  
<span class="nt">&lt;/responses&gt;</span>
<span class="nt">&lt;/response&gt;</span>
</code></pre>
<p>This API alllows you to process points redemption once the OTP issued to the customer is validated.</p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Entry</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>points/redeem</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Method</td>
<td>POST</td>
</tr>
<tr>
<td>API Version</td>
<td>v1.1</td>
</tr>
<tr>
<td>Batch Support</td>
<td>No</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/points/redeem?format=&lt;xml/json&gt;</code></p>

<h3 id="request-parameters">Request Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>mobile*</td>
<td>Provide the registered mobile number of the customer to redeem points</td>
</tr>
<tr>
<td>points_redeemed*</td>
<td>Provide the number of points to be redeemed</td>
</tr>
<tr>
<td>transaction_number</td>
<td>Provide the transaction number against which the points has to be redeemed</td>
</tr>
<tr>
<td>validation_code</td>
<td>Provide the OTP generated to the customer&rsquo;s mobile number through the previous call</td>
</tr>
<tr>
<td>redemption_time</td>
<td>Provide the redemption date and time in YYYY-MM-DD HH-MM-SS format</td>
</tr>
</tbody></table>

<h2 id="response-codes">Response Codes</h2>

<h3 id="success-codes">Success Codes</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>800</td>
<td>Points redeemed successfully</td>
</tr>
</tbody></table>

<h3 id="error-codes">Error Codes</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>801</td>
<td>Points you are trying to redeem are invalid</td>
</tr>
<tr>
<td>802</td>
<td>Mobile number/email id/external id you have entered is invalid</td>
</tr>
<tr>
<td>803</td>
<td>Unable to redeem. The points you are trying to redeem is more than the available points</td>
</tr>
<tr>
<td>804</td>
<td>Insufficient current points.</td>
</tr>
<tr>
<td>805</td>
<td>Insufficient lifetime points.</td>
</tr>
<tr>
<td>806</td>
<td>Insufficient lifetime purchases amount.</td>
</tr>
<tr>
<td>807</td>
<td>Unable to redeem. Make sure that the points you are trying to redeem is a multiple of <X>. Check the points redemption configuration of your organization.</td>
</tr>
<tr>
<td>808</td>
<td>Unable to redeem. Validation code is invalid</td>
</tr>
<tr>
<td>809</td>
<td>Unable to process. Customer is marked as fraud</td>
</tr>
<tr>
<td>810</td>
<td>Mismatch in points for revert API call</td>
</tr>
<tr>
<td>811</td>
<td>The transaction number entered to redeem/revert points is invalid</td>
</tr>
<tr>
<td>812</td>
<td>The points have been reverted already for this transaction number</td>
</tr>
<tr>
<td>813</td>
<td>Insufficient current points available for redemption</td>
</tr>
<tr>
<td>814</td>
<td>No points were redeemed on this transaction number</td>
</tr>
<tr>
<td>815</td>
<td>Unable to process points at this moment. Please try again later</td>
</tr>
<tr>
<td>816</td>
<td>Unable to find customer in this organization</td>
</tr>
<tr>
<td>817</td>
<td>Points redemption failed</td>
</tr>
<tr>
<td>818</td>
<td>Points you are trying to redeem are more than the available points</td>
</tr>
</tbody></table>

<p>819 | Points you are trying to redeem are more than the maximum allowed redemption limit
 | Unable to send message to customer
820 | Unable to process. Customer is marked as fraud
821 | Points you are trying to redeem are less than the minimum redemption limit | 
822 | Unable to find missed call from the registered mobile number
823 | Missed call redemption is disabled for your organization
824 | Mobile number validation is mandatory for redeeming points
825 | Client signature is required
826 | Invalid points category or invalid configuration
827 | Unable to redeem points. Points redemption is enabled for your organization
828 | Unable to redeem points at this moment. Please try again later
829 | Unable to redeem points at this moment. Please try again later
850 | Unable to redeem points at this moment. Please try again later
859 | The redemption time you have passed is invalid
860 | Unable to issue OTP
881 | Customer is not registered into the loyalty program
886 | Unable to process points at this moment. Please try again later
887 | Unable to process points at this moment. Please try again later
888 | Configuration is invalid. Please report to Capillary Support
889 | Unable to process points at this moment. Please try again later
890 | Unable to process points at this moment. Please try again later
891 | Unable to process points at this moment. Please try again later<br>
892 | Unable to process points at this moment. Please try again later
893 | Unable to process points at this moment. Please try again later
894 | Unable to process points at this moment. Please try again later
895 | Loyalty program is not configured for your organization
896 | Unable to process points at this moment. Please try again later
897 | Unable to process points at this moment. Please try again later
898 | Unable to process points at this moment. Please try again later
899 | Configuration is invalid. Please report to Capillary Support</p>

          <h1 id="coupon">Coupon</h1>

<p>Coupon represents store promotions or discounts created through Capillary Campaign Manager. A single campaign could contain one or more coupons or coupon series. Coupons are issued to loyalty or non-loyalty customers through SMS or email.</p>

<p>You cannot create new coupons using coupon APIs. You can just send or retrieve coupons that are already created in your campaigns. Hence, it is important to note the coupon code, coupon id or coupon series id for making API calls.</p>

<p>You cannot create new coupons using coupon APIs; instead, you can send or retrieve coupons that are already created in your campaigns. Hence, it is important to note the coupon code, coupon id or coupon series id to use coupon APIs.</p>

<p>The coupon entity allows you to perform the following tasks:</p>

<ul>
<li>Issue coupons to customers </li>
<li>Resend a specific coupon to the respective customer </li>
<li>Retrieve details of a specific coupon/coupon series </li>
<li>Check whether a customer can redeem a specific coupon and redeem the coupon</li>
</ul>

<h2 id="reissue-coupon">Reissue Coupon</h2>
<pre class="highlight html"><code># Sample Request
http://us.intouch.capillarytech.com/v1.1/coupon/resend?format=xml<span class="err">&amp;</span>id=13596576
</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"coupons"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"coupon"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"13596576"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4R5A33"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"700"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Coupon Resent"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;response&gt;</span>  
<span class="nt">&lt;status&gt;</span>    
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>    
<span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>    
<span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>  
<span class="nt">&lt;/status&gt;</span>  
<span class="nt">&lt;coupons&gt;</span>    
<span class="nt">&lt;coupon&gt;</span>      
<span class="nt">&lt;id&gt;</span>13596576<span class="nt">&lt;/id&gt;</span>
<span class="nt">&lt;code&gt;</span>4R5A33<span class="nt">&lt;/code&gt;</span>
<span class="c">&lt;!-- id and code will be returned depending
on the request param --&gt;</span>   
<span class="nt">&lt;item_status&gt;</span>        
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>        
<span class="nt">&lt;code&gt;</span>700<span class="nt">&lt;/code&gt;</span>        
<span class="nt">&lt;message&gt;</span>Coupon Resent<span class="nt">&lt;/message&gt;</span>      
<span class="nt">&lt;/item_status&gt;</span>    
<span class="nt">&lt;/coupon&gt;</span>  
<span class="nt">&lt;/coupons&gt;</span>
<span class="nt">&lt;/response&gt;</span>

</code></pre>
<p>This API allows you to issue a coupon again to the respective loyalty customer. You can use this API if any of the coupons issued to the customer is missing.</p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Entry</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>coupon/resend</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Method</td>
<td>GET</td>
</tr>
<tr>
<td>API Version</td>
<td>v1.1</td>
</tr>
<tr>
<td>Batch Support</td>
<td>No</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/value&gt;&amp;format=v1.1/coupon/resend?&lt;identifier&gt;=&lt;xml/json&gt;&amp;&lt;input_params&gt;</code></p>

<h3 id="request-parameters">Request Parameters</h3>

<p>Any one among the folloing parameters is mandatory.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Coupon id that you want to issue to the customer</td>
</tr>
<tr>
<td>code</td>
<td>Coupon code that you want to issue to the customer</td>
</tr>
</tbody></table>

<aside class="warning"> You can pass either coupon id or code. Any one parameter is required</aside>

<h2 id="redeem-coupons">Redeem Coupons</h2>
<pre class="highlight html"><code># Sample Request
http://api.capillary.co.in/v1.1/coupon/redeem?format=json
</code></pre>
<blockquote>
<p>Sample POST Request</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"root"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"coupon"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"06000041"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"validation_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"XYZ123"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"447700900000"</span><span class="w"> </span><span class="p">},</span><span class="w">
      </span><span class="nt">"custom_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sport"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[“Soccer”]"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"transaction"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bill-110"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1000"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;root&gt;</span>
<span class="nt">&lt;coupon&gt;</span>
<span class="nt">&lt;code&gt;</span>06000041<span class="nt">&lt;/code&gt;</span>
<span class="c">&lt;!-- validation_code needed only if the brand is using validation code based redemption, can be left out --&gt;</span>
<span class="nt">&lt;validation_code&gt;</span>XYZ123<span class="nt">&lt;/validation_code&gt;</span>
<span class="nt">&lt;customer&gt;</span>
<span class="nt">&lt;mobile&gt;</span>447700900000<span class="nt">&lt;/mobile&gt;</span>
<span class="nt">&lt;email&gt;&lt;/email&gt;</span>
<span class="nt">&lt;external_id&gt;&lt;/external_id&gt;</span>
<span class="nt">&lt;/customer&gt;</span>
<span class="nt">&lt;custom_fields&gt;</span>
<span class="c">&lt;!-- Optional, as Specified by the Brand --&gt;</span>
<span class="nt">&lt;field&gt;</span>
    <span class="nt">&lt;name&gt;</span>Sport<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>[“Soccer”]<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/custom_fields&gt;</span>
<span class="nt">&lt;redemption_time&gt;&lt;/redemption_time&gt;</span>
<span class="nt">&lt;transaction&gt;</span>
<span class="nt">&lt;number&gt;</span>bill-110<span class="nt">&lt;/number&gt;</span>
<span class="nt">&lt;amount&gt;</span>1000<span class="nt">&lt;/amount&gt;</span>
<span class="nt">&lt;/transaction&gt;</span>
<span class="nt">&lt;/coupon&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"coupons"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"coupon"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"06000041"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"447700900000"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55434"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"transaction"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bill-110"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1000"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"series_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"227f0"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"is_absolute"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"coupon_value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"#text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"        
t"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;response&gt;</span>  
<span class="nt">&lt;status&gt;</span>    
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>    
<span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>    
<span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>  
<span class="nt">&lt;/status&gt;</span>  
<span class="nt">&lt;coupons&gt;</span>    
<span class="nt">&lt;coupon&gt;</span>      
<span class="nt">&lt;code&gt;</span>06000041<span class="nt">&lt;/code&gt;</span>      
<span class="nt">&lt;customer&gt;</span>        
<span class="nt">&lt;mobile&gt;</span>447700900000<span class="nt">&lt;/mobile&gt;</span>      
<span class="nt">&lt;email&gt;&lt;/email&gt;</span>
<span class="nt">&lt;external_id&gt;&lt;/external_id&gt;</span>
<span class="nt">&lt;user_id&gt;</span>55434<span class="nt">&lt;/user_id&gt;</span> 
<span class="c">&lt;!-- Will be returned only if user_id is true --&gt;</span>
<span class="nt">&lt;/customer&gt;</span>      
<span class="nt">&lt;transaction&gt;</span>        
<span class="nt">&lt;number&gt;</span>bill-110<span class="nt">&lt;/number&gt;</span>
<span class="nt">&lt;amount&gt;</span>1000<span class="nt">&lt;/amount&gt;</span>        
<span class="nt">&lt;/transaction&gt;</span>      
<span class="nt">&lt;discount_code&gt;&lt;/discount_code&gt;</span>      
<span class="nt">&lt;series_code&gt;</span>227f0<span class="nt">&lt;/series_code&gt;</span>      
<span class="nt">&lt;is_absolute&gt;</span>true<span class="nt">&lt;/is_absolute&gt;</span>      
<span class="nt">&lt;coupon_value&gt;</span>0<span class="nt">&lt;/coupon_value&gt;</span>      
<span class="nt">&lt;item_status&gt;</span>        
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>        
t<span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>        
<span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>      
<span class="nt">&lt;/item_status&gt;</span>    
<span class="nt">&lt;/coupon&gt;</span>  
<span class="nt">&lt;/coupons&gt;</span>
<span class="nt">&lt;/response&gt;</span>
</code></pre>
<p>This API allows you to redeem coupons issued to the loyalty customer.</p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Entry</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>coupon/resend</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Method</td>
<td>POST</td>
</tr>
<tr>
<td>API Version</td>
<td>v1.1</td>
</tr>
<tr>
<td>Batch Support</td>
<td>No</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://api.capillary.co.in/v1.1/coupon/redeem?format=xml</code></p>

<h3 id="request-parameters">Request Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Customer identifier*</td>
<td>Unique identifier of the customer whose coupon needs to be redeemed</td>
</tr>
<tr>
<td>id</td>
<td>Coupon id that needs to be redeemed</td>
</tr>
<tr>
<td>code</td>
<td>Coupon code that need to be redeemed</td>
</tr>
<tr>
<td>validation_code</td>
<td>Valodation code is required for the orgs that require validation based redemption</td>
</tr>
<tr>
<td>number</td>
<td>Transaction number against which the coupon needs to be redeemed</td>
</tr>
<tr>
<td>amount</td>
<td>Transaction amount against which the coupon is redeemed</td>
</tr>
</tbody></table>

<aside class="warning"> You need to pass either code or id as applicable </aside>

<h2 id="get-coupon-details">Get Coupon Details</h2>
<pre class="highlight html"><code>http://api.capillary.co.in/v1.1/coupon/get?code=06000041<span class="err">&amp;</span>format=xml
</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"coupons"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"coupon"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"06000041"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"13596576"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"valid_till"</span><span class="p">:</span><span class="w"> </span><span class="s2">"31-08-2016"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"issued_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-08-01 15:31:44"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"553232"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Suresh Venkitakrishnan"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"919591525725"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sv@mail.com"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"pincode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"224"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"issued_store"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"store.code"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"store name"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"series_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"24325"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"is_absolute"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"redemption_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"redeemed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"redeemed_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-08-01 15:56:07"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"redeemed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"till.fitnesse"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"redeemed_by"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"firstname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TOM"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"lastname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sawyer"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tom@email.com"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"919999999999"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"store"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"code.store"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name.store"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"transaction"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BILL-20304"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2242536"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"700"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Coupon processing successful"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;response&gt;</span>  
<span class="nt">&lt;status&gt;</span>    
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>    
<span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>    
<span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>  
<span class="nt">&lt;/status&gt;</span>  
<span class="nt">&lt;coupons&gt;</span>    
<span class="nt">&lt;coupon&gt;</span>      
<span class="nt">&lt;code&gt;</span>06000041<span class="nt">&lt;/code&gt;</span>      
<span class="nt">&lt;id&gt;</span>13596576<span class="nt">&lt;/id&gt;</span>      
<span class="nt">&lt;valid_till&gt;</span>31-08-2016<span class="nt">&lt;/valid_till&gt;</span>      
<span class="nt">&lt;issued_on&gt;</span>2016-08-01 15:31:44<span class="nt">&lt;/issued_on&gt;</span>      
<span class="nt">&lt;customer&gt;</span>
    <span class="nt">&lt;user_id&gt;</span>553232<span class="nt">&lt;/user_id&gt;</span>
<span class="c">&lt;!-- user_id tag will be returned only if query param user_id = true --&gt;</span>
<span class="nt">&lt;name&gt;</span>Suresh Venkitakrishnan<span class="nt">&lt;/name&gt;</span>        
<span class="nt">&lt;mobile&gt;</span>919591525725<span class="nt">&lt;/mobile&gt;</span>        
<span class="nt">&lt;email&gt;</span>sv@mail.com<span class="nt">&lt;/email&gt;</span>      
<span class="nt">&lt;/customer&gt;</span>      
<span class="nt">&lt;pincode&gt;</span>224<span class="nt">&lt;/pincode&gt;</span>
<span class="nt">&lt;issued_store&gt;</span>
    <span class="nt">&lt;code&gt;</span>store.code<span class="nt">&lt;/code&gt;</span>
    <span class="nt">&lt;name&gt;</span>store name<span class="nt">&lt;/name&gt;</span>
<span class="nt">&lt;/issued_store&gt;</span>
<span class="nt">&lt;series_id&gt;</span>24325<span class="nt">&lt;/series_id&gt;</span>
<span class="nt">&lt;is_absolute&gt;</span>true<span class="nt">&lt;/is_absolute&gt;</span>      
<span class="nt">&lt;value&gt;</span>0<span class="nt">&lt;/value&gt;</span>      
<span class="nt">&lt;redemption_info&gt;</span>        
<span class="nt">&lt;redeemed&gt;</span>true<span class="nt">&lt;/redeemed&gt;</span>        
<span class="nt">&lt;redeemed_on&gt;</span>2016-08-01 15:56:07<span class="nt">&lt;/redeemed_on&gt;</span>        
<span class="nt">&lt;redeemed_at&gt;</span>till.fitnesse<span class="nt">&lt;/redeemed_at&gt;</span>      
<span class="nt">&lt;/redemption_info&gt;</span>      
<span class="nt">&lt;redeemed_by&gt;</span>
    <span class="nt">&lt;firstname&gt;</span>TOM<span class="nt">&lt;/firstname&gt;</span>
    <span class="nt">&lt;lastname&gt;</span>Sawyer<span class="nt">&lt;/lastname&gt;</span>
    <span class="nt">&lt;email&gt;</span>tom@email.com<span class="nt">&lt;/email&gt;</span>
    <span class="nt">&lt;mobile&gt;</span>919999999999<span class="nt">&lt;/mobile&gt;</span>
<span class="nt">&lt;/redeemed_by&gt;</span>
<span class="nt">&lt;store&gt;</span>
    <span class="nt">&lt;code&gt;</span>code.store<span class="nt">&lt;/code&gt;</span>
    <span class="nt">&lt;name&gt;</span>name.store<span class="nt">&lt;/name&gt;</span>
<span class="nt">&lt;/store&gt;</span>
<span class="nt">&lt;transaction&gt;</span>
    <span class="nt">&lt;number&gt;</span>BILL-20304<span class="nt">&lt;/number&gt;</span>
    <span class="nt">&lt;id&gt;</span>2242536<span class="nt">&lt;/id&gt;</span>
<span class="nt">&lt;/transaction&gt;</span>
<span class="nt">&lt;item_status&gt;</span>        
<span class="nt">&lt;status&gt;</span>true<span class="nt">&lt;/status&gt;</span>        
<span class="nt">&lt;code&gt;</span>700<span class="nt">&lt;/code&gt;</span>        
<span class="nt">&lt;message&gt;</span>Coupon processing successful<span class="nt">&lt;/message&gt;</span>      
<span class="nt">&lt;/item_status&gt;</span>    
<span class="nt">&lt;/coupon&gt;</span>  
<span class="nt">&lt;/coupons&gt;</span>
<span class="nt">&lt;/response&gt;</span>
</code></pre>
<p>This API allows you to retrieve details of a specific coupon.</p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Entry</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>coupon/get</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Method</td>
<td>GET</td>
</tr>
<tr>
<td>API Version</td>
<td>v1.1</td>
</tr>
<tr>
<td>Batch Support</td>
<td>Yes</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/coupon/get?&lt;id/code&gt;=&lt;value&gt;&amp;format=&lt;xml/json&gt;</code></p>

<h3 id="request-parameters">Request Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Pass the coupon id that you want to retrieve. To retrieve details of multiple coupons, pass each id separating with , (comma)</td>
</tr>
<tr>
<td>code</td>
<td>Pass the coupon id that you want to retrieve. To retrieve details of multiple coupons, pass each code separating with , (comma)</td>
</tr>
</tbody></table>

<h2 id="check-if-coupon-is-reedemable">Check if Coupon is Reedemable</h2>
<pre class="highlight html"><code># Sample Request
http://us.intouch.capillarytech.com/v1.1/coupon/isredeemable?format=xml<span class="err">&amp;</span>details=true<span class="err">&amp;</span>code=06000041<span class="err">&amp;</span>mobile=447700900000
</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"coupons"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"redeemable"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"447700900000"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"06000041"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"is_redeemable"</span><span class="p">:</span><span class="w"> </span><span class="s2">"false"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"706"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"
Cannot redeem same voucher multiple times
"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"series_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sample description"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"discount_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"XYZ123"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"valid_till"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-31"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"discount_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ABS"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"discount_value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"detailed_info"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sample details"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;response&gt;</span>  
<span class="nt">&lt;status&gt;</span>    
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>    
<span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>    
<span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>  
<span class="nt">&lt;/status&gt;</span>  
<span class="nt">&lt;coupons&gt;</span>    
<span class="nt">&lt;redeemable&gt;</span>      
<span class="nt">&lt;mobile&gt;</span>447700900000<span class="nt">&lt;/mobile&gt;</span>      
<span class="nt">&lt;code&gt;</span>06000041<span class="nt">&lt;/code&gt;</span>      
<span class="nt">&lt;is_redeemable&gt;</span>false<span class="nt">&lt;/is_redeemable&gt;</span>      
<span class="nt">&lt;item_status&gt;</span>        
<span class="nt">&lt;status&gt;</span>true<span class="nt">&lt;/status&gt;</span>        
<span class="nt">&lt;code&gt;</span>706<span class="nt">&lt;/code&gt;</span>        
<span class="nt">&lt;message&gt;</span>
Cannot redeem same voucher multiple times
<span class="nt">&lt;/message&gt;</span>      
<span class="nt">&lt;/item_status&gt;</span>      
<span class="nt">&lt;series_info&gt;</span>    

<span class="nt">&lt;description&gt;</span>Sample description<span class="nt">&lt;/description&gt;</span>        
<span class="nt">&lt;discount_code&gt;</span>XYZ123<span class="nt">&lt;/discount_code&gt;</span>        
<span class="nt">&lt;valid_till&gt;</span>2016-12-31<span class="nt">&lt;/valid_till&gt;</span>        
<span class="nt">&lt;discount_type&gt;</span>ABS<span class="nt">&lt;/discount_type&gt;</span>        
<span class="nt">&lt;discount_value&gt;</span>0<span class="nt">&lt;/discount_value&gt;</span>        
<span class="nt">&lt;discount_on&gt;&lt;/discount_on&gt;</span>        
<span class="nt">&lt;detailed_info&gt;</span>sample details<span class="nt">&lt;/detailed_info&gt;</span>      
<span class="nt">&lt;/series_info&gt;</span>    
<span class="nt">&lt;/redeemable&gt;</span>  
<span class="nt">&lt;/coupons&gt;</span>
<span class="nt">&lt;/response&gt;</span>
</code></pre>
<p>This API allows you to verify whether a coupon is redeemable by a specific customer.</p>

<table><thead>
<tr>
<th>Entry</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>coupon/isredeemable</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Method</td>
<td>GET</td>
</tr>
<tr>
<td>API Version</td>
<td>v1.1</td>
</tr>
<tr>
<td>Batch Support</td>
<td>No</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/coupon/isredeemable?format=&lt;xml/json&gt;&amp;mobile=&lt;value&gt;&amp;code=&lt;coupon_code&gt;&amp;details=true</code></p>

<h3 id="request-parameters">Request Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>mobile*</td>
<td>Pass the mobile number of the customer for whom you want to check whether the coupon is redeemable</td>
</tr>
<tr>
<td>id</td>
<td>Pass the coupon id that you want to check for the customer</td>
</tr>
<tr>
<td>code</td>
<td>Pass the coupon id that you want to check</td>
</tr>
<tr>
<td>details=true</td>
<td>Retrieves the details of the coupon series</td>
</tr>
</tbody></table>

<aside class="warning"> You can pass either coupon id or code. Any one parameter is required</aside>

<h2 id="retrieve-coupon-series-details">Retrieve Coupon Series Details</h2>
<pre class="highlight html"><code>
</code></pre><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"series"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"item"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2302"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nothing new"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"series_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CAMPAIGN"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"campaign_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Holiday season"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"client_handling_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"
DISC_CODE
"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"discount_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"XYZ123"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"valid_till_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-11-01"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"valid_days_from_create"</span><span class="p">:</span><span class="w"> </span><span class="s2">"
30
"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"max_create"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-1"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"max_redeem"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-1"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"transferable"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"any_user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"same_user_multiple_redeem"</span><span class="p">:</span><span class="w"> </span><span class="s2">"
0
"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"allow_referral_existing_users"</span><span class="p">:</span><span class="w"> </span><span class="s2">"
0
"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"multiple_use"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"is_validation_required"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"created_by"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12769022"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-10-01 00:00:00"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"last_used"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0000-00-00 00:00:00"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"series_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"auto generated"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"sms_template"</span><span class="p">:</span><span class="w"> </span><span class="s2">"
Hello {{cust_name}}, your voucher code is {{voucher_code}}
"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"disable_sms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"info"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nothing new"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"allow_multiple_vouchers_per_user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"
0
"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"do_not_resend_existing_voucher"</span><span class="p">:</span><span class="w"> </span><span class="s2">"
0
"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"mutual_exclusive_series_ids"</span><span class="p">:</span><span class="w"> </span><span class="s2">"
null
"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"store_ids_json"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[“-1”]"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"dvs_enabled"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"dvs_expiry_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-11-01"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"priority"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"short_sms_template"</span><span class="p">:</span><span class="w"> </span><span class="s2">"
Hello {{cust_name}}, your voucher code is {{voucher_code}}
"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"max_vouchers_per_user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"
-1
"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"min_days_between_vouchers"</span><span class="p">:</span><span class="w"> </span><span class="s2">"
-1
"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"max_referrals_per_referee"</span><span class="p">:</span><span class="w"> </span><span class="s2">"
-1
"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"discount_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ABS"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"discount_value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"redemption_range"</span><span class="p">:</span><span class="w"> </span><span class="s2">"
{\"dom\":[\"-1\"],\"dow\":[\"-1\"],\"hours\":[\"-1\"]}
"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"min_bill_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"max_bill_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"redeem_at_store"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[-1]"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"coupons"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"issued"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"redeemed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"700"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Coupon Series Found"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;response&gt;</span>
<span class="nt">&lt;status&gt;</span>
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
<span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>
<span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>
<span class="nt">&lt;/status&gt;</span>
<span class="nt">&lt;series&gt;</span>
<span class="nt">&lt;items&gt;</span>
<span class="nt">&lt;item&gt;</span>
<span class="nt">&lt;id&gt;</span>2302<span class="nt">&lt;/id&gt;</span>
<span class="nt">&lt;description&gt;</span>nothing new<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;series_type&gt;</span>CAMPAIGN<span class="nt">&lt;/series_type&gt;</span>
<span class="nt">&lt;campaign_name&gt;</span>Holiday season<span class="nt">&lt;/campaign_name&gt;</span>
<span class="nt">&lt;client_handling_type&gt;</span>
DISC_CODE
<span class="nt">&lt;/client_handling_type&gt;</span>
<span class="nt">&lt;discount_code&gt;</span>XYZ123<span class="nt">&lt;/discount_code&gt;</span>
<span class="nt">&lt;valid_till_date&gt;</span>2016-11-01<span class="nt">&lt;/valid_till_date&gt;</span>
<span class="nt">&lt;valid_days_from_create&gt;</span>
30
<span class="nt">&lt;/valid_days_from_create&gt;</span>
<span class="nt">&lt;max_create&gt;</span>-1<span class="nt">&lt;/max_create&gt;</span>
<span class="nt">&lt;max_redeem&gt;</span>-1<span class="nt">&lt;/max_redeem&gt;</span>
<span class="nt">&lt;transferrable&gt;</span>0<span class="nt">&lt;/transferrable&gt;</span>
<span class="nt">&lt;any_user&gt;</span>1<span class="nt">&lt;/any_user&gt;</span>
<span class="nt">&lt;same_user_multiple_redeem&gt;</span>
0
<span class="nt">&lt;/same_user_multiple_redeem&gt;</span>
<span class="nt">&lt;allow_referral_existing_users&gt;</span>
0
<span class="nt">&lt;/allow_referral_existing_users&gt;</span>
<span class="nt">&lt;multiple_use&gt;</span>1<span class="nt">&lt;/multiple_use&gt;</span>
<span class="nt">&lt;is_validation_required&gt;</span>0<span class="nt">&lt;/is_validation_required&gt;</span>
<span class="nt">&lt;created_by&gt;</span>12769022<span class="nt">&lt;/created_by&gt;</span>
<span class="nt">&lt;created&gt;</span>2016-10-01 00:00:00<span class="nt">&lt;/created&gt;</span>
<span class="nt">&lt;last_used&gt;</span>0000-00-00 00:00:00<span class="nt">&lt;/last_used&gt;</span>
<span class="nt">&lt;series_code&gt;</span>auto generated<span class="nt">&lt;/series_code&gt;</span>
<span class="nt">&lt;sms_template&gt;</span>
Hello {{cust_name}}, your voucher code is {{voucher_code}}
<span class="nt">&lt;/sms_template&gt;</span>
<span class="nt">&lt;disable_sms&gt;</span>0<span class="nt">&lt;/disable_sms&gt;</span>
<span class="nt">&lt;info&gt;</span>nothing new<span class="nt">&lt;/info&gt;</span>
<span class="nt">&lt;allow_multiple_vouchers_per_user&gt;</span>
0
<span class="nt">&lt;/allow_multiple_vouchers_per_user&gt;</span>
<span class="nt">&lt;do_not_resend_existing_voucher&gt;</span>
0
<span class="nt">&lt;/do_not_resend_existing_voucher&gt;</span>
<span class="nt">&lt;mutual_exclusive_series_ids&gt;</span>
null
<span class="nt">&lt;/mutual_exclusive_series_ids&gt;</span>
<span class="nt">&lt;store_ids_json&gt;</span>[“-1”]<span class="nt">&lt;/store_ids_json&gt;</span>
<span class="nt">&lt;dvs_enabled&gt;</span>0<span class="nt">&lt;/dvs_enabled&gt;</span>
<span class="nt">&lt;dvs_expiry_date&gt;</span>2016-11-01<span class="nt">&lt;/dvs_expiry_date&gt;</span>
<span class="nt">&lt;priority&gt;</span>0<span class="nt">&lt;/priority&gt;</span>
<span class="nt">&lt;short_sms_template&gt;</span>
Hello {{cust_name}}, your voucher code is {{voucher_code}}
<span class="nt">&lt;/short_sms_template&gt;</span>
<span class="nt">&lt;max_vouchers_per_user&gt;</span>
-1
<span class="nt">&lt;/max_vouchers_per_user&gt;</span>
<span class="nt">&lt;min_days_between_vouchers&gt;</span>
-1
<span class="nt">&lt;/min_days_between_vouchers&gt;</span>
<span class="nt">&lt;max_referrals_per_referee&gt;</span>
-1
<span class="nt">&lt;/max_referrals_per_referee&gt;</span>
<span class="nt">&lt;discount_on&gt;&lt;/discount_on&gt;</span>
<span class="nt">&lt;discount_type&gt;</span>ABS<span class="nt">&lt;/discount_type&gt;</span>
<span class="nt">&lt;discount_value&gt;</span>0<span class="nt">&lt;/discount_value&gt;</span>
<span class="nt">&lt;dvs_items&gt;&lt;/dvs_items&gt;</span>
<span class="nt">&lt;redemption_range&gt;</span>
{"dom":["-1"],"dow":["-1"],"hours":["-1"]}
<span class="nt">&lt;/redemption_range&gt;</span>
<span class="nt">&lt;min_bill_amount&gt;</span>0<span class="nt">&lt;/min_bill_amount&gt;</span>
<span class="nt">&lt;max_bill_amount&gt;</span>0<span class="nt">&lt;/max_bill_amount&gt;</span>
<span class="nt">&lt;redeem_at_store&gt;</span>[-1]<span class="nt">&lt;/redeem_at_store&gt;</span>
<span class="nt">&lt;coupons&gt;</span>
<span class="nt">&lt;issued&gt;</span>1<span class="nt">&lt;/issued&gt;</span>
<span class="nt">&lt;redeemed&gt;</span>5<span class="nt">&lt;/redeemed&gt;</span>
<span class="nt">&lt;/coupons&gt;</span>
<span class="nt">&lt;item_status&gt;</span>
<span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
<span class="nt">&lt;code&gt;</span>700<span class="nt">&lt;/code&gt;</span>
<span class="nt">&lt;message&gt;</span>Coupon Series Found<span class="nt">&lt;/message&gt;</span>
<span class="nt">&lt;/item_status&gt;</span>
<span class="nt">&lt;/item&gt;</span>
<span class="nt">&lt;/items&gt;</span>
<span class="nt">&lt;/series&gt;</span>
<span class="nt">&lt;/response&gt;</span>
``

This API retrieves the details of entire coupon series when no series id is passed and details of a specific coupon series when the series id passed.

Entry | Description
----- | -----------
URI | coupon/series
Rate Limited? | Yes
Authentication  | Yes
Response Formats  | XML, JSON
HTTP Method  | GET
API Version  | v1.1
Batch Support  | Yes

### Request URL
`http://<span class="nt">&lt;cluster</span> <span class="err">url</span><span class="nt">&gt;</span>/v1.1/coupon/series?format=<span class="nt">&lt;xml</span><span class="err">/json</span><span class="nt">&gt;</span><span class="err">&amp;</span>id=<span class="nt">&lt;series</span> <span class="err">id</span><span class="nt">&gt;</span>`

### Request Parameters
Parameter | Description
--------- | -----------
id | Id of the coupon series that you want to retrieve
expired | boolean value. Retrieves the details of the expired coupon series if `expired=true` and active coupon series details if `expired=false`

## Request URL
`http://<span class="nt">&lt;cluster</span> <span class="err">url</span><span class="nt">&gt;</span>/v1.1/coupon/series?format=<span class="nt">&lt;xml</span><span class="err">/json</span><span class="nt">&gt;</span><span class="err">&amp;</span>expired=<span class="nt">&lt;true</span><span class="err">/false</span><span class="nt">&gt;</span>`

## Issue Coupon
```html
http://us.intouch.capillarytech.com/v1.1/coupon/issue?format=json
</code></pre>
<blockquote>
<p>Sample POST Request</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"root"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"coupon"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"series_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"832"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"447700900000"</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;root&gt;</span>
    <span class="nt">&lt;coupon&gt;</span>
        <span class="nt">&lt;series_id&gt;</span>832<span class="nt">&lt;/series_id&gt;</span>
        <span class="nt">&lt;customer&gt;</span>
            <span class="nt">&lt;mobile&gt;</span>447700900000<span class="nt">&lt;/mobile&gt;</span>
            <span class="nt">&lt;email&gt;&lt;/email&gt;</span>
            <span class="nt">&lt;external_id&gt;&lt;/external_id&gt;</span>
        <span class="nt">&lt;/customer&gt;</span>
    <span class="nt">&lt;/coupon&gt;</span>
<span class="nt">&lt;/root&gt;</span>

</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"coupon"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"xqnq5m5u"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"valid_till"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-25"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"series_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"832"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sample description"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"discount_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"XYZ123"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"valid_till"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-12-31"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"discount_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ABS"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"discount_value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"detailed_info"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sample information"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"mobile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"447700900000"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4453654"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"item_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"700"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Coupon processing successful"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;response&gt;</span>
    <span class="nt">&lt;status&gt;</span>
        <span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
        <span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>
        <span class="nt">&lt;message&gt;</span>SUCCESS<span class="nt">&lt;/message&gt;</span>
    <span class="nt">&lt;/status&gt;</span>
    <span class="nt">&lt;coupon&gt;</span>
        <span class="nt">&lt;code&gt;</span>xqnq5m5u<span class="nt">&lt;/code&gt;</span>
<span class="nt">&lt;valid_till&gt;</span>2016-12-25<span class="nt">&lt;/valid_till&gt;</span> 
<span class="c">&lt;!-- this is due date of the coupon --&gt;</span>
<span class="nt">&lt;series_info&gt;</span>
<span class="nt">&lt;id&gt;</span>832<span class="nt">&lt;/id&gt;</span>        
<span class="nt">&lt;description&gt;</span>Sample description<span class="nt">&lt;/description&gt;</span>        
<span class="nt">&lt;discount_code&gt;</span>XYZ123<span class="nt">&lt;/discount_code&gt;</span>        
<span class="nt">&lt;valid_till&gt;</span>2012-12-31<span class="nt">&lt;/valid_till&gt;</span>        
<span class="nt">&lt;discount_type&gt;</span>ABS<span class="nt">&lt;/discount_type&gt;</span>        
<span class="nt">&lt;discount_value&gt;</span>0<span class="nt">&lt;/discount_value&gt;</span>        
<span class="nt">&lt;discount_on&gt;&lt;/discount_on&gt;</span>        
<span class="c">&lt;!-- “discount_on” can be on BILL or LINEITEM --&gt;</span>
<span class="nt">&lt;detailed_info&gt;</span>Sample information<span class="nt">&lt;/detailed_info&gt;</span>      
<span class="nt">&lt;/series_info&gt;</span>    
        <span class="nt">&lt;customer&gt;</span>
            <span class="nt">&lt;mobile&gt;</span>447700900000<span class="nt">&lt;/mobile&gt;</span>
            <span class="nt">&lt;email&gt;&lt;/email&gt;</span>
            <span class="nt">&lt;external_id&gt;&lt;/external_id&gt;</span>
            <span class="nt">&lt;user_id&gt;</span>4453654<span class="nt">&lt;/user_id&gt;</span>
            <span class="c">&lt;!-- user_id will be returned
only if the query parameter “user_id” is passed 
and that is set to “true” --&gt;</span>
        <span class="nt">&lt;/customer&gt;</span>
        <span class="nt">&lt;item_status&gt;</span>
            <span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
            <span class="nt">&lt;code&gt;</span>700<span class="nt">&lt;/code&gt;</span>
            <span class="nt">&lt;message&gt;</span>Coupon processing successful<span class="nt">&lt;/message&gt;</span>
        <span class="nt">&lt;/item_status&gt;</span>
    <span class="nt">&lt;/coupon&gt;</span>
<span class="nt">&lt;/response&gt;</span>
</code></pre>
<p>This API allows you to issue a specific coupon series to a customer.</p>

<table><thead>
<tr>
<th>Entry</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>coupon/issue</td>
</tr>
<tr>
<td>Rate Limited?</td>
<td>Yes</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Method</td>
<td>POST</td>
</tr>
<tr>
<td>API Version</td>
<td>v1.1</td>
</tr>
<tr>
<td>Batch Support</td>
<td>Yes</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/coupon/issue?format=&lt;xml/json&gt;</code></p>

<h2 id="response-codes">Response Codes</h2>

<h3 id="success-codes">Success Codes</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>700</td>
<td>Coupon processed successfully</td>
</tr>
<tr>
<td>700</td>
<td>Coupon series fetched successfully</td>
</tr>
</tbody></table>

<h3 id="error-codes">Error Codes</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>701</td>
<td>Unable to find the customer. Please enter correct mobile number/email id/external id</td>
</tr>
<tr>
<td>702</td>
<td>Coupon code is invalid</td>
</tr>
<tr>
<td>703</td>
<td>Coupon not issued to this customer</td>
</tr>
<tr>
<td>704</td>
<td>Unable to send coupon to the customer’s mobile number</td>
</tr>
<tr>
<td>705</td>
<td>Invalid coupon code and validation code</td>
</tr>
<tr>
<td>706</td>
<td>Unable to redeem coupon</td>
</tr>
<tr>
<td>707</td>
<td>Coupon series id is invalid</td>
</tr>
<tr>
<td>709</td>
<td>Unable to redeem coupon</td>
</tr>
<tr>
<td>710</td>
<td>Coupon cannot be redeemed by this customer</td>
</tr>
<tr>
<td>711</td>
<td>Coupon is redeemed already</td>
</tr>
<tr>
<td>712</td>
<td>Unable to redeem. Either coupon series or campaign might have expired</td>
</tr>
<tr>
<td>713</td>
<td>Coupon has expired</td>
</tr>
<tr>
<td>714</td>
<td>Unable to redeem. Maximum redemptions allowed for this campaign are already reached</td>
</tr>
<tr>
<td>715</td>
<td>Unable to redeem. The coupon is not valid for this organization</td>
</tr>
<tr>
<td>716</td>
<td>Unable to redeem. Cannot redeem same coupon multiple times</td>
</tr>
<tr>
<td>718</td>
<td>Unable to redeem. Please enter transaction number must be entered to redeem</td>
</tr>
<tr>
<td>719</td>
<td>Coupon code does not exist</td>
</tr>
<tr>
<td>720</td>
<td>Unable to redeem. This is just a trial coupon and cannot be redeemed</td>
</tr>
<tr>
<td>721</td>
<td>Unable to issue/redeem coupon. Customer is invalid</td>
</tr>
<tr>
<td>722</td>
<td>Unable to issue coupon</td>
</tr>
<tr>
<td>723</td>
<td>Unable to redeem. The coupon cannot be used by this customer</td>
</tr>
<tr>
<td>724</td>
<td>Unable to send message</td>
</tr>
<tr>
<td>725</td>
<td>Unable to redeem coupon. Please provide validation code to redeem</td>
</tr>
<tr>
<td>726</td>
<td>Validation not required</td>
</tr>
<tr>
<td>728</td>
<td>Unable to redeem. Maximum number of coupon redemptions allowed has already been reached</td>
</tr>
<tr>
<td>729</td>
<td>Invalid redemption date range for the coupon series</td>
</tr>
<tr>
<td>730</td>
<td>Unknown error</td>
</tr>
<tr>
<td>732</td>
<td>No Missed call received from the customer</td>
</tr>
<tr>
<td>733</td>
<td>Transaction amount invalid</td>
</tr>
<tr>
<td>735</td>
<td>Unable to redeem coupon. The coupon cannot be redeemed at this store</td>
</tr>
<tr>
<td>736</td>
<td>Unable to redeem coupon. Maximum number of coupon redemptions allowed has already been reached</td>
</tr>
<tr>
<td>738</td>
<td>Cannot redeem the coupon. Please wait for <X> days to redeem this coupon again</td>
</tr>
<tr>
<td>739</td>
<td>Unable to redeem. Make sure that the redemption date you have entered is valid</td>
</tr>
<tr>
<td>740</td>
<td>Unable to process. Customer is marked as fraud</td>
</tr>
<tr>
<td>742</td>
<td>Coupon issual or redemption is blocked for this customer</td>
</tr>
<tr>
<td>750</td>
<td>Unable to process. Customer is marked as fraud</td>
</tr>
<tr>
<td>786</td>
<td>Unable to process coupon. Please try again later</td>
</tr>
<tr>
<td>787</td>
<td>Unable to process coupon. Please try again later</td>
</tr>
<tr>
<td>788</td>
<td>Configuration is invalid. Please report to Capillary Support</td>
</tr>
<tr>
<td>789</td>
<td>Unable to process coupon. Please try again later</td>
</tr>
<tr>
<td>790</td>
<td>Unable to process coupon. Please try again later</td>
</tr>
<tr>
<td>791</td>
<td>Unable to process coupon. Please try again later</td>
</tr>
<tr>
<td>792</td>
<td>Unable to process coupon. Please try again later</td>
</tr>
<tr>
<td>793</td>
<td>Unable to process coupon. Please try again later</td>
</tr>
<tr>
<td>794</td>
<td>Unable to process coupon. Please try again later</td>
</tr>
<tr>
<td>795</td>
<td>Configuration is invalid. Please report to Capillary Support</td>
</tr>
<tr>
<td>796</td>
<td>Unable to process coupon. Please try again later</td>
</tr>
<tr>
<td>797</td>
<td>Unable to process coupon. Please try again later</td>
</tr>
<tr>
<td>798</td>
<td>Unable to process coupon. Please try again later</td>
</tr>
<tr>
<td>799</td>
<td>Configuration is invalid. Please report to Capillary Support</td>
</tr>
</tbody></table>

          <h1 id="communications">Communications</h1>

<p>Communications represent personalized messages (SMSs/emails) sent to the loyalty customers. Messages such as transaction notifications, birthday wishes, anniversary wishes can be sent through communications APIs.</p>

<p>The communications entity stores personalized messages, and message templates, To send messages the communication gate way should be enabled for your organization with enough message credits.</p>

<p>The communications entity allows you to perform the following tasks:</p>

<ul>
<li>Fetch details of a specific email/SMS by message id </li>
<li>Send personalized emails/SMSs </li>
<li>Retrieve details of a specific email/sms template </li>
<li>Create new SMS/email templates or update existing templates </li>
</ul>

<h2 id="send-sms-to-customers">Send SMS to Customers</h2>
<pre class="highlight html"><code># Sample Request URL
http://us.intouch.capillarytech.com/v1.1/communications/sms?format=json

</code></pre>
<blockquote>
<p>Sample POST Request</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"root"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"sms"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"to"</span><span class="p">:</span><span class="w"> </span><span class="s2">"447700900000"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hi, wish you a happy wedding anniversary!"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"scheduled_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-08-05 22:00:00IST"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="nt">&lt;root&gt;</span>
   <span class="nt">&lt;sms&gt;</span>
      <span class="nt">&lt;to&gt;</span>447700900000<span class="nt">&lt;/to&gt;</span>
      <span class="nt">&lt;body&gt;</span>Hi, wish you a happy wedding anniversary!<span class="nt">&lt;/body&gt;</span>
      <span class="nt">&lt;scheduled_time&gt;</span>2012-08-05 22:00:00IST<span class="nt">&lt;/scheduled_time&gt;</span>
   <span class="nt">&lt;/sms&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"sms"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"23423443"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"to"</span><span class="p">:</span><span class="w"> </span><span class="s2">"447700900000"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sent"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"scheduled_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-08-05 22:00:00IST"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>        
<span class="nt">&lt;response&gt;</span>
    <span class="nt">&lt;status&gt;</span>
        <span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
        <span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>
        <span class="nt">&lt;message&gt;</span>success<span class="nt">&lt;/message&gt;</span>
    <span class="nt">&lt;/status&gt;</span>
    <span class="nt">&lt;sms&gt;</span>
        <span class="nt">&lt;id&gt;</span>23423443<span class="nt">&lt;/id&gt;</span>
        <span class="nt">&lt;to&gt;</span>447700900000<span class="nt">&lt;/to&gt;</span>        
        <span class="nt">&lt;status&gt;</span>Sent<span class="nt">&lt;/status&gt;</span>
        <span class="nt">&lt;scheduled_time&gt;</span>2012-08-05 22:00:00IST<span class="nt">&lt;/scheduled_time&gt;</span>
<span class="nt">&lt;/sms&gt;</span>    
<span class="nt">&lt;/response&gt;</span>
</code></pre>
<p>This API allows you to send sms to a specific mobile number. You can schedule the date and time you wish to send the message.</p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Entry</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>communications/sms</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Methods</td>
<td>POST</td>
</tr>
<tr>
<td>API Version</td>
<td>v1.1</td>
</tr>
<tr>
<td>Batch Support</td>
<td>No</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/communications/sms?format=&lt;xml/json&gt;</code></p>

<h2 id="send-email-to-customer">Send Email to Customer</h2>
<pre class="highlight html"><code># Sample Request URL
http://us.intouch.capillarytech.com/v1.1/communications/email?format=json

</code></pre>
<blockquote>
<p>Sample POST Request</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"root"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"to"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tom.sawyer@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cashier1@example.com, cashier2@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"bcc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"storemanager@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"from"</span><span class="p">:</span><span class="w"> </span><span class="s2">"store1@store.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"#text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"  -- optional
        "</span><span class="p">,</span><span class="w">
      </span><span class="nt">"subject"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Testing email"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Dear Tom,
            Thanks for visiting our store. Hope you had a pleasant experience.

        "</span><span class="p">,</span><span class="w">
      </span><span class="nt">"attachments"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"attachment"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"file_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"asda.pdf"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"file_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pdf"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"file_data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"  -- base64_encoded file contents
                adsdsadd21121dasd12123123assdad1212123
                234234234234234234
                24234234

            "</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"scheduled_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-08-05 22:00:21"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>        
<span class="nt">&lt;root&gt;</span>
    <span class="nt">&lt;email&gt;</span>
        <span class="nt">&lt;to&gt;</span>tom.sawyer@example.com<span class="nt">&lt;/to&gt;</span>
        <span class="nt">&lt;cc&gt;</span>cashier1@example.com, cashier2@example.com<span class="nt">&lt;/cc&gt;</span>
        <span class="nt">&lt;bcc&gt;</span>storemanager@example.com<span class="nt">&lt;/bcc&gt;</span>
        <span class="nt">&lt;from&gt;</span>store1@store.com<span class="nt">&lt;/from&gt;</span>  -- optional
        <span class="nt">&lt;subject&gt;</span><span class="cp">&lt;![CDATA[Testing email]]&gt;</span><span class="nt">&lt;/subject&gt;</span>
        <span class="nt">&lt;body&gt;</span><span class="cp">&lt;![CDATA[Dear Tom,
            Thanks for visiting our store. Hope you had a pleasant experience.
            ]]&gt;</span>
        <span class="nt">&lt;/body&gt;</span>    
        <span class="nt">&lt;attachments&gt;</span>
            <span class="nt">&lt;attachment&gt;</span>
            <span class="nt">&lt;file_name&gt;</span>asda.pdf<span class="nt">&lt;/file_name&gt;</span>
            <span class="nt">&lt;file_type&gt;</span>pdf<span class="nt">&lt;/file_type&gt;</span>
            <span class="nt">&lt;file_data&gt;</span><span class="cp">&lt;![CDATA[  -- base64_encoded file contents
                adsdsadd21121dasd12123123assdad1212123
                234234234234234234
                24234234
                ]]&gt;</span>
            <span class="nt">&lt;/file_data&gt;</span>    
        <span class="nt">&lt;/attachment&gt;</span>    
        <span class="nt">&lt;/attachments&gt;</span>
        <span class="nt">&lt;scheduled_time&gt;</span>2016-08-05 22:00:21<span class="nt">&lt;/scheduled_time&gt;</span>
    <span class="nt">&lt;/email&gt;</span>    
      <span class="nt">&lt;/root&gt;</span>            

</code></pre>
<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"23423443"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"to"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tom.sawyer@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cashier1@example.com, cashier2@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"bcc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"storemanager@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Queued"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"subject"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sample email"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Dear Tom,
            Thanks for the treat. Looking forward to more treats"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"scheduled_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-08-05 22:00::IST"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>        
<span class="nt">&lt;response&gt;</span>
    <span class="nt">&lt;status&gt;</span>
        <span class="nt">&lt;success&gt;</span>true<span class="nt">&lt;/success&gt;</span>
        <span class="nt">&lt;code&gt;</span>200<span class="nt">&lt;/code&gt;</span>
        <span class="nt">&lt;message&gt;</span>success<span class="nt">&lt;/message&gt;</span>
    <span class="nt">&lt;/status&gt;</span>
    <span class="nt">&lt;email&gt;</span>
        <span class="nt">&lt;id&gt;</span>23423443<span class="nt">&lt;/id&gt;</span>
        <span class="nt">&lt;to&gt;</span>tom.sawyer@example.com<span class="nt">&lt;/to&gt;</span>
            <span class="nt">&lt;cc&gt;</span>cashier1@example.com, cashier2@example.com<span class="nt">&lt;/cc&gt;</span>
        <span class="nt">&lt;bcc&gt;</span>storemanager@example.com<span class="nt">&lt;/bcc&gt;</span>
        <span class="nt">&lt;status&gt;</span>Queued<span class="nt">&lt;/status&gt;</span>
        <span class="nt">&lt;subject&gt;</span>Sample email<span class="nt">&lt;/subject&gt;</span>
        <span class="nt">&lt;description&gt;</span>Dear Tom,
            Thanks for the treat. Looking forward to more treats<span class="nt">&lt;/description&gt;</span>
        <span class="nt">&lt;scheduled_time&gt;</span>2016-08-05 22:00::IST<span class="nt">&lt;/scheduled_time&gt;</span>
     <span class="nt">&lt;/email&gt;</span>    
<span class="nt">&lt;/response&gt;</span>
</code></pre>
<p>This API allows you to send email to a specific email id. You can schedule the date and time you wish to send the message.</p>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Entry</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>communications/email</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Methods</td>
<td>POST</td>
</tr>
<tr>
<td>API Version</td>
<td>v1.1</td>
</tr>
<tr>
<td>Batch Support</td>
<td>No</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/communications/email?format=&lt;xml/json&gt;</code></p>

<h2 id="retrieve-details-of-email-sent">Retrieve Details of Email Sent</h2>

<h3 id="resource-information">Resource Information</h3>

<table><thead>
<tr>
<th>Entry</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>URI</td>
<td>communications/email</td>
</tr>
<tr>
<td>Authentication</td>
<td>Yes</td>
</tr>
<tr>
<td>Response Formats</td>
<td>XML, JSON</td>
</tr>
<tr>
<td>HTTP Methods</td>
<td>GET</td>
</tr>
<tr>
<td>API Version</td>
<td>v1.1</td>
</tr>
<tr>
<td>Batch Support</td>
<td>No</td>
</tr>
</tbody></table>

<h3 id="request-url">Request URL</h3>

<p><code class="prettyprint">http://&lt;cluster url&gt;/v1.1/communications/email?format=&lt;xml/json&gt;&amp;&lt;parameters&gt;</code></p>

<h3 id="request-rameters">Request Rameters</h3>

<p>id - Pass the message id generated for the sent message</p>

<h2 id="retrieve-details-of-sms-sent">Retrieve Details of SMS Sent</h2>

<h2 id="response-codes">Response Codes</h2>

<h3 id="success-codes">Success Codes</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>4100</td>
<td>Message sent successfully</td>
</tr>
<tr>
<td>Message fetched successfully</td>
<td></td>
</tr>
<tr>
<td>Template added/updated successfully</td>
<td></td>
</tr>
<tr>
<td>4200</td>
<td>Email sent successfully / Email fetched successfully</td>
</tr>
</tbody></table>

<h3 id="error-codes">Error Codes</h3>

<table><thead>
<tr>
<th>CODE</th>
<th>DESCRIPTION</th>
</tr>
</thead><tbody>
<tr>
<td>4101</td>
<td>Unable to send message</td>
</tr>
<tr>
<td>4201</td>
<td>Unable to send email</td>
</tr>
<tr>
<td>4102</td>
<td>Unable to find/retrieve SMS</td>
</tr>
<tr>
<td>4202</td>
<td>Unable to find/retrieve email</td>
</tr>
<tr>
<td>4203</td>
<td>Invalid template type passed</td>
</tr>
<tr>
<td>4204</td>
<td>Template not found</td>
</tr>
<tr>
<td>4205</td>
<td>Unable to update the template</td>
</tr>
<tr>
<td>4206</td>
<td>Invalid template id passed</td>
</tr>
<tr>
<td>4207</td>
<td>No template is available with the given parameters</td>
</tr>
<tr>
<td>4208</td>
<td>Invalid email id</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="json">json</a>
                <a href="#" data-language-name="xml">xml</a>
          </div>
      </div>
    </div>
  </body>
</html>
